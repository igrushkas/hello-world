!function(){"use strict";const e=[{id:"fun_environment",name:"Fun\nEnvironment",color:"#f39c12"},{id:"relationships",name:"Relationships\nFamily",color:"#e84393"},{id:"money_finances",name:"Money\nFinances",color:"#ffd32a"},{id:"career_contribution",name:"Career\nContribution",color:"#3498db"},{id:"personal_growth",name:"Personal\nGrowth",color:"#6c5ce7"},{id:"health_energy",name:"Health\nEnergy",color:"#00d2a0"}],t=[{id:"leadership_vision",name:"Leadership\nVision",color:"#e67e22"},{id:"operations_systems",name:"Operations\nSystems",color:"#3498db"},{id:"finance_risk",name:"Finance\nRisk",color:"#f1c40f"},{id:"marketing_sales",name:"Marketing\nSales",color:"#e74c3c"},{id:"services_innovation",name:"Services\nInnovation",color:"#1abc9c"},{id:"people_culture",name:"People\nCulture",color:"#9b59b6"}],n=[{id:"sleep_recovery",name:"Sleep\nRecovery",color:"#5b6abf"},{id:"nutrition_fuel",name:"Nutrition\nFuel",color:"#27ae60"},{id:"exercise_movement",name:"Exercise\nMovement",color:"#e74c3c"},{id:"mindfulness_calm",name:"Mindfulness\nCalm",color:"#8e44ad"},{id:"nature_outdoors",name:"Nature\nOutdoors",color:"#16a085"},{id:"community_connection",name:"Community\nConnection",color:"#e67e22"}],o=[{id:"giving_will",name:"Giving\n& Will",color:"#e91e63"},{id:"ira_retirement",name:"IRA\nRetirement",color:"#9c27b0"},{id:"investments",name:"Investments\nGrowth",color:"#4caf50"},{id:"budget",name:"Budget\nPlanning",color:"#2196f3"},{id:"insurance",name:"Insurance\nProtection",color:"#ff9800"},{id:"debt_free",name:"Debt\nMortgage",color:"#00bcd4"}],a={health_energy:"Physical fitness, mental health, sleep, nutrition ‚Äî the foundation your brain needs to function",relationships:"Partner, children, friends, community ‚Äî connection is medicine for the restless mind",career_contribution:"Work performance, career growth, impact, purpose ‚Äî channel your hyperfocus here",money_finances:"Income, savings, investments, financial freedom ‚Äî structure creates calm for ADHD brains",personal_growth:"Learning, mindset, meditation, emotional intelligence ‚Äî training your brain to work for you",fun_environment:"Hobbies, rest, travel, home space ‚Äî ADHD brains need novelty and recharge time",leadership_vision:"Strategic direction, leadership skills, vision setting, decision-making, company culture",operations_systems:"Processes, efficiency, automation, SOPs, project management, infrastructure",finance_risk:"Revenue, expenses, cash flow, budgeting, risk management, compliance",marketing_sales:"Lead generation, brand awareness, sales pipeline, conversions, customer acquisition",services_innovation:"Product development, service quality, R&D, competitive advantage, new ideas",people_culture:"Hiring, team development, retention, morale, collaboration, company values",sleep_recovery:"Sleep quality, bedtime routine, wind-down habits, naps, recovery, rest days",nutrition_fuel:"Meal prep, hydration, healthy eating, supplements, reducing processed food",exercise_movement:"Workouts, stretching, walking, sports, gym, active lifestyle",mindfulness_calm:"Meditation, breathing exercises, journaling, therapy, stress management",nature_outdoors:"Outdoor walks, sunlight exposure, gardening, parks, nature immersion",community_connection:"Social activities, support groups, volunteering, friendships, family time",giving_will:"Charitable giving, estate planning, will preparation, legacy planning, tithing",ira_retirement:"IRA contributions, 401k, retirement planning, pension, social security strategy",investments:"Stocks, bonds, real estate, index funds, portfolio rebalancing, passive income",budget:"Monthly budget, expense tracking, savings goals, emergency fund, cash flow planning",insurance:"Life insurance, health insurance, auto, home, disability, umbrella policies",debt_free:"Mortgage strategy, debt payoff plan, credit card debt, student loans, refinancing, debt snowball"},i={1:["health_energy"],2:["money_finances"],3:["career_contribution"],4:["personal_growth"],5:["fun_environment"],6:["__free__"],0:["relationships"]},r={1:["operations_systems"],2:["finance_risk"],3:["marketing_sales"],4:["services_innovation"],5:["people_culture"],6:["__free__"],0:["leadership_vision"]},s={1:["exercise_movement"],2:["nutrition_fuel"],3:["mindfulness_calm"],4:["nature_outdoors"],5:["community_connection"],6:["__free__"],0:["sleep_recovery"]},c={1:["budget"],2:["debt_free"],3:["investments"],4:["ira_retirement"],5:["insurance"],6:["__free__"],0:["giving_will"]};function l(){try{var e;return(e="business"===Ze?It():"health"===Ze?St():"finances"===Ze?Dt():xt())&&0!==e.length?e.reduce(function(e,t){return t.score<e.score?t:e},e[0]).id:$e()[0].id}catch(e){return $e()[0].id}}function d(e){return 1===e.length&&"__free__"===e[0]?[l()]:e}function u(){var e=(new Date).getDay();return d("business"===Ze?r[e]||[]:"health"===Ze?s[e]||[]:"finances"===Ze?c[e]||[]:i[e]||[])}function m(e){return e?e.replace(/\n/g," "):""}function h(){var e,t,n=u(),o=$e(),a=n.map(function(e){var t=o.find(function(t){return t.id===e});return t?m(t.name):e}).join(", ");return e=(new Date).getDay(),1===(t=("business"===Ze?r:"health"===Ze?s:"finances"===Ze?c:i)[e]||[]).length&&t[0],a}function g(){var e=new Date;e.setDate(e.getDate()+1);var t=e.getDay();return d("business"===Ze?r[t]||[]:"health"===Ze?s[t]||[]:"finances"===Ze?c[t]||[]:i[t]||[])}const f={health:"health_energy",family:"relationships",love:"relationships",career:"career_contribution",finances:"money_finances",finance:"money_finances",growth:"personal_growth",contribution:"personal_growth",fun:"fun_environment",environment:"fun_environment",leadership:"leadership_vision",marketing:"marketing_sales",sales:"marketing_sales",operations:"operations_systems",financials:"finance_risk",innovation:"services_innovation",strategy:"leadership_vision",celebration:"people_culture"},p=[{name:"Downward Dog",emoji:"üßò",equipment:"yoga mat",focus:["core","arms","spine"],duration:"30 sec hold",howTo:"1. Start on hands and knees\n2. Tuck toes, lift hips up and back\n3. Press chest toward thighs\n4. Keep arms straight, heels reaching down\n5. Hold and breathe deeply"},{name:"Cat-Cow Stretch",emoji:"üê±",equipment:"yoga mat",focus:["spine","core"],duration:"10 reps",howTo:"1. Start on hands and knees\n2. Inhale: drop belly, lift head (Cow)\n3. Exhale: round spine, tuck chin (Cat)\n4. Flow slowly between positions\n5. Focus on each vertebra moving"},{name:"Seated Spinal Twist",emoji:"üîÑ",equipment:"yoga mat",focus:["spine","core"],duration:"30 sec each side",howTo:"1. Sit with legs extended\n2. Bend right knee, cross over left leg\n3. Place left elbow outside right knee\n4. Twist torso to the right, look back\n5. Hold, breathe, then switch sides"},{name:"Pigeon Pose",emoji:"üïäÔ∏è",equipment:"yoga mat",focus:["butt","spine"],duration:"45 sec each side",howTo:"1. From downward dog, bring right knee forward\n2. Place right shin on mat (angled)\n3. Extend left leg straight behind you\n4. Square hips, fold forward over front leg\n5. Breathe deeply into the hip stretch"},{name:"Child's Pose",emoji:"üôè",equipment:"yoga mat",focus:["spine","core"],duration:"30 sec",howTo:"1. Kneel on mat, big toes touching\n2. Sit back on heels\n3. Fold forward, arms extended overhead\n4. Forehead rests on mat\n5. Breathe into your lower back"},{name:"Cobra Stretch",emoji:"üêç",equipment:"yoga mat",focus:["spine","core"],duration:"20 sec hold",howTo:"1. Lie face down, hands under shoulders\n2. Press into hands, lift chest off floor\n3. Keep elbows slightly bent\n4. Squeeze shoulder blades together\n5. Look slightly upward, hold and breathe"},{name:"Thread the Needle",emoji:"üßµ",equipment:"yoga mat",focus:["spine","arms"],duration:"30 sec each side",howTo:"1. Start on hands and knees\n2. Slide right arm under left arm\n3. Let right shoulder and temple rest on floor\n4. Keep left hand planted or reach overhead\n5. Feel the twist through upper back"},{name:"Standing Forward Fold",emoji:"üôá",equipment:"none",focus:["spine","core"],duration:"30 sec",howTo:"1. Stand with feet hip-width apart\n2. Hinge at hips, fold forward\n3. Let head hang heavy\n4. Grab opposite elbows and sway gently\n5. Bend knees slightly if needed"},{name:"Warrior II",emoji:"‚öîÔ∏è",equipment:"yoga mat",focus:["butt","core","arms"],duration:"30 sec each side",howTo:"1. Step feet wide apart (4 feet)\n2. Turn right foot out 90¬∞, left foot slightly in\n3. Bend right knee over ankle\n4. Extend arms out to sides, gaze right\n5. Sink deeper, engage core and glutes"},{name:"Bridge Pose",emoji:"üåâ",equipment:"yoga mat",focus:["butt","spine","core"],duration:"30 sec hold",howTo:"1. Lie on back, knees bent, feet flat\n2. Arms at sides, palms down\n3. Press feet into floor, lift hips\n4. Squeeze glutes at the top\n5. Roll spine down slowly to release"},{name:"Supine Spinal Twist",emoji:"üåÄ",equipment:"yoga mat",focus:["spine","core"],duration:"30 sec each side",howTo:"1. Lie on back, hug knees to chest\n2. Drop both knees to the right\n3. Extend left arm out to the side\n4. Turn head to look left\n5. Let gravity deepen the twist, breathe"},{name:"Dumbbell Bicep Curls",emoji:"üí™",equipment:"dumbbells",focus:["arms"],duration:"12 reps",howTo:"1. Stand holding dumbbells at sides, palms forward\n2. Keep elbows pinned to ribs\n3. Curl weights up toward shoulders\n4. Squeeze at the top briefly\n5. Lower slowly (3 seconds down)"},{name:"Dumbbell Overhead Press",emoji:"üèãÔ∏è",equipment:"dumbbells",focus:["arms","core"],duration:"10 reps",howTo:"1. Hold dumbbells at shoulder height\n2. Palms facing forward\n3. Press weights straight overhead\n4. Fully extend arms without locking elbows\n5. Lower back to shoulders with control"},{name:"Dumbbell Tricep Kickback",emoji:"üí™",equipment:"dumbbells",focus:["arms"],duration:"12 reps each arm",howTo:"1. Hinge forward at hips, flat back\n2. Hold dumbbell, upper arm parallel to floor\n3. Extend forearm back until arm is straight\n4. Squeeze tricep at full extension\n5. Return slowly, keep upper arm still"},{name:"Goblet Squat",emoji:"üèãÔ∏è",equipment:"dumbbells",focus:["butt","core"],duration:"12 reps",howTo:"1. Hold one dumbbell vertically at chest\n2. Stand with feet shoulder-width apart\n3. Squat down, pushing knees out\n4. Go as deep as comfortable\n5. Drive through heels to stand"},{name:"Dumbbell Lateral Raise",emoji:"ü¶Ö",equipment:"dumbbells",focus:["arms"],duration:"12 reps",howTo:"1. Stand holding dumbbells at sides\n2. Slight bend in elbows\n3. Raise arms out to sides to shoulder height\n4. Pause briefly at the top\n5. Lower slowly with control"},{name:"Dumbbell Deadlift",emoji:"üèãÔ∏è",equipment:"dumbbells",focus:["butt","core","spine"],duration:"10 reps",howTo:"1. Hold dumbbells in front of thighs\n2. Hinge at hips, push butt back\n3. Lower weights along legs to shin level\n4. Keep back flat, core tight\n5. Squeeze glutes to stand up"},{name:"Banded Glute Bridge",emoji:"üçë",equipment:"resistance bands",focus:["butt","core"],duration:"15 reps",howTo:"1. Place band just above knees\n2. Lie on back, knees bent, feet flat\n3. Push knees outward against band\n4. Lift hips up, squeeze glutes hard\n5. Hold 2 sec at top, lower slowly"},{name:"Band Pull-Apart",emoji:"‚ÜîÔ∏è",equipment:"resistance bands",focus:["arms","spine"],duration:"15 reps",howTo:"1. Hold band with both hands in front, arms extended\n2. Hands shoulder-width apart\n3. Pull band apart by squeezing shoulder blades\n4. Arms move outward to a T shape\n5. Return slowly to start"},{name:"Banded Squat Walk",emoji:"ü¶Ä",equipment:"resistance bands",focus:["butt","core"],duration:"10 steps each way",howTo:"1. Place band above knees or around ankles\n2. Get into quarter-squat position\n3. Step sideways, keeping tension on band\n4. Take 10 steps right, then 10 steps left\n5. Keep chest up, core engaged"},{name:"Banded Bicep Curl",emoji:"üí™",equipment:"resistance bands",focus:["arms"],duration:"15 reps",howTo:"1. Stand on band with both feet\n2. Hold band ends with palms up\n3. Curl hands toward shoulders\n4. Keep elbows at sides\n5. Lower slowly against resistance"},{name:"Banded Kickback",emoji:"ü¶µ",equipment:"resistance bands",focus:["butt"],duration:"12 reps each leg",howTo:"1. Loop band around ankles\n2. Stand on one leg, hold something for balance\n3. Kick other leg straight back\n4. Squeeze glute at the top\n5. Return slowly, repeat, switch legs"},{name:"Basic Jump Rope",emoji:"‚è≠Ô∏è",equipment:"jump rope",focus:["core","butt"],duration:"1 minute",howTo:"1. Hold handles lightly, elbows at sides\n2. Swing rope with wrists, not arms\n3. Jump just high enough to clear rope\n4. Land on balls of feet softly\n5. Keep a steady rhythm, breathe!"},{name:"High Knees Jump Rope",emoji:"üèÉ",equipment:"jump rope",focus:["core","butt"],duration:"30 seconds",howTo:"1. Jump rope with alternating high knees\n2. Drive each knee to hip height\n3. Stay on balls of feet\n4. Pump arms naturally\n5. Keep core tight throughout"},{name:"Weighted Hula Hoop",emoji:"‚≠ï",equipment:"weighted hula hoop",focus:["core","butt","spine"],duration:"2 minutes",howTo:"1. Place hoop around waist\n2. Give it a good spin\n3. Shift weight in a circular motion\n4. Keep core engaged, slight knee bend\n5. Relax shoulders, find your rhythm"},{name:"Hula Hoop Side-to-Side",emoji:"‚≠ï",equipment:"weighted hula hoop",focus:["core","spine"],duration:"1 minute",howTo:"1. Start hooping normally\n2. Shift your motion from circular to side-to-side\n3. Rock hips left and right\n4. Engages obliques more intensely\n5. Keep breathing steadily"},{name:"Ball Wall Squat",emoji:"üèê",equipment:"exercise ball",focus:["butt","core"],duration:"12 reps",howTo:"1. Place ball between lower back and wall\n2. Feet shoulder-width, slightly forward\n3. Squat down, ball rolls with you\n4. Go to 90¬∞ knee bend\n5. Push through heels to stand"},{name:"Ball Plank",emoji:"üèê",equipment:"exercise ball",focus:["core","arms"],duration:"30 sec hold",howTo:"1. Place forearms on exercise ball\n2. Extend legs behind you, toes on floor\n3. Keep body in straight line\n4. Engage core, don't let hips sag\n5. Hold steady, breathe normally"},{name:"Ball Back Extension",emoji:"üèê",equipment:"exercise ball",focus:["spine","core","butt"],duration:"12 reps",howTo:"1. Lie face down over ball, hips on top\n2. Feet on floor (wide stance for stability)\n3. Hands behind head or at chest\n4. Lift chest up, squeeze lower back\n5. Lower slowly, repeat"},{name:"Foam Roll Thoracic Spine",emoji:"üß±",equipment:"foam roller",focus:["spine"],duration:"1 minute",howTo:"1. Place roller under upper back\n2. Cross arms over chest\n3. Lift hips slightly off ground\n4. Roll slowly from mid-back to upper back\n5. Pause on tight spots, breathe into them"},{name:"Foam Roll Glutes",emoji:"üß±",equipment:"foam roller",focus:["butt","spine"],duration:"45 sec each side",howTo:"1. Sit on roller, hands behind for support\n2. Cross right ankle over left knee\n3. Lean into right glute\n4. Roll slowly back and forth\n5. Find tender spots, hold and breathe"},{name:"Foam Roll IT Band",emoji:"üß±",equipment:"foam roller",focus:["butt"],duration:"45 sec each side",howTo:"1. Lie on side, roller under outer thigh\n2. Support yourself with forearm and top foot\n3. Roll from hip to just above knee\n4. Pause on tight spots\n5. Switch sides and repeat"},{name:"Pull-Ups",emoji:"üîù",equipment:"pull-up bar",focus:["arms","core"],duration:"5-8 reps",howTo:"1. Grip bar with palms facing away, shoulder-width\n2. Hang with arms fully extended\n3. Pull yourself up until chin clears bar\n4. Squeeze shoulder blades together\n5. Lower slowly with control"},{name:"Dead Hang",emoji:"üôå",equipment:"pull-up bar",focus:["arms","spine"],duration:"30-60 sec",howTo:"1. Grip bar overhead, palms forward\n2. Let your body hang freely\n3. Relax shoulders, feel spine decompress\n4. Breathe deeply\n5. GREAT for spinal decompression after sitting!"},{name:"Push-Ups",emoji:"üîª",equipment:"push-up bar",focus:["arms","core"],duration:"10-15 reps",howTo:"1. Grip push-up bars, hands under shoulders\n2. Body in straight line, core tight\n3. Lower chest between bars\n4. Push back up to full extension\n5. Bars allow deeper range of motion"},{name:"Tricep Dips (Bar)",emoji:"üîΩ",equipment:"pull-up bar",focus:["arms"],duration:"10 reps",howTo:"1. If bar allows, grip with hands behind you\n2. Feet forward, weight on hands\n3. Lower body by bending elbows\n4. Go to 90¬∞ elbow bend\n5. Push back up, squeeze triceps"},{name:"Ab Wheel Rollout",emoji:"‚ò∏Ô∏è",equipment:"ab wheel",focus:["core","arms"],duration:"8-10 reps",howTo:"1. Kneel on mat, grip ab wheel handles\n2. Start with wheel under shoulders\n3. Roll forward slowly, extending body\n4. Go as far as you can with flat back\n5. Use abs to pull wheel back to start"},{name:"Ab Wheel Knee Tuck",emoji:"‚ò∏Ô∏è",equipment:"ab wheel",focus:["core"],duration:"10 reps",howTo:"1. Place feet on ab wheel (or use straps)\n2. Get into plank position, hands on floor\n3. Pull knees toward chest, rolling wheel in\n4. Extend legs back out\n5. Keep core engaged throughout"},{name:"Slider Mountain Climbers",emoji:"üèîÔ∏è",equipment:"sliders",focus:["core","arms"],duration:"30 seconds",howTo:"1. Start in plank, feet on sliders\n2. Slide right knee toward chest\n3. Slide back while bringing left knee in\n4. Keep hips level, core tight\n5. Move smoothly and controlled"},{name:"Slider Pike",emoji:"üî∫",equipment:"sliders",focus:["core","arms"],duration:"10 reps",howTo:"1. Start in plank, feet on sliders\n2. Keep legs straight, slide feet toward hands\n3. Lift hips high into pike position\n4. Slide back to plank with control\n5. Engage core throughout movement"},{name:"Slider Reverse Lunge",emoji:"ü¶µ",equipment:"sliders",focus:["butt","core"],duration:"10 each leg",howTo:"1. Stand with one foot on slider\n2. Slide foot back into lunge position\n3. Lower until front thigh is parallel to floor\n4. Slide foot back to standing\n5. Keep torso upright, core engaged"},{name:"Slider Hamstring Curl",emoji:"üçë",equipment:"sliders",focus:["butt","core"],duration:"12 reps",howTo:"1. Lie on back, heels on sliders\n2. Lift hips into bridge position\n3. Slide heels away from body, extending legs\n4. Curl heels back toward butt\n5. Keep hips lifted throughout"},{name:"Slider Lateral Lunge",emoji:"‚ÜîÔ∏è",equipment:"sliders",focus:["butt","core"],duration:"10 each side",howTo:"1. Stand with one foot on slider\n2. Slide foot out to the side\n3. Bend standing leg, pushing hips back\n4. Slide foot back to center\n5. Keep chest up, sliding leg straight"},{name:"Slider Body Saw",emoji:"ü™ö",equipment:"sliders",focus:["core","arms"],duration:"10 reps",howTo:"1. Forearm plank with feet on sliders\n2. Push body backward, sliding feet away\n3. Pull body forward past starting position\n4. Move like a saw, back and forth\n5. Keep core braced, dont let hips sag"},{name:"Trampoline Bounce",emoji:"ü§∏",equipment:"trampoline",focus:["core","butt"],duration:"2 minutes",howTo:"1. Stand in center of mini trampoline\n2. Begin gentle bouncing\n3. Keep core engaged, arms relaxed\n4. Gradually increase bounce height\n5. Great for lymphatic drainage and energy!"},{name:"Trampoline Twist",emoji:"ü§∏",equipment:"trampoline",focus:["core","spine"],duration:"1 minute",howTo:"1. Bounce on trampoline\n2. While airborne, twist hips left and right\n3. Keep upper body facing forward\n4. Arms can swing naturally for balance\n5. Works obliques and loosens spine"},{name:"Trampoline High Knees",emoji:"ü§∏",equipment:"trampoline",focus:["core","butt"],duration:"1 minute",howTo:"1. Bounce on trampoline\n2. Alternate driving knees up high\n3. Pump arms like running\n4. Stay on balls of feet\n5. Gets heart rate up quickly!"},{name:"Seated Meditation",emoji:"üßò‚Äç‚ôÇÔ∏è",equipment:"none",focus:["spine"],duration:"3 minutes",howTo:"1. Sit comfortably, spine tall\n2. Close eyes, rest hands on knees\n3. Focus on breath: in through nose, out through mouth\n4. Notice thoughts without judgment, let them pass\n5. Return focus to breath each time mind wanders"},{name:"Body Scan Meditation",emoji:"üßò‚Äç‚ôÄÔ∏è",equipment:"yoga mat",focus:["spine","core"],duration:"3 minutes",howTo:"1. Lie on your back, arms at sides\n2. Close eyes, breathe deeply\n3. Scan from toes to head, noticing sensations\n4. Release tension in each body part\n5. Especially release jaw, shoulders, and hips"},{name:"Standing Breathing Exercise",emoji:"üå¨Ô∏è",equipment:"none",focus:["core","spine"],duration:"1 minute",howTo:"1. Stand tall, feet hip-width apart\n2. Inhale deeply for 4 counts through nose\n3. Hold for 4 counts\n4. Exhale slowly for 6 counts through mouth\n5. Repeat 5 times. Notice tension leaving body"},{name:"Jab-Cross Combo",emoji:"ü•ä",equipment:"none",focus:["arms","core"],duration:"30 seconds",howTo:"1. Stand in fighting stance (one foot forward)\n2. Jab: quick punch with front hand\n3. Cross: powerful punch with back hand, rotate hips\n4. Return hands to guard position each time\n5. Stay light on feet, keep core engaged"},{name:"Front Kicks",emoji:"ü¶µ",equipment:"none",focus:["butt","core"],duration:"10 each leg",howTo:"1. Stand in fighting stance\n2. Lift front knee up\n3. Extend leg forward in a snap kick\n4. Retract quickly back to guard\n5. Alternate legs, engage core for balance"},{name:"Roundhouse Kicks",emoji:"ü•ã",equipment:"none",focus:["butt","core","spine"],duration:"8 each side",howTo:"1. Stand sideways to target\n2. Pivot on front foot\n3. Swing back leg in an arc\n4. Strike with top of foot or shin\n5. Great for hip mobility and glute power"},{name:"Uppercut-Hook Combo",emoji:"ü•ä",equipment:"none",focus:["arms","core"],duration:"30 seconds",howTo:"1. Fighting stance, hands at chin\n2. Uppercut: drive fist upward with legs and hips\n3. Hook: swing arm in horizontal arc\n4. Alternate: left uppercut, right hook\n5. Power comes from hip rotation, not just arms"},{name:"Burpees",emoji:"üî•",equipment:"none",focus:["core","arms","butt"],duration:"8 reps",howTo:"1. Stand tall\n2. Drop into squat, hands on floor\n3. Jump feet back to plank\n4. Do a push-up (optional)\n5. Jump feet to hands, explode up with a jump"},{name:"Mountain Climbers",emoji:"‚õ∞Ô∏è",equipment:"none",focus:["core","arms"],duration:"30 seconds",howTo:"1. Start in plank position\n2. Drive right knee toward chest\n3. Quickly switch legs\n4. Keep hips level, core tight\n5. Move as fast as you can with good form"},{name:"Squat Jumps",emoji:"‚¨ÜÔ∏è",equipment:"none",focus:["butt","core"],duration:"10 reps",howTo:"1. Stand with feet shoulder-width apart\n2. Squat down to 90¬∞\n3. Explode upward into a jump\n4. Land softly, immediately squat again\n5. Arms swing for momentum"},{name:"High Knees",emoji:"üèÉ",equipment:"none",focus:["core","butt"],duration:"30 seconds",howTo:"1. Stand tall, feet hip-width\n2. Run in place, driving knees high\n3. Each knee should reach hip height\n4. Pump arms naturally\n5. Stay on balls of feet, quick turnover"},{name:"Glute Bridge",emoji:"üçë",equipment:"yoga mat",focus:["butt","core"],duration:"15 reps",howTo:"1. Lie on back, knees bent, feet flat\n2. Drive through heels to lift hips\n3. Squeeze glutes HARD at the top\n4. Hold 2 seconds\n5. Lower slowly. Feel the burn!"},{name:"Fire Hydrants",emoji:"üî•",equipment:"yoga mat",focus:["butt"],duration:"12 each side",howTo:"1. Start on hands and knees\n2. Keep knee bent at 90¬∞\n3. Lift right knee out to the side\n4. Raise until thigh is parallel to floor\n5. Lower slowly, repeat, switch sides"},{name:"Donkey Kicks",emoji:"ü´è",equipment:"yoga mat",focus:["butt","core"],duration:"12 each side",howTo:"1. Start on hands and knees\n2. Keep right knee bent at 90¬∞\n3. Press right foot toward ceiling\n4. Squeeze glute at the top\n5. Lower without touching knee down, repeat"},{name:"Plank Hold",emoji:"üèóÔ∏è",equipment:"yoga mat",focus:["core","arms"],duration:"30-45 sec",howTo:"1. Forearms on mat, elbows under shoulders\n2. Extend legs back, toes on floor\n3. Body in perfectly straight line\n4. Engage core, squeeze glutes\n5. Don't hold breath! Breathe steadily"},{name:"Side Plank",emoji:"üìê",equipment:"yoga mat",focus:["core","arms"],duration:"20 sec each side",howTo:"1. Lie on right side, forearm on mat\n2. Stack feet or stagger for balance\n3. Lift hips, body in straight line\n4. Top arm on hip or extended up\n5. Hold, then switch sides"},{name:"Bicycle Crunches",emoji:"üö¥",equipment:"yoga mat",focus:["core"],duration:"20 reps",howTo:"1. Lie on back, hands behind head\n2. Lift shoulders off mat\n3. Bring right knee to left elbow\n4. Extend right leg while switching\n5. Left knee to right elbow. Keep pedaling!"},{name:"Superman Hold",emoji:"ü¶∏",equipment:"yoga mat",focus:["spine","butt","core"],duration:"10 reps, 3 sec hold",howTo:"1. Lie face down, arms extended overhead\n2. Simultaneously lift arms, chest, and legs\n3. Squeeze glutes and lower back\n4. Hold for 3 seconds at top\n5. Lower slowly. Counteracts sitting posture!"},{name:"Dead Bug",emoji:"üêõ",equipment:"yoga mat",focus:["core","spine"],duration:"10 reps each side",howTo:"1. Lie on back, arms pointing to ceiling\n2. Knees bent at 90¬∞ over hips\n3. Lower right arm and left leg simultaneously\n4. Keep lower back pressed into floor\n5. Return to start, switch sides"}],y=["Are you glad you finished it so fast? Way to go!","Notice how capable you are when you commit to something?","You chose this yourself. That inner fire is all yours.","Feel that momentum building? That's YOUR power at work.","Another one done. You're proving to yourself what you're made of.","How does it feel to keep your promises to yourself?","You just showed up for yourself again. That's real strength.","Look at you ‚Äî following through because YOU believe in yourself.","Every task you complete is a vote for the person you're becoming.","You decided, you acted, you delivered. That's self-trust in action.","Can you feel your confidence growing? You earned that.","You chose it. You owned it. That's pure power.","This is what living with purpose looks like. You're doing it.","Your future self is thanking you right now. Keep going.","Each completed action rewires your brain for success. Feel the shift?","You ARE your own biggest cheerleader. And the crowd goes wild!","The discipline you're building right now is changing your life.","Notice the difference between thinking about it and actually doing it? You did it.","You're not waiting for permission anymore. You're taking charge.","How good does it feel to be someone who finishes what they start?","Results are permanent and you just created one. Feel that power!","Your actions are speaking louder than any doubt ever could.","Remember this feeling of accomplishment ‚Äî you created it yourself.","You're building unstoppable momentum. One action at a time.","The person who started this task and the person finishing it just leveled up.","This is for YOU. Every action builds the life you want.","That inner voice saying 'I can do this' ‚Äî you just proved it right again.","Progress isn't always visible, but you can feel it. Trust that.","You chose purpose. That's a win worth celebrating!","Every completed task is evidence that you are exactly who you want to be.","You just exercised the most powerful form of influence ‚Äî self-influence.","Authority isn't given. It's built through actions like this one.","Your brain just recorded evidence of who you really are. A finisher.","Discipline is choosing your future self over your present self. You just did that.","Focus creates authority. Authority creates momentum. You have both now.","You led yourself with clarity and action. That's true leadership.","Every completed action raises your internal compliance threshold. You expect more from yourself now.","The tribe follows the person who follows through. You just proved you're that person.","Your emotional state just shifted. That's neurological proof of progress.","Expectancy drives behavior. You just raised your own expectations. Level up.","Your ADHD brain just crushed it. That dopamine hit? You earned it.","You stayed focused and finished. That focus is your superpower!","You started AND finished. Legendary. Your brain is incredible.","You chose NOW. That's executive function at its finest!","ADHD brains collect wins like gold coins. You just got one. Stack another!","You showed up and got it DONE. Pure power move.","Your working memory held strong and you delivered. Champion energy!","Smooth transition between tasks ‚Äî your brain is getting stronger every day!","Your brain loves novelty? Here's some: you just completed another task! Fresh win!","That focus? That drive? That's your ADHD superpower in full effect."],v=[{xp:0,title:"Starter",emoji:"üå±",msg:"Every master was once a beginner. You just took the first step."},{xp:100,title:"Spark",emoji:"‚ö°",msg:"You have the spark. Most people never even start."},{xp:300,title:"Mover",emoji:"üöÄ",msg:"You are now in motion. Objects in motion stay in motion."},{xp:600,title:"Builder",emoji:"üèóÔ∏è",msg:"You are building something real. Brick by brick, action by action."},{xp:1e3,title:"Achiever",emoji:"üèÜ",msg:"You don't just set goals ‚Äî you achieve them. That's rare."},{xp:1500,title:"Crusher",emoji:"üíé",msg:"You crush resistance like it's nothing. Unstoppable momentum."},{xp:2500,title:"Unstoppable",emoji:"üî•",msg:"They can't stop what they can't catch. You are Unstoppable."},{xp:4e3,title:"Legend",emoji:"üëë",msg:"Legends aren't born. They're built through relentless action."},{xp:6e3,title:"Master of Purpose",emoji:"‚ú®",msg:"You've mastered the art of living with purpose. You ARE the authority."}];function b(e){for(var t=v[0],n=v.length-1;n>=0;n--)if(e>=v[n].xp){(t=v[n]).index=n;break}var o=v[t.index+1]||null,a=o?(e-t.xp)/(o.xp-t.xp)*100:100;return{current:t,next:o,progress:Math.min(100,Math.round(a)),index:t.index}}var w=0,k=0,x=18e5;function E(e){return e<=1?1:2===e?1.5:3===e?2:4===e?2.5:3}const I=[{id:"hat_trick",name:"Hat Trick",emoji:"üé©",desc:"3 actions in one day",xp:50,type:"daily",check:function(e){var t=(new Date).toDateString(),n=0;return e.log.forEach(function(e){e.date===t&&n++}),n>=3}},{id:"pentakill",name:"Pentakill",emoji:"‚öîÔ∏è",desc:"5 actions in one day",xp:75,type:"daily",check:function(e){var t=(new Date).toDateString(),n=0;return e.log.forEach(function(e){e.date===t&&n++}),n>=5}},{id:"early_bird",name:"Early Bird",emoji:"üê¶",desc:"Complete action before 8 AM",xp:40,type:"daily",check:function(e){return(new Date).getHours()<8&&e.log.length>0&&e.log[e.log.length-1].date===(new Date).toDateString()}},{id:"night_owl",name:"Night Owl",emoji:"ü¶â",desc:"Complete action after 10 PM",xp:30,type:"daily",check:function(e){return(new Date).getHours()>=22&&e.log.length>0&&e.log[e.log.length-1].date===(new Date).toDateString()}},{id:"speed_demon",name:"Speed Demon",emoji:"‚ö°",desc:"Finish action in under 5 min",xp:35,type:"daily",check:function(e){return e.log.some(function(e){return e.date===(new Date).toDateString()&&e.actualMinutes&&e.actualMinutes<5})}},{id:"comeback_kid",name:"Comeback Kid",emoji:"üí™",desc:"Complete an overdue action",xp:60,type:"daily",check:function(e){return!0===e._justCompletedOverdue}},{id:"combo_king",name:"Combo King",emoji:"üëä",desc:"Reach a 5x combo today",xp:100,type:"daily",check:function(){return w>=5}},{id:"category_sweep",name:"Category Sweep",emoji:"üåà",desc:"Actions in all 6 categories this week",xp:150,type:"weekly",check:function(e){var t=S(),n={};return e.log.forEach(function(e){e.date&&new Date(e.date)>=t&&e.category&&(n[e.category]=!0)}),Object.keys(n).length>=6}},{id:"week_warrior",name:"Week Warrior",emoji:"‚öîÔ∏è",desc:"20+ actions this week",xp:100,type:"weekly",check:function(e){var t=S(),n=0;return e.log.forEach(function(e){e.date&&new Date(e.date)>=t&&n++}),n>=20}},{id:"full_wheel",name:"Full Wheel",emoji:"‚òØÔ∏è",desc:"All 6 wheel categories > 5",xp:200,type:"weekly",check:function(e){try{return!!vt&&vt.every(function(e){return e.score>5})}catch(e){return!1}}},{id:"streak_keeper",name:"Streak Keeper",emoji:"üîó",desc:"Maintain streak all 7 days",xp:120,type:"weekly",check:function(e){return e.streak>=7}},{id:"first_blood",name:"First Blood",emoji:"üó°Ô∏è",desc:"Complete your first action",xp:25,type:"permanent",check:function(e){return e.log.length>=1}},{id:"streak_master",name:"Streak Master",emoji:"üî•",desc:"7-day streak",xp:100,type:"permanent",check:function(e){return e.bestStreak>=7}},{id:"iron_will",name:"Iron Will",emoji:"üõ°Ô∏è",desc:"30-day streak",xp:500,type:"permanent",check:function(e){return e.bestStreak>=30}},{id:"century_club",name:"Century Club",emoji:"üíØ",desc:"100 total actions",xp:250,type:"permanent",check:function(e){return e.log.length>=100}},{id:"outcome_crusher",name:"Outcome Crusher",emoji:"üéØ",desc:"Complete 5 outcomes",xp:300,type:"permanent",check:function(e){var t=0;return e.outcomes.forEach(function(e){e.completed&&t++}),e.archived&&e.archived.forEach(function(e){e.completed&&t++}),t>=5}},{id:"momentum_500",name:"Momentum 500",emoji:"üöÇ",desc:"Reach 500 momentum points",xp:75,type:"permanent",check:function(e){return e.totalMomentum>=500}},{id:"founding_member",name:"Founding Member",emoji:"üåü",desc:"One of the first 100 users",xp:500,type:"permanent",check:function(){return gn}}];function S(){var e=new Date,t=e.getDay(),n=0===t?6:t-1,o=new Date(e);return o.setDate(e.getDate()-n),o.setHours(0,0,0,0),o}function D(){de.badges?de.badges.length>0&&"string"==typeof de.badges[0]&&(de.badges=de.badges.map(function(e){return{id:e,date:(new Date).toDateString(),count:1}})):de.badges=[]}function B(e,t){if(!e)return!1;var n=(new Date).toDateString();if("daily"===t.type)return e.date===n;if("weekly"===t.type){var o=S();return new Date(e.date)>=o}return!0}function T(e){return de.badges&&de.badges.find(function(t){return t.id===e})||null}const L=[{id:"three_before_noon",text:"Complete 3 actions before noon",xp:50,emoji:"‚òÄÔ∏è",check:function(e){var t=(new Date).toDateString(),n=0;return e.log.forEach(function(e){if(e.date===t)try{parseInt(e.time.split(":")[0])<12&&n++}catch(e){n++}}),n>=3}},{id:"weakest_link",text:"Work on your weakest wheel category",xp:30,emoji:"üéØ",check:function(e){try{var t=vt;if(!t)return!1;var n=t.reduce(function(e,t){return t.score<e.score?t:e},t[0]),o=(new Date).toDateString();return e.log.some(function(e){return e.date===o&&e.category===n.id})}catch(e){return!1}}},{id:"speed_round",text:"Finish an action in under 10 minutes",xp:25,emoji:"‚è±Ô∏è",check:function(e){return e.log.some(function(e){return e.date===(new Date).toDateString()&&e.actualMinutes&&e.actualMinutes<=10})}},{id:"category_explorer",text:"Complete actions in 3 different categories",xp:40,emoji:"üó∫Ô∏è",check:function(e){var t=(new Date).toDateString(),n={};return e.log.forEach(function(e){e.date===t&&e.category&&(n[e.category]=!0)}),Object.keys(n).length>=3}},{id:"combo_warrior",text:"Build a 3x combo streak",xp:35,emoji:"üî•",check:function(){return w>=3}},{id:"priming_power",text:"Start your day with Power Priming",xp:20,emoji:"üß†",check:function(){try{var e="lwp_priming_times_"+(new Date).toDateString();return JSON.parse(localStorage.getItem(e)||"[]").length>0}catch(e){return!1}}},{id:"five_alive",text:"Complete 5 actions today",xp:45,emoji:"üñêÔ∏è",check:function(e){var t=(new Date).toDateString(),n=0;return e.log.forEach(function(e){e.date===t&&n++}),n>=5}},{id:"morning_momentum",text:"Complete 2 actions before 10 AM",xp:35,emoji:"üåÖ",check:function(e){var t=(new Date).toDateString(),n=0;return e.log.forEach(function(e){if(e.date===t)try{parseInt(e.time.split(":")[0])<10&&n++}catch(e){}}),n>=2}},{id:"deep_work",text:"Spend 45+ minutes on a single action",xp:40,emoji:"üßò",check:function(e){return e.log.some(function(e){return e.date===(new Date).toDateString()&&e.actualMinutes&&e.actualMinutes>=45})}}];function C(){var e="lwp_challenges_"+(new Date).toDateString(),t=localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){}for(var n=(new Date).toDateString(),o=0,a=0;a<n.length;a++)o+=n.charCodeAt(a);for(var i=L.slice(),r=[],s=0;s<3&&i.length>0;s++){var c=(o*(s+7)+13*s)%i.length;r.push({id:i[c].id,completed:!1}),i.splice(c,1)}return localStorage.setItem(e,JSON.stringify(r)),r}function M(){var e=document.getElementById("confettiContainer");if(e){e.innerHTML="";for(var t=["#f39c12","#e84393","#00d2a0","#6c5ce7","#3498db","#ffd32a","#e74c3c","#1abc9c"],n=0;n<60;n++){var o=document.createElement("div");o.className="confetti-piece",o.style.left=100*Math.random()+"%",o.style.background=t[Math.floor(Math.random()*t.length)],o.style.animationDelay=.5*Math.random()+"s",o.style.animationDuration=1.5*Math.random()+1.5+"s";var a=6*Math.random()+4;o.style.width=a+"px",o.style.height=a+"px",o.style.borderRadius=Math.random()>.5?"50%":"2px",e.appendChild(o)}e.classList.remove("hidden"),setTimeout(function(){e.classList.add("hidden"),e.innerHTML=""},3e3)}}function A(e){var t=new Date,n=new Date(t);n.setDate(t.getDate()-t.getDay()-7*e),n.setHours(0,0,0,0);var o=new Date(n);o.setDate(n.getDate()+7);var a=0,i={};de.log.forEach(function(e){var t=new Date(e.date);if(t>=n&&t<o){if("all"!==Xe&&e.category&&e.category!==Xe)return;a++,e.category&&(i[e.category]=!0)}});var r=Math.min(7,de.streak),s="lwp_weekly_challenges_"+n.toDateString(),c=0;try{var l=localStorage.getItem(s);l&&(c=parseInt(l)||0)}catch(e){}return{score:10*a+5*w+15*r+25*c+10*Object.keys(i).length,actions:a,categories:Object.keys(i).length,streakDays:r}}const _=["You are becoming the authority in your own life.","Discipline is prioritizing the needs of your future self. You just did that.","Every action you take builds your internal authority. People follow those who follow through.","Confidence comes from kept promises. You just kept one to yourself.","The five pillars of authority: confidence, discipline, leadership, gratitude, enjoyment. You're building all five.","Focus creates authority. Authority creates compliance. Your focus just leveled up.","You took the lead. That's what champions do.","Your brain just recorded this win. It's rewiring for more success.","Expectancy drives behavior. Expect more from yourself ‚Äî you just proved you can deliver.","The strongest form of influence is self-influence. You just exercised it."];function j(){var e=document.getElementById("levelBadge");if(e&&de){var t=b(de.totalMomentum);e.innerHTML='<span class="level-emoji">'+t.current.emoji+'</span><span class="level-title">'+t.current.title+"</span>"}}function H(){var e=document.getElementById("comboDisplay");if(e)if(w>=2){var t=E(w);e.innerHTML='<span class="combo-fire">üî•</span> COMBO x'+w+' <span class="combo-mult">'+t+"x</span>",e.classList.remove("hidden"),e.classList.add("combo-pulse"),setTimeout(function(){e.classList.remove("combo-pulse")},600)}else e.classList.add("hidden")}function O(){var e=document.getElementById("dailyChallengesContainer");if(e){var t=C(),n="";t.forEach(function(e){var t=L.find(function(t){return t.id===e.id});if(t){var o=e.completed?"challenge-card completed":"challenge-card";n+='<div class="'+o+'"><span class="challenge-emoji">'+t.emoji+'</span><div class="challenge-info"><div class="challenge-text">'+t.text+'</div><div class="challenge-xp">+'+t.xp+' XP</div></div><span class="challenge-status">'+(e.completed?"‚úÖ":"‚¨ú")+"</span></div>"}}),e.innerHTML=n}}function q(){var e=document.getElementById("badgesGrid");if(e&&de){D();var t=I.map(function(e){var t=T(e.id);return{badge:e,entry:t,active:t&&B(t,e),everEarned:!!t,count:t?t.count||1:0}});t.sort(function(e,t){return e.active&&!t.active?-1:!e.active&&t.active?1:e.everEarned&&!t.everEarned?-1:!e.everEarned&&t.everEarned?1:0});var n={daily:"DAILY",weekly:"WEEKLY",permanent:""},o={daily:"#00d2a0",weekly:"#3498db",permanent:"#6c5ce7"},a="";t.forEach(function(e){var t,i,r=e.badge;e.active?(t="badge-item earned",i=""):e.everEarned&&"permanent"!==r.type?(t="badge-item faded",i='<span class="badge-again">earn again</span>'):e.everEarned?(t="badge-item earned",i=""):(t="badge-item locked",i="");var s=e.active?'<span class="badge-xp earned">+'+r.xp+" XP</span>":'<span class="badge-xp">'+r.xp+" XP</span>",c="permanent"!==r.type?'<span class="badge-type" style="color:'+o[r.type]+'">'+n[r.type]+"</span>":"",l=e.count>1?'<span class="badge-count">x'+e.count+"</span>":"";a+='<div class="'+t+'" title="'+r.desc+'">'+c+'<span class="badge-emoji">'+(e.active||e.everEarned&&"permanent"===r.type?r.emoji:"üîí")+"</span>"+l+'<span class="badge-name">'+r.name+"</span>"+s+i+"</div>"}),e.innerHTML=a}}function P(){var e=document.getElementById("weeklyPowerContainer"),t=document.getElementById("weeklyPowerContainer2");if(e||t){var n=function(){for(var e=[],t=0;t<4;t++)e.push(A(t));return e}(),o=n[0],a=n[1],i="";a.score>0&&o.score>a.score?i='<span class="pwr-stat pwr-stat-beat">&#128293; Beating last week!</span>':a.score>0&&a.score>o.score&&(i='<span class="pwr-stat pwr-stat-chase">&#9650; '+(a.score-o.score)+" to beat last wk</span>");for(var r=Math.max.apply(null,n.map(function(e){return e.score}))||1,s=n.length-1;s>=0;s--){'<div class="pwr-mini-bar'+(0===s?" pwr-active":"")+'" style="height:'+Math.max(8,Math.round(n[s].score/r*100))+'%" title="'+n[s].score+' pts"></div>'}var c="";w>=2&&(c='<span class="pwr-stat pwr-stat-combo">&#128293; x'+w+" combo</span>");var l='<div class="pwr-bar pwr-bar-full"><div class="pwr-stats-row"><span class="pwr-stat pwr-stat-actions">&#9989; '+o.actions+' actions</span><span class="pwr-stat pwr-stat-cats">&#127752; '+o.categories+' categories</span><span class="pwr-stat pwr-stat-streak">&#128293; '+o.streakDays+"d streak</span>"+c+i+"</div></div>";e&&(e.innerHTML='<div class="pwr-context-main">'+l+"</div>"),t&&(t.innerHTML='<div class="pwr-context-log">'+l+"</div>")}}var Y=[{file:"audio/success-1.mp3",name:"Success"},{file:"audio/achievement-bell.mp3",name:"Achievement Bell"},{file:"audio/unlock.mp3",name:"Unlock"},{file:"audio/quick-win.mp3",name:"Quick Win"},{file:"audio/bonus-collect.mp3",name:"Bonus"},{file:"audio/winning-chimes.mp3",name:"Winning Chimes"},{file:"audio/payout.mp3",name:"Payout"},{file:"audio/applause-1.mp3",name:"Applause"},{file:"audio/applause-2.mp3",name:"Applause 2"},{file:"audio/cheer.mp3",name:"Cheer"}],R=[];var N=-1;function F(){try{if(0===R.length)return;var e;do{e=Math.floor(Math.random()*R.length)}while(e===N&&R.length>1);N=e;var t=R[e];t.currentTime=0,t.volume=.6;var n=t.play();n&&n.catch(function(){})}catch(e){console.log("Audio praise skipped:",e.message)}}function z(e){if(de){de._justCompletedOverdue=e||!1;var t=b(de.totalMomentum-15),n=function(){var e=Date.now();k&&e-k<=x?w++:w=1,k=e;try{var t="lwp_combo_"+(new Date).toDateString();localStorage.setItem(t,JSON.stringify({count:w,lastTime:k}))}catch(e){}return w}(),o=E(n);if(o>1){var a=Math.round(15*(o-1));de.totalMomentum+=a,de.log.length>0&&(de.log[de.log.length-1].comboBonus=a,de.log[de.log.length-1].comboLevel=n)}var i=b(de.totalMomentum);i.index>t.index&&setTimeout(function(){var e,t;e=i,(t=document.getElementById("levelUpOverlay"))&&(document.getElementById("levelUpEmoji").textContent=e.current.emoji,document.getElementById("levelUpTitle").textContent=e.current.title,document.getElementById("levelUpMsg").textContent=e.current.msg,t.classList.remove("hidden"),M(),setTimeout(function(){t.classList.add("hidden")},5e3))},800);var r=function(){if(!de)return[];D();var e=[],t=(new Date).toDateString();return I.forEach(function(n){n.type;var o=T(n.id);if(!o||!B(o,n))try{n.check(de)&&(o?(o.date=t,o.count=(o.count||1)+1):de.badges.push({id:n.id,date:t,count:1}),de.totalMomentum+=n.xp||0,e.push(n))}catch(e){}}),e}();if(r.length>0){var s=i.index>t.index?5500:800;r.forEach(function(e,t){setTimeout(function(){!function(e){var t=document.getElementById("badgeUnlockOverlay");t&&(document.getElementById("badgeUnlockEmoji").textContent=e.emoji,document.getElementById("badgeUnlockName").textContent=e.name,document.getElementById("badgeUnlockDesc").textContent=e.desc+" ‚Äî +"+e.xp+" XP!",t.classList.remove("hidden"),M(),setTimeout(function(){t.classList.add("hidden")},4e3))}(e)},s+4500*t)})}r.length;var c=function(){if(!de)return[];var e=C(),t=[];if(e.forEach(function(e){if(!e.completed){var n=L.find(function(t){return t.id===e.id});n&&n.check(de)&&(e.completed=!0,de.totalMomentum+=n.xp,t.push(n))}}),t.length>0){var n="lwp_challenges_"+(new Date).toDateString();localStorage.setItem(n,JSON.stringify(e))}return t}();c.forEach(function(e,t){setTimeout(function(){var t,n;t=e,(n=document.getElementById("challengeToast"))&&(document.getElementById("challengeToastText").textContent=t.emoji+" "+t.text+" ‚Äî +"+t.xp+" XP!",n.classList.remove("hidden"),n.classList.add("toast-animate"),setTimeout(function(){n.classList.add("hidden"),n.classList.remove("toast-animate")},3500))},500+4e3*t)});try{var l=new Date;l.setDate(l.getDate()-l.getDay()),l.setHours(0,0,0,0);var d="lwp_weekly_challenges_"+l.toDateString(),u=parseInt(localStorage.getItem(d)||"0");u+=c.length,localStorage.setItem(d,JSON.stringify(u))}catch(e){}delete de._justCompletedOverdue,j(),H(),O(),q(),P()}}const W=[{text:"The only impossible journey is the one you never begin.",author:"Tony Robbins"},{text:"It's not about the goal. It's about becoming the type of person that can accomplish the goal.",author:"Tony Robbins"},{text:"Where focus goes, energy flows.",author:"Tony Robbins"},{text:"The path to success is to take massive, determined action.",author:"Tony Robbins"},{text:"Setting goals is the first step in turning the invisible into the visible.",author:"Tony Robbins"},{text:"When you are grateful, fear disappears and abundance appears.",author:"Tony Robbins"},{text:"When something is important enough, you do it even if the odds are not in your favor.",author:"Elon Musk"},{text:"I think it's possible for ordinary people to choose to be extraordinary.",author:"Elon Musk"},{text:"Persistence is very important. You should not give up unless you are forced to give up.",author:"Elon Musk"},{text:"Your time is limited, don't waste it living someone else's life.",author:"Steve Jobs"},{text:"The people who are crazy enough to think they can change the world are the ones who do.",author:"Steve Jobs"},{text:"When you want something, all the universe conspires in helping you to achieve it.",author:"Paulo Coelho"},{text:"There is only one thing that makes a dream impossible to achieve: the fear of failure.",author:"Paulo Coelho"},{text:"The secret of life is to fall seven times and to get up eight times.",author:"Paulo Coelho"},{text:"One day you will wake up and there won't be any more time to do the things you've always wanted.",author:"Paulo Coelho"},{text:"The mind is everything. What you think you become.",author:"Buddha"},{text:"Do not dwell in the past, do not dream of the future, concentrate the mind on the present moment.",author:"Buddha"},{text:"What we think, we become.",author:"Buddha"},{text:"The only real failure in life is not to be true to the best one knows.",author:"Buddha"},{text:"Your thoughts form your reality. Change your thoughts and you change your world.",author:"Marisa Peer"},{text:"The strongest force in the human personality is the need to stay consistent with how we define ourselves.",author:"Marisa Peer"},{text:"You are enough. You always have been and you always will be.",author:"Marisa Peer"},{text:"The way you feel about yourself is the way the world will feel about you.",author:"Marisa Peer"},{text:"Only you can take inner freedom away from yourself, or give it to yourself.",author:"Michael A. Singer"},{text:"The truth is, everything will be okay as soon as you are okay with everything.",author:"Michael A. Singer"},{text:"You are not the voice of the mind ‚Äî you are the one who hears it.",author:"Michael A. Singer"},{text:"The highest spiritual path is life itself.",author:"Michael A. Singer"},{text:"The present is theirs; the future, for which I really worked, is mine.",author:"Nikola Tesla"},{text:"If you want to find the secrets of the universe, think in terms of energy, frequency and vibration.",author:"Nikola Tesla"},{text:"I do not think there is any thrill that can go through the human heart like that felt by the inventor.",author:"Nikola Tesla"},{text:"It always seems impossible until it's done.",author:"Nelson Mandela"},{text:"I never lose. I either win or learn.",author:"Nelson Mandela"},{text:"The greatest glory in living lies not in never falling, but in rising every time we fall.",author:"Nelson Mandela"},{text:"Education is the most powerful weapon which you can use to change the world.",author:"Nelson Mandela"},{text:"Done is better than perfect.",author:"Sheryl Sandberg"},{text:"You can have it all. Just not all at once.",author:"Oprah Winfrey"},{text:"The biggest adventure you can take is to live the life of your dreams.",author:"Oprah Winfrey"},{text:"Think like a queen. A queen is not afraid to fail.",author:"Oprah Winfrey"},{text:"Life shrinks or expands in proportion to one's courage.",author:"Ana√Øs Nin"},{text:"I am not afraid of storms, for I am learning how to sail my ship.",author:"Louisa May Alcott"},{text:"The question isn't who is going to let me; it's who is going to stop me.",author:"Ayn Rand"},{text:"We can do no great things, only small things with great love.",author:"Mother Teresa"},{text:"You gain strength, courage, and confidence by every experience in which you really stop to look fear in the face.",author:"Eleanor Roosevelt"},{text:"No one can make you feel inferior without your consent.",author:"Eleanor Roosevelt"},{text:"The most common way people give up their power is by thinking they don't have any.",author:"Alice Walker"},{text:"Success is liking yourself, liking what you do, and liking how you do it.",author:"Maya Angelou"},{text:"There is no greater agony than bearing an untold story inside you.",author:"Maya Angelou"},{text:"The way to get started is to quit talking and begin doing.",author:"Walt Disney"},{text:"Success is not final, failure is not fatal: it is the courage to continue that counts.",author:"Winston Churchill"},{text:"You don't have to be great to start, but you have to start to be great.",author:"Zig Ziglar"},{text:"Discipline is the bridge between goals and accomplishment.",author:"Jim Rohn"},{text:"Don't wish it were easier. Wish you were better.",author:"Jim Rohn"},{text:"The secret of getting ahead is getting started.",author:"Mark Twain"},{text:"Believe you can and you're halfway there.",author:"Theodore Roosevelt"},{text:"Action is the foundational key to all success.",author:"Pablo Picasso"},{text:"ADHD is not about knowing what to do, but about doing what you know.",author:"Dr. Russell Barkley"},{text:"People with ADHD are the inventors, the explorers, the ones who see what others miss.",author:"Dr. Edward Hallowell"},{text:"Your brain is not broken. It's a Ferrari engine with bicycle brakes.",author:"Dr. Edward Hallowell"},{text:"ADHD is not a deficit of attention. It's a challenge of regulating attention.",author:"Dr. Russell Barkley"},{text:"The secret to getting ahead is getting started. The secret to getting started is breaking your overwhelming task into small manageable tasks.",author:"Mark Twain"},{text:"You don't have to see the whole staircase, just take the first step.",author:"Martin Luther King Jr."},{text:"Progress, not perfection, is what we should be asking of ourselves.",author:"Julia Cameron"},{text:"The best time to plant a tree was 20 years ago. The second best time is now.",author:"Chinese Proverb"},{text:"You are not your diagnosis. You are not your struggles. You are the person who keeps showing up despite them.",author:"ADHD Community"},{text:"Having ADHD means your brain works differently, not deficiently.",author:"Dr. Ned Hallowell"},{text:"Imperfect action beats perfect inaction every single time.",author:"Harry Truman"},{text:"If you judge a fish by its ability to climb a tree, it will live its whole life believing it is stupid.",author:"Albert Einstein"},{text:"Your value doesn't decrease based on someone's inability to see your worth.",author:"ADHD Affirmation"},{text:"Start where you are. Use what you have. Do what you can.",author:"Arthur Ashe"},{text:"Every expert was once a beginner who refused to give up.",author:"Helen Hayes"},{text:"The ADHD brain is a powerful machine. The challenge is learning to drive it.",author:"Dr. Ari Tuckman"},{text:"You have survived 100% of your worst days. That's a pretty good track record.",author:"ADHD Affirmation"},{text:"Rest is not the opposite of productivity. It's the foundation of it.",author:"Alex Soojung-Kim Pang"},{text:"A small step in the right direction is better than a big step in the wrong direction.",author:"ADHD Wisdom"},{text:"Your brain craves novelty. That's not a bug ‚Äî that's your superpower for creativity.",author:"Dr. Hallowell"},{text:"Motivation follows action. Don't wait to feel ready ‚Äî just start.",author:"Dr. Russell Barkley"},{text:"You're not lazy. You're not stupid. You're not broken. Your brain just has a different operating system.",author:"Jessica McCabe"},{text:"The only person you should try to be better than is the person you were yesterday.",author:"ADHD Coaching"},{text:"Messy progress is still progress.",author:"ADHD Affirmation"},{text:"Every challenge you face is proof of how strong you are. You keep showing up.",author:"ADHD Community"},{text:"Your only measuring stick is who you were yesterday. Your brain runs its own beautiful race.",author:"ADHD Wisdom"},{text:"Done is better than perfect. Shipped is better than polished. Started is better than planned.",author:"ADHD Coaching"},{text:"The ADHD mind is like a web browser with 100 tabs open. Close a few. Bookmark the rest.",author:"ADHD Community"},{text:"The right systems will unlock everything. Build tools that work with your brain, and watch yourself fly.",author:"ADHD Coaching"},{text:"Some of the most brilliant minds in history had ADHD. You're in good company.",author:"Dr. Hallowell"},{text:"Consistency means choosing to try again. Every time you restart, you level up.",author:"ADHD Affirmation"},{text:"You matter because of who you are, always. Your worth lives inside you, every single day.",author:"ADHD Coaching"},{text:"You already began. That first step is the hardest one, and you already took it.",author:"ADHD Affirmation"},{text:"Your brain knows exactly what lights it up. Feed it the good stuff and it will reward you.",author:"ADHD Wisdom"},{text:"Your brain is brilliant ‚Äî it just came with its own instruction manual. You'll write it yourself.",author:"ADHD Affirmation"},{text:"You have 26 letters in the alphabet and an ADHD brain full of creative plans. You will find the way.",author:"ADHD Wisdom"},{text:"Hyperfocus is your superpower. When you lock in, you are unstoppable.",author:"ADHD Community"},{text:"Be patient with yourself. Self-growth is tender; it's holy ground.",author:"Stephen Covey"},{text:"Fall seven times, stand up eight. That's the ADHD way.",author:"Japanese Proverb"},{text:"The way you speak to yourself matters more than any productivity hack.",author:"ADHD Coaching"},{text:"Your energy is currency. Spend it on things that matter to you.",author:"ADHD Wisdom"},{text:"Celebrate every day you showed up. Those days are building the life you deserve.",author:"ADHD Affirmation"},{text:"ADHD gives you a unique lens on the world. That perspective has value.",author:"Dr. Hallowell"},{text:"Build a life that fits how your brain actually works, and everything starts flowing.",author:"ADHD Coaching"},{text:"Be kind to yourself. Your brain is working behind the scenes, sorting through a world of possibilities.",author:"ADHD Affirmation"},{text:"Rest is fuel for brilliance. Give yourself permission to recharge ‚Äî you deserve it.",author:"ADHD Wisdom"},{text:"Small wins build big momentum. Celebrate every single one.",author:"ADHD Coaching"},{text:"You are allowed to be both a masterpiece and a work in progress simultaneously.",author:"Sophia Bush"},{text:"Your ambition is massive. Give it the right scaffolding and you will build something amazing.",author:"ADHD Coaching"},{text:"Your best looks different every day, and every version of your best is enough.",author:"ADHD Affirmation"},{text:"Your brain experiences time in its own way. Build smart systems around it and you win.",author:"ADHD Coaching"},{text:"You are creative, passionate, and full of ideas. The world needs exactly what you bring.",author:"ADHD Community"},{text:"Every task you start is a victory. Every step forward counts, no matter how small.",author:"ADHD Coaching"},{text:"Your brain is wired for exploration, creativity, and big-picture thinking. Lean into that.",author:"Dr. Hallowell"},{text:"Today's small effort compounds into tomorrow's big results.",author:"James Clear"},{text:"Just start. Motivation follows action, and action is already inside you.",author:"ADHD Wisdom"},{text:"Give yourself the same grace you give your friends. You deserve that kindness too.",author:"ADHD Coaching"},{text:"Every time you choose to try again, you're building resilience most people will never know.",author:"ADHD Affirmation"},{text:"The struggle you're in today is developing the strength you need for tomorrow.",author:"Robert Tew"},{text:"You can't pour from an empty cup. Taking care of yourself isn't selfish ‚Äî it's strategic.",author:"ADHD Wisdom"},{text:"Rejection sensitivity isn't weakness. It means you feel deeply. That's also your greatest strength.",author:"ADHD Community"},{text:"You've been criticizing yourself for years and it hasn't worked. Try approving of yourself and see what happens.",author:"Louise Hay"},{text:"Your potential is not defined by your executive function. It's defined by your heart.",author:"ADHD Affirmation"},{text:"The dishes can wait. The email can wait. But your mental health can't. Take the break.",author:"ADHD Coaching"},{text:"Structure isn't a cage. For the ADHD brain, it's a launchpad.",author:"Dr. Hallowell"},{text:"A bad hour doesn't make a bad day. A bad day doesn't make a bad life. Keep going.",author:"ADHD Affirmation"},{text:"The fact that you're trying, right now, in this moment ‚Äî that already makes you exceptional.",author:"ADHD Coaching"},{text:"Neurodivergent brains built the pyramids, painted the Sistine Chapel, and put humans on the moon.",author:"ADHD History"},{text:"You are not behind. You are on your own path, at your own pace, and that is perfectly okay.",author:"ADHD Affirmation"}];async function G(e){var t=new TextEncoder,n=await crypto.subtle.importKey("raw",t.encode(e+"_lwp_salt_2024"),{name:"PBKDF2"},!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t.encode("life_with_purpose"),iterations:1e5,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}var U=null,K=!1,J=null,V="free";function X(){var e=document.getElementById("upgradeOverlay");e&&e.classList.remove("hidden")}function Q(){var e=document.getElementById("btnUpgrade");e&&(e.style.display="none",function(){var e=document.getElementById("checkoutLink");if(!e)return;if(U){var t="?checkout[custom][uid]="+encodeURIComponent(U.uid);U.email&&(t+="&checkout[email]="+encodeURIComponent(U.email)),e.href=Z+t}else e.href=Z}())}var Z="https://myhabitmagic.lemonsqueezy.com/checkout/buy/bebf041d-868c-40b7-9968-8f458e1cd57e";function $(){document.getElementById("loginScreen").classList.remove("hidden"),document.getElementById("app").classList.add("hidden");var e=document.getElementById("demoBanner");e&&e.classList.add("hidden"),function(e){if(!firebaseReady)return void(e&&e());try{db.collection("meta").doc("founding_members").get().then(function(t){hn=t.exists&&t.data().count||0,e&&e()}).catch(function(){e&&e()})}catch(t){e&&e()}}(function(){var e=Math.max(0,fn-hn);document.querySelectorAll(".founding-spots-count").forEach(function(t){t.textContent=e})})}function ee(){document.getElementById("loginScreen").classList.add("hidden"),document.getElementById("app").classList.remove("hidden")}function te(){if(firebaseReady){var e=new firebase.auth.GoogleAuthProvider;e.setCustomParameters({prompt:"select_account"}),auth.signInWithPopup(e).catch(function(t){console.error("Login error:",t),"auth/popup-blocked"===t.code?(console.log("Popup blocked, trying redirect..."),auth.signInWithRedirect(e)):"auth/popup-closed-by-user"===t.code?console.log("Login cancelled by user"):"auth/cancelled-popup-request"===t.code?console.log("Popup request cancelled"):"auth/unauthorized-domain"===t.code?alert('This domain is not authorized for sign-in. Please add "'+window.location.hostname+'" to Firebase Console > Authentication > Settings > Authorized domains.'):"auth/operation-not-allowed"===t.code?alert("Google sign-in is not enabled. Please enable it in Firebase Console > Authentication > Sign-in method."):alert("Login failed: "+t.message)})}else alert("Firebase is not configured yet. See firebase-config.js for setup instructions.")}function ne(){de=null,auth&&auth.signOut(),U=null,K=!1,J&&(J(),J=null),$()}var oe=14,ae="lwp_demo_started";function ie(){K=!0,U=null,le=ce,localStorage.getItem(ae)||localStorage.setItem(ae,(new Date).toISOString()),re()&&(localStorage.removeItem(ce),localStorage.removeItem(ae),localStorage.setItem(ae,(new Date).toISOString())),ee(),function(){var e=document.getElementById("demoBanner");if(!e)return;if(K){e.classList.remove("hidden");var t=function(){var e=localStorage.getItem(ae);if(!e)return oe;var t=new Date(e),n=new Date,o=Math.floor((n-t)/864e5);return Math.max(0,oe-o)}(),n=document.getElementById("demoExpiresIn");n&&(n.textContent=1===t?"1 day":t+" days",t<=3&&(n.style.color="#ff4444",n.style.fontWeight="800"));var o=document.getElementById("demoProgressFill");if(o){var a=Math.max(0,t/oe*100);o.style.width=a+"%",t<=3?o.style.background="#ff4444":t<=7&&(o.style.background="#ff9800")}var i=document.querySelector(".demo-banner-text");if(i&&de){var r=de.streak||0;t<=2?i.innerHTML="‚è∞ <strong>Trial ends in "+(1===t?"1 day":t+" days")+"!</strong> Your progress disappears soon":t<=4&&r>=7?i.innerHTML="üî• Your <strong>"+r+"-day streak</strong> is epic ‚Äî sign in to keep it forever!":t<=7&&r>=3&&(i.innerHTML="üéÆ Demo Mode ‚Äî <strong>"+t+" days left</strong> ‚Äî üî• "+r+"-day streak at risk!")}}else e.classList.add("hidden")}(),un()}function re(){var e=localStorage.getItem(ae);if(!e)return!1;var t=new Date(e),n=new Date;return Math.floor((n-t)/864e5)>=oe}const se="rpm_momentum_data",ce="life_with_purpose_offline";let le=ce,de=null,ue=null;let me=null,he=null,ge=null,fe=0,pe=!1,ye=0,ve={outcomeId:null,actionId:null};function be(){return{outcomes:[],log:[],streak:0,bestStreak:0,lastActiveDate:null,totalMomentum:0,sheetsUrl:"",sheetsToken:"",reflections:[],archived:[],sessionTaskCount:0,extendedBreakThreshold:Math.floor(2*Math.random())+4,badges:[]}}async function we(){var e=localStorage.getItem(le);if(!e){if(!localStorage.getItem("lwp_migration_done")&&(e=localStorage.getItem("life_with_purpose_data")||localStorage.getItem(se))&&U)try{return de=JSON.parse(e),localStorage.removeItem("life_with_purpose_data"),localStorage.setItem("lwp_migration_done","1"),await xe(),ke()}catch(e){}return de=be(),de}try{var t=JSON.parse(e);if(t&&"object"==typeof t&&void 0!==t.outcomes)return de=t,await xe(),ke()}catch(e){}if(U){var n=await async function(e,t){try{var n=await G(t),o=Uint8Array.from(atob(e),function(e){return e.charCodeAt(0)}),a=o.slice(0,12),i=o.slice(12),r=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},n,i);return(new TextDecoder).decode(r)}catch(e){return console.error("Decryption error:",e),null}}(e,U.uid);if(n)try{return de=JSON.parse(n),ke()}catch(e){console.error("Decrypted data parse error:",e)}}return de=be(),de}function ke(){return de.outcomes&&de.outcomes.forEach(function(e){f[e.category]&&(e.category=f[e.category]),e.actions&&e.actions.forEach(function(e){e.categories&&e.categories.length>0&&(e.categories=e.categories.map(function(e){return f[e]||e}),e.categories=e.categories.filter(function(e,t,n){return n.indexOf(e)===t})),e.extraCategory&&f[e.extraCategory]&&(e.extraCategory=f[e.extraCategory]),e.estMinutes||(e.estMinutes=15)})}),de.log&&de.log.forEach(function(e){e.category&&f[e.category]&&(e.category=f[e.category])}),de.archived&&de.archived.forEach(function(e){f[e.category]&&(e.category=f[e.category]),e.actions&&e.actions.forEach(function(e){e.categories&&e.categories.length>0&&(e.categories=e.categories.map(function(e){return f[e]||e}),e.categories=e.categories.filter(function(e,t,n){return n.indexOf(e)===t}))})}),void 0===de.sessionTaskCount&&(de.sessionTaskCount=0),void 0===de.extendedBreakThreshold&&(de.extendedBreakThreshold=Math.floor(2*Math.random())+4),de.sheetsToken||(de.sheetsToken=""),de.archived||(de.archived=[]),de}async function xe(){if(U&&!K){var e=await async function(e,t){try{var n=await G(t),o=new TextEncoder,a=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},n,o.encode(e)),r=new Uint8Array(a.length+i.byteLength);return r.set(a),r.set(new Uint8Array(i),a.length),btoa(String.fromCharCode.apply(null,r))}catch(e){return console.error("Encryption error:",e),null}}(JSON.stringify(de),U.uid);e&&localStorage.setItem(le,e)}else localStorage.setItem(le,JSON.stringify(de))}function Ee(){U&&!K?xe():localStorage.setItem(le,JSON.stringify(de)),function(){ue&&clearTimeout(ue);ue=setTimeout(function(){Ie()},2e3)}()}function Ie(){if(firebaseReady&&U&&!K)try{db.collection("users").doc(U.uid).set({data:JSON.parse(JSON.stringify(de)),updatedAt:firebase.firestore.FieldValue.serverTimestamp(),email:U.email,displayName:U.displayName},{merge:!0}).catch(function(e){console.error("Firestore save error:",e)})}catch(e){console.error("Firestore save error:",e)}}function Se(){de||(de=be()),void 0===de.sessionTaskCount&&(de.sessionTaskCount=0),void 0===de.extendedBreakThreshold&&(de.extendedBreakThreshold=Math.floor(2*Math.random())+4),de.sheetsToken||(de.sheetsToken=""),de.archived||(de.archived=[]),de.log||(de.log=[]),de.outcomes||(de.outcomes=[]),de.reflections||(de.reflections=[]),de.values||(de.values=[]),de.badges||(de.badges=[])}function De(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)}function Be(){void 0===de.streakFreezes&&(de.streakFreezes=1),de.freezeLog||(de.freezeLog=[]),void 0===de.badDayCompleted&&(de.badDayCompleted=null)}function Te(){var e=(new Date).toDateString();if(de.lastActiveDate!==e){Be();var t,n,o=new Date;if(o.setDate(o.getDate()-1),de.lastActiveDate===o.toDateString()){if(de.streak++,de.streak>0&&de.streak%7==0){de.streakFreezes=(de.streakFreezes||0)+1;try{t=document.getElementById("challengeToast"),n=document.getElementById("challengeToastText"),t&&n&&(n.textContent="üßä Streak Freeze earned! You now have "+de.streakFreezes+" freeze(s).",t.classList.remove("hidden"),setTimeout(function(){t.classList.add("hidden")},4e3))}catch(e){}}}else if(de.lastActiveDate!==e){var a=Le(de.lastActiveDate,e);if(a<=2&&de.streakFreezes>0){de.streakFreezes--,de.freezeLog.push({date:e,daysMissed:a,streakSaved:de.streak}),de.streak++;try{!function(){var e=document.getElementById("challengeToast"),t=document.getElementById("challengeToastText");e&&t&&(t.textContent="üßä Streak Freeze used! Your "+de.streak+"-day streak was saved. ("+de.streakFreezes+" freezes left)",e.classList.remove("hidden"),setTimeout(function(){e.classList.add("hidden")},5e3))}()}catch(e){}}else de.streak=1}de.lastActiveDate=e,de.streak>de.bestStreak&&(de.bestStreak=de.streak),Ee()}}function Le(e,t){if(!e)return 999;var n=new Date(e),o=new Date(t),a=Math.abs(o-n);return Math.floor(a/864e5)}var Ce=0;function Me(){Ce=0,document.querySelectorAll(".bad-day-task").forEach(function(e){e.classList.remove("completed");var t=e.querySelector(".btn-bad-day-done");t&&(t.textContent="Done ‚úì",t.disabled=!1)});var e=document.getElementById("badDayFooter");e&&(e.textContent="Complete any one to keep your streak alive üíñ")}window.completeBadDayTask=function(e){var t=e.closest(".bad-day-task");if(t&&!t.classList.contains("completed")){t.classList.add("completed"),e.textContent="‚úÖ Done!",e.disabled=!0,Ce++,de.totalMomentum=(de.totalMomentum||0)+10;var n=document.getElementById("badDayFooter");if(n&&(1===Ce?n.textContent="Your streak is alive! Keep going or call it a win üíñ":2===Ce&&(n.textContent="Two done! You're doing amazing on a tough day üåü")),1===Ce&&(de.badDayCompleted=(new Date).toDateString(),Te()),Ce>=3){de.totalMomentum+=20,Ee();var o=new Date;de.log.push({text:"Bad Day Mode: Self-care tasks completed",outcome:"Self Care",category:$e()[0].id,time:o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),date:o.toDateString(),points:50}),Ee(),n&&(n.innerHTML='<span style="font-size:1.5rem">üéâ</span> All 3 done! You showed up on a hard day. That\'s the real win.'),setTimeout(function(){document.getElementById("badDayOverlay").classList.add("hidden"),Gt(),F(),Ve(),Me()},2500)}else Ee()}},window.stopBodyDouble=function(){Ae&&(clearInterval(Ae),Ae=null),_e&&(clearInterval(_e),_e=null),Fe();var e=document.getElementById("bodyDoubleOverlay");e&&e.classList.add("hidden");var t=document.getElementById("btnStartBodyDouble"),n=document.getElementById("btnStopBodyDouble");t&&t.classList.remove("hidden"),n&&n.classList.add("hidden");var o=document.getElementById("bodyDoubleTimerDisplay");o&&(o.textContent="15:00");var a=document.getElementById("btnRepeatBodyDouble");a&&a.classList.add("hidden")};var Ae=null,_e=null,je=900,He=null,Oe=[{emoji:"üßë‚Äçüíª",msg:"Your buddy is working quietly beside you..."},{emoji:"üí™",msg:"You're both crushing it! Keep going."},{emoji:"‚òï",msg:"Focus is a superpower. You have it right now."},{emoji:"üìö",msg:"Deep work mode activated. Your buddy is impressed."},{emoji:"üöÄ",msg:"Almost there! Your buddy is cheering you on."},{emoji:"üåü",msg:"You showed up today. That's already a win."},{emoji:"üßò",msg:"Breathe. Focus. You've got this."},{emoji:"üéâ",msg:"Your buddy just completed a task too! You're in sync."}],qe=null,Pe=[];function Ye(){je=900;var e=document.getElementById("bodyDoubleTimerDisplay"),t=document.getElementById("btnStartBodyDouble"),n=document.getElementById("btnStopBodyDouble");t&&t.classList.add("hidden"),n&&n.classList.remove("hidden"),Ae=setInterval(function(){if(--je<=0)return clearInterval(Ae),Ae=null,e&&(e.textContent="00:00"),void function(){_e&&(clearInterval(_e),_e=null);Fe();var e=document.getElementById("bdBuddyEmoji"),t=document.getElementById("bdBuddyStatus");e&&(e.textContent="üéâ");t&&(t.textContent="Session complete! You both crushed it!");de.totalMomentum=(de.totalMomentum||0)+25,Ee(),F();var n=document.getElementById("btnStopBodyDouble"),o=document.getElementById("btnRepeatBodyDouble");n&&n.classList.add("hidden");o&&o.classList.remove("hidden");Ve()}();var t=Math.floor(je/60),n=je%60;e&&(e.textContent=(t<10?"0"+t:t)+":"+(n<10?"0"+n:n))},1e3),Re(),_e=setInterval(Re,3e5);var o=document.querySelector(".bd-sound-btn.active");Ne(o?o.dataset.sound:"none")}function Re(){var e=Oe[Math.floor(Math.random()*Oe.length)],t=document.getElementById("bdBuddyEmoji"),n=document.getElementById("bdBuddyStatus");t&&(t.textContent=e.emoji),n&&(n.textContent=e.msg)}function Ne(e){if(Fe(),"none"!==e)if("ocean"!==e&&"coffee"!==e)try{var t;qe=new(window.AudioContext||window.webkitAudioContext),"rain"===e?t=function(e){for(var t=2*e.sampleRate,n=e.createBuffer(2,t,e.sampleRate),o=0;o<2;o++)for(var a=n.getChannelData(o),i=0,r=0;r<t;r++){var s=2*Math.random()-1;a[r]=(i+.02*s)/1.02,i=a[r],a[r]*=3.5}var c=e.createBufferSource();c.buffer=n,c.loop=!0;var l=e.createBiquadFilter();l.type="bandpass",l.frequency.value=800,l.Q.value=.5;var d=e.createBiquadFilter();d.type="highpass",d.frequency.value=200;var u=e.createGain();return u.gain.value=.25,c.connect(l),l.connect(d),d.connect(u),u.connect(e.destination),c.start(),{source:c,nodes:[l,d,u]}}(qe):"lofi"===e&&(t=function(e){for(var t=2*e.sampleRate,n=e.createBuffer(2,t,e.sampleRate),o=0;o<2;o++)for(var a=n.getChannelData(o),i=0,r=0;r<t;r++){var s=2*Math.random()-1;a[r]=(i+.02*s)/1.02,i=a[r],a[r]*=3.5}var c=e.createBufferSource();c.buffer=n,c.loop=!0;var l=e.createBiquadFilter();l.type="lowpass",l.frequency.value=500,l.Q.value=1;var d=e.createGain();d.gain.value=.25;var u=e.createOscillator();u.type="sine",u.frequency.value=.1;var m=e.createGain();return m.gain.value=.05,u.connect(m),m.connect(d.gain),u.start(),c.connect(l),l.connect(d),d.connect(e.destination),c.start(),{source:c,lfo:u,nodes:[l,d,m]}}(qe)),t&&(Pe.push(t.source),t.lfo&&Pe.push(t.lfo),t.nodes&&t.nodes.forEach(function(e){Pe.push(e)}))}catch(e){console.warn("Could not play ambient sound:",e)}else try{var n=new Audio({ocean:"audio/ocean-waves.m4a",coffee:"audio/coffee-shop.m4a"}[e]);n.loop=!0,n.volume=.4,He=n,n.play().catch(function(e){console.warn("Ambient audio play failed:",e)})}catch(e){console.warn("Could not play ambient sound:",e)}}function Fe(){if(Pe.forEach(function(e){try{e.disconnect()}catch(e){}try{e.stop&&e.stop()}catch(e){}}),Pe=[],qe){try{qe.close()}catch(e){}qe=null}if(He){try{He.pause(),He.currentTime=0}catch(e){}He=null}}function ze(){if(U&&!K){var e=(new Date).toDateString(),t="lwp_feedback_"+e;if(!localStorage.getItem(t))(de.log||[]).filter(function(t){return t.date===e}).length<3||(Math.random()>.3?localStorage.setItem(t,"skipped"):setTimeout(function(){!function(){var e=(new Date).toDateString(),t="lwp_feedback_"+e;localStorage.setItem(t,"shown");var n=document.getElementById("feedbackOverlay");if(!n)return;var o=document.getElementById("feedbackWorked"),a=document.getElementById("feedbackBroken"),i=document.getElementById("feedbackWish"),r=document.getElementById("feedbackRating"),s=document.getElementById("feedbackRatingValue"),c=document.getElementById("feedbackTestimonialSection");o&&(o.value="");a&&(a.value="");i&&(i.value="");r&&(r.value="7");s&&(s.textContent="7");c&&c.classList.add("hidden");var l=de.log&&de.log.length>0?Le(de.log[0].date,e):0,d=document.getElementById("feedbackTitle");d&&(d.textContent=l<=3?"First Impressions üåü":l<=7?"Week 1 Check-In üí¨":l<=14?"How's It Going? ü§î":"Daily Feedback üí¨");n.classList.remove("hidden")}()},3e3))}}var We=["build","create","organize","plan","redesign","overhaul","launch","implement","develop","set up","setup","restructure","revamp","redo","fix everything","clean the whole","entire","complete","finish all","do all"];function Ge(){document.addEventListener("blur",function(e){if(e.target&&e.target.matches('#actionsList input[type="text"], #addActionText, #editActionText'))try{!function(e){var t=(e.value||"").trim().toLowerCase();if(t&&!(t.length<15)){var n=e.parentElement.querySelector(".big-task-nudge");if(n&&n.remove(),t.length>40||We.some(function(e){return t.includes(e)})){var o=document.createElement("div");o.className="big-task-nudge",o.innerHTML='<span class="nudge-icon">üß†</span> <span class="nudge-text">This sounds like a big one! Break it into 2‚Äì3 smaller bites? Your brain will thank you. <strong>Tasks under 20 min each work best.</strong></span><button class="nudge-dismiss" onclick="this.parentElement.remove()">√ó</button>',e.parentElement.appendChild(o),setTimeout(function(){o.parentElement&&o.remove()},15e3)}}}(e.target)}catch(e){console.warn("big task nudge error:",e)}},!0)}function Ue(){Be();var e=document.querySelector(".streak-bar");if(e){var t=e.querySelector(".streak-freeze-count");if(t&&t.remove(),de.streakFreezes>0){var n=document.createElement("span");n.className="streak-freeze-count",n.title=de.streakFreezes+" Streak Freeze(s) available",n.textContent="üßä"+de.streakFreezes,e.appendChild(n)}}}var Ke=[{bg:"rgba(232,67,147,0.12)",border:"#e84393",text:"#f8a5c2"},{bg:"rgba(108,92,231,0.12)",border:"#6c5ce7",text:"#a29bfe"},{bg:"rgba(0,210,160,0.12)",border:"#00d2a0",text:"#55efc4"},{bg:"rgba(243,156,18,0.12)",border:"#f39c12",text:"#ffeaa7"},{bg:"rgba(52,152,219,0.12)",border:"#3498db",text:"#74b9ff"},{bg:"rgba(255,118,117,0.12)",border:"#ff7675",text:"#fab1a0"},{bg:"rgba(253,203,110,0.12)",border:"#fdcb6e",text:"#ffeaa7"},{bg:"rgba(0,184,148,0.12)",border:"#00b894",text:"#55efc4"}];function Je(){var e,t,n,o,a,i,r,s;e="motivationQuote",t="motivationAuthor",n="motivationCard1",o=W[Math.floor(Math.random()*W.length)],a=Ke[Math.floor(Math.random()*Ke.length)],i=document.getElementById(e),r=document.getElementById(t),s=n?document.getElementById(n):i?i.closest(".motivation-card"):null,i&&(i.textContent="‚Äú"+o.text+"‚Äù",i.style.color=a.text),r&&(r.textContent="‚Äî "+o.author,r.style.color=a.border),s&&(s.style.background="linear-gradient(135deg, #0f1a2a, "+a.bg+")",s.style.borderColor=a.border+"44",s.style.boxShadow="0 0 20px "+a.border+"15")}function Ve(){vt=null,bt=0,kt(),function(){var a=document.getElementById("outcomesGrid");a.innerHTML="";var i=de.outcomes.filter(function(e){return et(e)});"all"!==Xe&&(i=i.filter(function(e){return e.category===Xe}));i.sort(function(e,t){return(e.backBurner?1:0)-(t.backBurner?1:0)}),i.forEach(function(i){var r=document.createElement("div");r.className="outcome-card"+(i.completed?" completed":"")+(i.backBurner?" back-burner":""),r.dataset.category=i.category,r.dataset.outcomeId=i.id;var s=$e().find(function(e){return e.id===i.category});s||(s=e.concat(t).concat(n).concat(o).find(function(e){return e.id===i.category}));var c=s?s.color:"#6c5ce7",l=s?m(s.name):i.category;r.style.borderLeftColor=c,r.style.background="linear-gradient(135deg, "+c+"08, "+c+"04, transparent)";var d=function(e,t){var n=e.slice();return n.sort(function(e,n){if(e.done!==n.done)return e.done?1:-1;if(t){var o=wt(e,t),a=wt(n,t);if(o!==a)return a-o}var i=e.categories&&e.categories.length||0;return(n.categories&&n.categories.length||0)-i}),n}(i.actions,i),u=i.actions.filter(function(e){return e.done}).length,h=i.actions.length,g=h>0?Math.round(u/h*100):0,f="";if(i.deadline){var p=new Date(i.deadline),y=new Date,v=Math.ceil((p-y)/864e5);f=v<0?'<span class="outcome-deadline urgent">Overdue by '+Math.abs(v)+"d</span>":v<=3?'<span class="outcome-deadline urgent">'+v+"d left</span>":'<span class="outcome-deadline">'+v+"d left</span>"}var b="",w="";d.forEach(function(e){var t='<span class="action-est">'+(e.estMinutes||15)+"m</span>",n="";if(!e.done&&e.deadline){var o=new Date(e.deadline),a=new Date,r=Math.ceil((o-a)/864e5);n=r<0?'<span class="action-deadline-badge overdue" title="Overdue">'+Math.abs(r)+"d overdue</span>":r<=1?'<span class="action-deadline-badge urgent" title="Due today/tomorrow">today</span>':r<=3?'<span class="action-deadline-badge urgent" title="Due in '+r+' days">'+r+"d</span>":r<=7?'<span class="action-deadline-badge soon" title="Due in '+r+' days">'+r+"d</span>":'<span class="action-deadline-badge" title="Due in '+r+' days">'+r+"d</span>"}var s=e.done?"":wt(e,i),c="";e.done||""===s||(c='<span class="leverage-badge '+(s>=60?"leverage-high":s>=30?"leverage-mid":"leverage-low")+'">'+s+"</span>");var l="",d=e.categories&&e.categories.length>0?e.categories.length:0;!e.done&&d>1&&(l='<span class="cat-count-badge" title="Impacts '+d+' categories">'+d+" cats</span>");var u="";e.done||(u='<button class="btn-focus-action" data-outcome-id="'+i.id+'" data-action-id="'+e.id+'" title="Focus on this action">&#9201;</button>');var m='<li class="draggable" draggable="true" data-action-id="'+e.id+'" data-outcome-id="'+i.id+'"><span class="drag-handle">&#9776;</span><input type="checkbox" class="action-checkbox" data-outcome-id="'+i.id+'" data-action-id="'+e.id+'"'+(e.done?" checked":"")+'><span class="action-text'+(e.done?" done":"")+'" data-outcome-id="'+i.id+'" data-action-id="'+e.id+'">'+rn(e.text)+"</span>"+n+l+c+t+u+"</li>";e.done?w+=m:b+=m});var k=b,x="";u>0&&(x='<div class="completed-actions-toggle" data-outcome-id="'+i.id+'"><span class="toggle-arrow">&#9654;</span> '+u+" completed action"+(u>1?"s":"")+'</div><ul class="outcome-actions-list completed-actions-group hidden" data-outcome-id="'+i.id+'">'+w+"</ul>");var E=i.completed?'<button class="btn-archive-outcome" data-outcome-id="'+i.id+'" title="Archive this outcome">&#128218; Archive</button>':"";r.innerHTML='<div class="outcome-header"><span class="outcome-drag-handle" title="Drag to reorder">&#9776;</span><div class="outcome-header-left"><span class="outcome-wheel-tag" style="background:'+c+"22;color:"+c+";border:1px solid "+c+'44">'+l+'</span><div class="outcome-result">'+rn(i.result)+'</div></div><div class="outcome-header-btns"><button class="outcome-btn btn-back-burner" data-outcome-id="'+i.id+'" title="'+(i.backBurner?"Resume outcome":"Put on back burner")+'">'+(i.backBurner?"&#9654;":"&#9208;")+'</button><button class="outcome-btn btn-add-action-to" data-outcome-id="'+i.id+'" title="Add action">+</button><button class="outcome-btn btn-edit-outcome" data-outcome-id="'+i.id+'" title="Edit outcome">&#9998;</button><button class="outcome-btn btn-delete-outcome" data-outcome-id="'+i.id+'" title="Delete outcome">&#128465;</button></div></div><div class="outcome-purpose"><span class="purpose-label-tag">Why this matters:</span> '+rn(i.purpose)+'</div><ul class="outcome-actions-list">'+k+"</ul>"+x+'<div class="outcome-footer"><div class="outcome-progress"><div class="outcome-progress-bar"><div class="outcome-progress-fill" style="width:'+g+"%;background:"+c+'"></div></div><span>'+u+"/"+h+"</span></div>"+f+E+"</div>",a.appendChild(r)}),document.querySelectorAll(".outcome-actions-list li.draggable").forEach(function(e){e.addEventListener("dragstart",Lt),e.addEventListener("dragover",Ct),e.addEventListener("drop",At),e.addEventListener("dragend",_t),e.addEventListener("dragleave",Mt),e.addEventListener("touchstart",Ot,{passive:!1}),e.addEventListener("touchmove",qt,{passive:!1}),e.addEventListener("touchend",Pt)})}(),function(){var e=$e().map(function(e){return e.id}),t=0;de.log.forEach(function(n){n.category&&-1!==e.indexOf(n.category)&&(t+=n.points||0)});var n=de.outcomes.filter(function(e){return et(e)});n.forEach(function(e){e.completed&&(t+=100)}),document.getElementById("totalMomentum").textContent=t;var o=n.filter(function(e){return e.completed}).length;document.getElementById("outcomesCompleted").textContent=o;var a=0;n.forEach(function(e){e.actions.forEach(function(e){e.done&&a++})}),document.getElementById("totalActions").textContent=a,document.getElementById("bestStreak").textContent=de.bestStreak}(),function(){var a=document.getElementById("actionLog"),i=$e().map(function(e){return e.id});"all"!==Xe&&(i=[Xe]);var r=de.log.filter(function(e){return e.category&&-1!==i.indexOf(e.category)});if(0===r.length)return void(a.innerHTML='<p class="empty-state">Your completed actions will appear here. Start by creating an outcome above!</p>');var s=new Date,c=new Date(s.getFullYear(),s.getMonth(),s.getDate()-6),l=r.filter(function(e){return!!e.date&&new Date(e.date)>=c}).reverse(),d={},u=[];l.forEach(function(e){var t=e.date||"Unknown";d[t]||(d[t]=[],u.push(t)),d[t].push(e)});var m=(new Date).toDateString(),h=new Date(Date.now()-864e5).toDateString(),g="";u.forEach(function(a){var i=a;if(a===m)i="Today";else if(a===h)i="Yesterday";else{var r=new Date(a);isNaN(r.getTime())||(i=r.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}))}var s=0;d[a].forEach(function(e){e.actualMinutes&&(s+=e.actualMinutes)});var c="";s>0&&(c=s>=60?'<span class="log-day-total">'+Math.floor(s/60)+"h "+s%60+"m total</span>":'<span class="log-day-total">'+s+"m total</span>");g+='<div class="log-day-header">'+i+c+"</div>",d[a].forEach(function(a){var i=a.actualMinutes?'<span class="log-actual-time">'+a.actualMinutes+"m</span>":"",r="";if(a.category){var s=e.concat(t).concat(n).concat(o).find(function(e){return e.id===a.category});s&&(r='<span class="log-category" style="background:'+s.color+"22;color:"+s.color+";border-color:"+s.color+'44">'+function(e){if(!e)return"";var t=e.split("\n");return t.length>1?t[0]+'<span class="cat-second-word"> '+t[1]+"</span>":e}(s.name)+"</span>")}var c=de.log.indexOf(a);g+='<div class="log-entry"><span class="log-check">&#10003;</span><span class="log-time">'+a.time+"</span>"+r+'<span class="log-text">'+rn(a.text)+"</span>"+i+'<span class="log-points">+'+a.points+'</span><button class="btn-log-repeat" data-log-idx="'+c+'" title="Do this again">&#128257;</button></div>'})}),a.innerHTML=g,a.querySelectorAll(".btn-log-repeat").forEach(function(e){e.addEventListener("click",function(){var e=parseInt(this.dataset.logIdx),t=de.log[e];t&&function(e,t){var n=de.outcomes.find(function(e){return e.category===t&&!e.completed});if(!n)return void alert("No active outcome in this category. Create one first!");n.actions.push({id:De(),text:e,categories:[t],estMinutes:15,deadline:null,done:!1,completedDate:null}),Ee(),Ve();var o=document.getElementById("praiseBanner"),a=document.getElementById("praiseText");o&&a&&(a.textContent="üîÅ Action duplicated! Ready to crush it again.",o.classList.remove("hidden"),o.classList.add("praise-animate"),setTimeout(function(){o.classList.add("praise-fade-out"),setTimeout(function(){o.classList.add("hidden"),o.classList.remove("praise-animate","praise-fade-out")},800)},3e3))}(t.text,t.category)})})}(),function(){var e=(new Date).toDateString(),t=0,n=0,o=de.outcomes.filter(function(e){return et(e)});"all"!==Xe&&(o=o.filter(function(e){return e.category===Xe}));o.forEach(function(o){o.backBurner||o.actions.forEach(function(o){t++,o.done&&o.completedDate===e&&n++})});var a=t>0?Math.round(n/t*100):0;document.getElementById("dailyProgressFill").style.width=a+"%";var i="(all outcomes)";if("all"!==Xe){var r=$e().find(function(e){return e.id===Xe});r&&(i="("+m(r.name)+")")}document.getElementById("dailyProgressText").textContent=n+" of "+t+" actions completed today "+i}(),function(){document.querySelector(".wheel-of-life-card");var e,t=document.getElementById("wheelProLock");t&&t.remove();e="business"===Ze?It():"health"===Ze?St():"finances"===Ze?Dt():xt();(function(e){var t=document.getElementById("wheelChart"),n="business"===Ze?500:460,o="business"===Ze?250:230;t.setAttribute("viewBox","0 0 "+n+" 460");for(var a=o,i=230,r=160,s=e.length,c="business"===Ze?"#e74c3c":"health"===Ze?"#00b8d4":"finances"===Ze?"#e67e22":"#6c5ce7",l="",d=1;d<=5;d++){l+='<circle cx="'+a+'" cy="'+i+'" r="'+d/5*r+'" fill="none" stroke="rgba(148,163,184,0.25)" stroke-width="1.5"/>'}e.forEach(function(e,t){var n=2*Math.PI*t/s-Math.PI/2,o=a+r*Math.cos(n),c=i+r*Math.sin(n);l+='<line x1="'+a+'" y1="'+i+'" x2="'+o+'" y2="'+c+'" stroke="rgba(148,163,184,0.2)" stroke-width="1"/>';var d=35,u=a+(r+d)*Math.cos(n),m=i+(r+d)*Math.sin(n),h="middle";u<a-10?h="end":u>a+10&&(h="start");var g=e.name.split("\n");l+='<text x="'+u+'" y="'+m+'" text-anchor="'+h+'" fill="'+e.color+'" font-size="12" font-weight="600">',g.length>1?(l+='<tspan x="'+u+'" dy="-7">'+g[0]+"</tspan>",l+='<tspan x="'+u+'" dy="14">'+g[1]+"</tspan>"):l+='<tspan dominant-baseline="middle">'+g[0]+"</tspan>",l+="</text>"});var u=e.map(function(e,t){var n=2*Math.PI*t/s-Math.PI/2,o=e.score/10*r;return a+o*Math.cos(n)+","+(i+o*Math.sin(n))}).join(" ");l+='<polygon points="'+u+'" fill="'+("business"===Ze?"rgba(231,76,60,0.2)":"health"===Ze?"rgba(0,184,212,0.2)":"finances"===Ze?"rgba(230,126,34,0.2)":"rgba(108,92,231,0.2)")+'" stroke="'+c+'" stroke-width="2"/>',e.forEach(function(e,t){var n=2*Math.PI*t/s-Math.PI/2,o=e.score/10*r,c=a+o*Math.cos(n),d=i+o*Math.sin(n);l+='<circle cx="'+c+'" cy="'+d+'" r="5" fill="'+e.color+'" stroke="#0a0a0f" stroke-width="2"/>'}),t.innerHTML=l})(e),function(){var e=(new Date).toDateString(),t=9,n=0,o=$e().map(function(e){return e.id});"all"!==Xe&&(o=[Xe]);de.outcomes.concat(de.archived||[]).forEach(function(t){-1!==o.indexOf(t.category)&&t.actions.forEach(function(t){t.done&&t.completedDate===e&&n++})});var a=0;de.log.forEach(function(t){t.date===e&&t.category&&-1!==o.indexOf(t.category)&&a++}),a>n&&(n=a);var i=Math.min(100,Math.round(n/t*100));document.getElementById("balanceCount").textContent=n+" of "+t;var r,s=document.getElementById("balanceBarFill");s.style.width=i+"%",0===n?(r="Complete actions to claim your victories!",s.style.background="linear-gradient(90deg, #f39c12, #e17055)"):i<30?(r="Momentum is building ‚Äî keep pushing!",s.style.background="linear-gradient(90deg, #f39c12, #e17055)"):i<60?(r="You're on a roll ‚Äî don't stop now!",s.style.background="linear-gradient(90deg, #f39c12, #fdcb6e)"):i<100?(r="Almost there ‚Äî finish strong!",s.style.background="linear-gradient(90deg, #00b894, #00d2a0)"):(r="ALL VICTORIES CLAIMED ‚Äî you crushed it!",s.style.background="linear-gradient(90deg, #00d2a0, #6c5ce7)");document.getElementById("balanceMessage").textContent=r}()}(),function(){var e=document.getElementById("focusBadge");if(!e)return;var t=h();t?(e.textContent=t,e.style.display=""):e.style.display="none"}();try{j()}catch(e){}try{H()}catch(e){}try{O()}catch(e){}try{q()}catch(e){}try{P()}catch(e){}try{Ue()}catch(e){}document.getElementById("streakCount").textContent=de.streak,document.getElementById("todayDate").textContent=(new Date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}var Xe="all",Qe="all",Ze="personal";function $e(){return"business"===Ze?t:"health"===Ze?n:"finances"===Ze?o:e}function et(a){var i=e.map(function(e){return e.id}),r=t.map(function(e){return e.id}),s=n.map(function(e){return e.id}),c=o.map(function(e){return e.id});return"business"===Ze?-1!==r.indexOf(a.category):"health"===Ze?-1!==s.indexOf(a.category):"finances"===Ze?-1!==c.indexOf(a.category):-1!==i.indexOf(a.category)}function tt(){document.body.classList.toggle("light-mode");var e=document.body.classList.contains("light-mode");localStorage.setItem("lwp_theme",e?"light":"dark"),nt()}function nt(){var e=document.getElementById("btnTheme");if(e){var t=document.body.classList.contains("light-mode");e.textContent=t?"‚òÄ Dark Mode":"‚òæ Light Mode",e.title=t?"Switch to Dark Mode":"Switch to Light Mode"}}function ot(e){var t=document.getElementById("outcomesTitle");if(t){t.querySelector("#btnCollapseOutcomes");var n=document.getElementById("outcomesSection")&&document.getElementById("outcomesSection").classList.contains("collapsed");t.innerHTML=e+' <button class="btn-collapse-section" id="btnCollapseOutcomes" title="'+(n?"Show outcomes":"Hide/Show outcomes")+'">'+(n?"‚ñ∂":"‚ñº")+"</button>";var o=document.getElementById("btnCollapseOutcomes");o&&o.addEventListener("click",function(){var e=document.getElementById("outcomesSection");if(e){var t=e.classList.toggle("collapsed");this.textContent=t?"‚ñ∂":"‚ñº",this.title=t?"Show outcomes":"Hide outcomes",localStorage.setItem("lwp_outcomes_collapsed",t?"1":"0")}})}}function at(e){try{Ze=e,localStorage.setItem("lwp_current_mode",e),document.getElementById("btnPersonalMode").classList.toggle("active","personal"===e),document.getElementById("btnBusinessMode").classList.toggle("active","business"===e);var t=document.getElementById("btnHealthMode");t&&t.classList.toggle("active","health"===e);var n=document.getElementById("btnFinancesMode");n&&n.classList.toggle("active","finances"===e),document.body.classList.toggle("business-mode","business"===e),document.body.classList.toggle("health-mode","health"===e),document.body.classList.toggle("finances-mode","finances"===e),"business"===e?(document.getElementById("focusTitle").textContent="Business Focus",document.getElementById("wheelTitle").innerHTML='Business Wheel <span class="wheel-period">Last 7 Days</span> <button class="btn-cat-guide" id="btnCatGuide" title="Category Guide">&#8505;</button>',ot("üéØ Business Outcomes")):"health"===e?(document.getElementById("focusTitle").textContent="Health Focus",document.getElementById("wheelTitle").innerHTML='Health Wheel <span class="wheel-period">Last 7 Days</span> <button class="btn-cat-guide" id="btnCatGuide" title="Category Guide">&#8505;</button>',ot("üéØ Health Goals")):"finances"===e?(document.getElementById("focusTitle").textContent="Finances Focus",document.getElementById("wheelTitle").innerHTML='Finances Wheel <span class="wheel-period">Last 7 Days</span> <button class="btn-cat-guide" id="btnCatGuide" title="Category Guide">&#8505;</button>',ot("üéØ Financial Goals")):(document.getElementById("focusTitle").textContent="TODAY'S POWER FOCUS",document.getElementById("wheelTitle").innerHTML='Wheel of Life <span class="wheel-period">Last 7 Days</span>',ot("üéØ Your Outcomes")),lt(),Ve()}catch(e){console.error("Error switching mode:",e)}}function it(e){var t=e.split("\n");return t.length>1?'<span class="btn-line">'+t[0]+'</span><span class="btn-line">'+t[1]+"</span>":e}function rt(){var e=$e(),t=document.querySelector(".category-pills:not(.edit-category-pills)");t&&(t.innerHTML=e.map(function(e,t){return'<button class="pill'+(0===t?" active":"")+'" data-category="'+e.id+'" style="--pill-color:'+e.color+'">'+it(e.name)+"</button>"}).join(""),t.querySelectorAll(".pill").forEach(function(e){e.addEventListener("click",function(){t.querySelectorAll(".pill").forEach(function(e){e.classList.remove("active")}),this.classList.add("active")})}))}function st(){return'<option value="">+ Cat</option>'+$e().map(function(e){return'<option value="'+e.id+'">'+m(e.name)+"</option>"}).join("")}function ct(){var e=st();document.querySelectorAll("#actionsList .action-extra-cat").forEach(function(t){var n=t.value;t.innerHTML=e,n&&(t.value=n)})}function lt(){var e=$e(),t=u(),n=t.length>0?t[0]:"all";Qe=n;var o=document.getElementById("focusCategoryFilter");function a(e){Qe=e,Xe=e,o.querySelectorAll(".focus-cat-btn").forEach(function(t){t.classList.toggle("active",t.dataset.focusCat===e)}),document.getElementById("outcomesFilterTabs").querySelectorAll(".tab").forEach(function(t){t.classList.toggle("active",t.dataset.filter===e)}),Ve()}o.innerHTML='<button class="focus-cat-btn'+("all"===n?" active":"")+'" data-focus-cat="all">All</button>'+e.map(function(e){return'<button class="focus-cat-btn'+(e.id===n?" active":"")+'" data-focus-cat="'+e.id+'">'+it(e.name)+"</button>"}).join(""),o.querySelectorAll(".focus-cat-btn").forEach(function(e){e.addEventListener("click",function(){a(this.dataset.focusCat)})}),Xe=n;var i=document.getElementById("outcomesFilterTabs");i.innerHTML='<button class="tab'+("all"===n?" active":"")+'" data-filter="all">All</button>'+e.map(function(e){return'<button class="tab'+(e.id===n?" active":"")+'" data-filter="'+e.id+'">'+it(e.name)+"</button>"}).join(""),i.querySelectorAll(".tab").forEach(function(e){e.addEventListener("click",function(){a(this.dataset.filter)})})}function dt(){if(Jt)return Jt;var e=[],t=new Date;return de.outcomes.forEach(function(n,o){if(!n.completed&&!n.backBurner&&et(n)&&("all"===Qe||n.category===Qe)){var a=!1;n.actions.forEach(function(i){if(!i.done&&!a){a=!0;var r=wt(i,n),s=i.deadline||n.deadline||null,c=9999;s&&(c=Math.ceil((new Date(s)-t)/864e5)),e.push({text:i.text,outcome:n.result,outcomeId:n.id,actionId:i.id,estMinutes:i.estMinutes||15,category:n.category,leverageScore:r,outcomeIdx:o,daysLeft:c})}})}}),e.sort(function(e,t){return e.daysLeft!==t.daysLeft?e.daysLeft-t.daysLeft:t.leverageScore!==e.leverageScore?t.leverageScore-e.leverageScore:e.outcomeIdx-t.outcomeIdx}),e[0]||null}var ut=null;function mt(a){var i,r;i=a,r=[],de.outcomes.forEach(function(e){e.completed||e.backBurner||et(e)&&e.actions.forEach(function(t){if(!t.done&&(t.estMinutes||15)<=i){var n=wt(t,e);r.push({text:t.text,outcome:e.result,outcomeId:e.id,actionId:t.id,estMinutes:t.estMinutes,category:e.category,leverageScore:n})}})}),r.sort(function(e,t){return t.leverageScore-e.leverageScore}),ut=r[0]||null;var s=document.getElementById("pickResult"),c=document.getElementById("pickResultTask"),l=document.getElementById("pickResultMeta");if(ut){c.textContent=ut.text;var d=e.concat(t).concat(n).concat(o).find(function(e){return e.id===ut.category}),u=d?m(d.name):ut.category,h=ut.estMinutes?ut.estMinutes+" min":"No estimate",g=de.outcomes.find(function(e){return e.id===ut.outcomeId}),f=g?g.purpose:"",p=ft(ut.text,f),y="";p.matched.length>0&&(y='<div class="pick-values-match">Aligns with: '+p.matched.map(function(e){return'<span class="pick-value-tag">'+rn(e)+"</span>"}).join(" ")+"</div>");var v=void 0!==ut.leverageScore?" | Leverage: "+ut.leverageScore+"%":"";l.innerHTML='<span class="pick-category" style="background:'+(d?d.color:"#6c5ce7")+"22;color:"+(d?d.color:"#6c5ce7")+'">'+u+"</span> "+h+" | "+ut.outcome+v+y,s.classList.remove("hidden"),document.getElementById("btnStartPickedTask").style.display=""}else c.textContent="No tasks fit in "+a+" minutes",l.textContent="Try adding time estimates to your actions, or select more time",s.classList.remove("hidden"),document.getElementById("btnStartPickedTask").style.display="none"}function ht(){ut&&(document.getElementById("pickForMeOverlay").classList.add("hidden"),ve={outcomeId:ut.outcomeId,actionId:ut.actionId},Vt())}function gt(){var e=document.querySelectorAll(".value-input");de.values=[],e.forEach(function(e){var t=e.value.trim();t&&de.values.push(t)}),Ee(),document.getElementById("valuesOverlay").classList.add("hidden")}function ft(e,t){if(!de.values||0===de.values.length)return{score:0,matched:[]};var n=(e+" "+(t||"")).toLowerCase(),o=[];return de.values.forEach(function(e){var t=e.toLowerCase();-1!==n.indexOf(t)&&o.push(e)}),{score:o.length,matched:o}}function pt(e,t){var n=$e(),o=document.getElementById(e);o&&(t=t||[],o.innerHTML=n.map(function(e){var n=-1!==t.indexOf(e.id)?" checked":"",o=e.emoji?e.emoji+" ":"";return'<label class="cat-checkbox-label" style="--cat-color:'+e.color+'"><input type="checkbox" class="cat-checkbox" value="'+e.id+'"'+n+'><span class="cat-checkbox-text">'+o+m(e.name)+"</span></label>"}).join(""))}function yt(e){var t=document.getElementById(e);if(!t)return[];var n=[];return t.querySelectorAll(".cat-checkbox:checked").forEach(function(e){n.push(e.value)}),n}var vt=null,bt=0;function wt(e,t){var n=function(){var e=Date.now();return vt&&e-bt<1e4||(vt=xt(),bt=e),vt}(),o=e.categories&&e.categories.length>0?e.categories:[t.category],a=.5,i=e.deadline||t.deadline||null;if(i){var r=new Date,s=new Date(i),c=Math.ceil((s-r)/864e5);a=c<=0?1:c<=1?.95:c<=3?.85:c<=7?.7:c<=14?.5:.3}var l=0;o.forEach(function(e){var t=5;n.forEach(function(n){n.id===e&&(t=n.score)}),l+=(10-t)/10});var d,m=l/o.length,h=$e().length||8,g=Math.min(o.length/h*2.5,1),f=ft(e.text,t.purpose),p=de.values&&de.values.length>0?de.values.length:1,y=Math.min(f.score/p,1),v=e.estMinutes||30;d=v<=15?1:v<=30?.8:v<=60?.6:v<=120?.4:.2;var b=u(),w=0;o.forEach(function(e){-1!==b.indexOf(e)&&(w=1)});var k=Math.round(100*(.25*a+.25*m+.2*g+.1*y+.1*d+.1*w));return Math.max(0,Math.min(100,k))}function kt(){var e=dt(),t=document.getElementById("nextActionText"),n=document.getElementById("nextActionMeta"),o=document.getElementById("btnCompleteNext"),a=document.getElementById("btnStartPomodoro"),i=document.getElementById("btnStartTaskTimer"),r=document.getElementById("nextActionOutcomeProgress");if(e){t.textContent=e.text;var s=["Outcome: "+e.outcome];e.estMinutes&&s.push("~"+e.estMinutes+" min est."),void 0!==e.leverageScore&&s.push("Leverage: "+e.leverageScore+"%"),n.textContent=s.join(" | "),o.style.display="",a&&(a.style.display=""),i&&(i.style.display=pe?"none":""),(m=document.getElementById("btnPickForMe"))&&(m.style.display=""),(h=document.getElementById("btnCreateOutcomeNext"))&&(h.style.display="none"),o.dataset.outcomeId=e.outcomeId,o.dataset.actionId=e.actionId;var c=de.outcomes.find(function(t){return t.id===e.outcomeId});if(c&&r){var l=c.actions.filter(function(e){return e.done}).length,d=c.actions.length,u=d>0?Math.round(l/d*100):0;r.innerHTML='<span class="na-progress-text">'+l+" of "+d+' actions done</span><div class="na-progress-bar"><div class="na-progress-fill" style="width:'+u+'%"></div></div>'}}else{var m,h;t.textContent="All actions complete! Time to set a new goal.",n.textContent="",o.style.display="none",a&&(a.style.display="none"),i&&(i.style.display="none"),r&&(r.innerHTML=""),(m=document.getElementById("btnPickForMe"))&&(m.style.display="none"),(h=document.getElementById("btnCreateOutcomeNext"))&&(h.style.display="inline-flex"),pe&&Qt()}}function xt(){var e=new Date,t=new Date(e.getTime()-6048e5),n=$e(),o={};return n.forEach(function(e){o[e.id]=0}),de.outcomes.forEach(function(e){var n=e.category;o.hasOwnProperty(n)&&e.actions.forEach(function(e){if(e.done&&e.completedDate&&!(new Date(e.completedDate)<t)){var a=e.categories&&e.categories.length>0?e.categories:[n];o[n]+=1,a.forEach(function(e){e!==n&&o.hasOwnProperty(e)&&(o[e]+=1)})}})}),n.map(function(e){var t=o[e.id],n=0===t?1:Math.min(10,1+t),a=e.emoji||"";return{id:e.id,name:e.name,color:e.color,emoji:a,score:n,rawPoints:t}})}function Et(){!function(e){var t=document.getElementById("businessWheelChart");t.setAttribute("viewBox","0 0 500 460");for(var n=250,o=230,a=160,i=e.length,r="",s=1;s<=5;s++)r+='<circle cx="'+n+'" cy="'+o+'" r="'+s/5*a+'" fill="none" stroke="rgba(148,163,184,0.25)" stroke-width="1.5"/>';e.forEach(function(e,t){var s=2*Math.PI*t/i-Math.PI/2,c=n+a*Math.cos(s),l=o+a*Math.sin(s);r+='<line x1="'+n+'" y1="'+o+'" x2="'+c+'" y2="'+l+'" stroke="rgba(148,163,184,0.2)" stroke-width="1"/>';var d=n+(a+35)*Math.cos(s),u=o+(a+35)*Math.sin(s),m="middle";d<n-10?m="end":d>n+10&&(m="start");var h=e.name.split("\n");r+='<text x="'+d+'" y="'+u+'" text-anchor="'+m+'" fill="'+e.color+'" font-size="12" font-weight="600">',h.length>1?(r+='<tspan x="'+d+'" dy="-7">'+h[0]+"</tspan>",r+='<tspan x="'+d+'" dy="14">'+h[1]+"</tspan>"):r+='<tspan dominant-baseline="middle">'+h[0]+"</tspan>",r+="</text>"});var c=e.map(function(e,t){var r=2*Math.PI*t/i-Math.PI/2,s=e.score/10*a;return n+s*Math.cos(r)+","+(o+s*Math.sin(r))}).join(" ");r+='<polygon points="'+c+'" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="2"/>',e.forEach(function(e,t){var s=2*Math.PI*t/i-Math.PI/2,c=e.score/10*a,l=n+c*Math.cos(s),d=o+c*Math.sin(s);r+='<circle cx="'+l+'" cy="'+d+'" r="5" fill="'+e.color+'" stroke="#0a0a0f" stroke-width="2"/>'}),t.innerHTML=r}(It()),document.getElementById("businessPackOverlay").classList.remove("hidden")}function It(){var e=new Date,n=new Date(e.getTime()-6048e5),o={};return t.forEach(function(e){o[e.id]=0}),de.outcomes.forEach(function(e){var t=e.category;o.hasOwnProperty(t)&&e.actions.forEach(function(e){if(e.done&&e.completedDate&&!(new Date(e.completedDate)<n)){var a=e.categories&&e.categories.length>0?e.categories:[t];o[t]+=1,a.forEach(function(e){e!==t&&o.hasOwnProperty(e)&&(o[e]+=1)})}})}),t.map(function(e){var t=o[e.id],n=0===t?1:Math.min(10,1+t);return{id:e.id,name:e.name,color:e.color,emoji:e.emoji,score:n,rawPoints:t}})}function St(){var e=new Date,t=new Date(e.getTime()-6048e5),o={};return n.forEach(function(e){o[e.id]=0}),de.outcomes.forEach(function(e){var n=e.category;o.hasOwnProperty(n)&&e.actions.forEach(function(e){if(e.done&&e.completedDate&&!(new Date(e.completedDate)<t)){var a=e.categories&&e.categories.length>0?e.categories:[n];o[n]+=1,a.forEach(function(e){e!==n&&o.hasOwnProperty(e)&&(o[e]+=1)})}})}),n.map(function(e){var t=o[e.id],n=0===t?1:Math.min(10,1+t);return{id:e.id,name:e.name,color:e.color,emoji:e.emoji,score:n,rawPoints:t}})}function Dt(){var e=new Date,t=new Date(e.getTime()-6048e5),n={};return o.forEach(function(e){n[e.id]=0}),de.outcomes.forEach(function(e){var o=e.category;n.hasOwnProperty(o)&&e.actions.forEach(function(e){if(e.done&&e.completedDate&&!(new Date(e.completedDate)<t)){var a=e.categories&&e.categories.length>0?e.categories:[o];n[o]+=1,a.forEach(function(e){e!==o&&n.hasOwnProperty(e)&&(n[e]+=1)})}})}),o.map(function(e){var t=n[e.id],o=0===t?1:Math.min(10,1+t);return{id:e.id,name:e.name,color:e.color,emoji:e.emoji,score:o,rawPoints:t}})}function Bt(){document.getElementById("businessPackOverlay").classList.add("hidden"),document.getElementById("newOutcomeOverlay").classList.remove("hidden"),function(){var e=document.querySelector(".category-pills:not(.edit-category-pills)");if(!e)return;e.innerHTML=t.map(function(e,t){return'<button class="pill'+(0===t?" active":"")+'" data-category="'+e.id+'" style="--pill-color:'+e.color+'">'+it(e.name)+"</button>"}).join(""),e.querySelectorAll(".pill").forEach(function(t){t.addEventListener("click",function(){e.querySelectorAll(".pill").forEach(function(e){e.classList.remove("active")}),this.classList.add("active")})})}(),ct()}var Tt=null;function Lt(e){Tt=this,this.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",this.dataset.actionId)}function Ct(e){e.preventDefault(),e.dataTransfer.dropEffect="move",this.classList.add("drag-over")}function Mt(){this.classList.remove("drag-over")}function At(e){if(e.preventDefault(),this.classList.remove("drag-over"),Tt!==this){var t=Tt.dataset.outcomeId,n=this.dataset.outcomeId;if(t===n){var o=de.outcomes.find(function(e){return e.id===t});if(o){var a=o.actions.findIndex(function(e){return e.id===Tt.dataset.actionId}),i=o.actions.findIndex(function(e){return e.id===this.dataset.actionId}.bind(this));if(!(a<0||i<0)){var r=o.actions.splice(a,1)[0];o.actions.splice(i,0,r),Ee(),Ve()}}}}}function _t(){this.classList.remove("dragging"),document.querySelectorAll(".drag-over").forEach(function(e){e.classList.remove("drag-over")})}var jt=null,Ht=null;function Ot(e){e.target.closest(".drag-handle")&&(e.preventDefault(),jt=this,(Ht=this.cloneNode(!0)).style.position="fixed",Ht.style.opacity="0.7",Ht.style.pointerEvents="none",Ht.style.zIndex="9999",Ht.style.width=this.offsetWidth+"px",document.body.appendChild(Ht),this.classList.add("dragging"))}function qt(e){if(jt){e.preventDefault();var t=e.touches[0];Ht.style.left=t.clientX+"px",Ht.style.top=t.clientY+"px"}}function Pt(e){if(jt){Ht&&Ht.parentNode&&Ht.parentNode.removeChild(Ht);var t=e.changedTouches[0],n=document.elementFromPoint(t.clientX,t.clientY);if(n){var o=n.closest("li.draggable");if(o&&o!==jt&&o.dataset.outcomeId===jt.dataset.outcomeId){var a=de.outcomes.find(function(e){return e.id===o.dataset.outcomeId});if(a){var i=a.actions.findIndex(function(e){return e.id===jt.dataset.actionId}),r=a.actions.findIndex(function(e){return e.id===o.dataset.actionId});if(i>=0&&r>=0){var s=a.actions.splice(i,1)[0];a.actions.splice(r,0,s),Ee(),Ve()}}}}jt.classList.remove("dragging"),jt=null,Ht=null}}var Yt={active:!1,srcCard:null,srcId:null,ghost:null,startX:0,startY:0,origTop:0,origLeft:0};function Rt(e,t){e.preventDefault();var n=t.closest(".outcome-card");if(n&&n.dataset.outcomeId){var o=e.touches?e.touches[0]:e,a=n.getBoundingClientRect();Yt.active=!0,Yt.srcCard=n,Yt.srcId=n.dataset.outcomeId,Yt.startX=o.clientX,Yt.startY=o.clientY,Yt.origTop=a.top,Yt.origLeft=a.left,Yt.ghost=n.cloneNode(!0),Yt.ghost.style.cssText="position:fixed;left:"+a.left+"px;top:"+a.top+"px;width:"+a.width+"px;opacity:0.75;pointer-events:none;z-index:9999;transition:none;max-height:130px;overflow:hidden;border:2px solid #f39c12;border-radius:12px;background:#1a1a2e;box-shadow:0 8px 32px rgba(243,156,18,0.3);",document.body.appendChild(Yt.ghost),n.classList.add("outcome-dragging"),document.addEventListener("mousemove",Nt),document.addEventListener("mouseup",Ft),document.addEventListener("touchmove",Nt,{passive:!1}),document.addEventListener("touchend",Ft)}}function Nt(e){if(Yt.active){e.cancelable&&e.preventDefault();var t=e.touches?e.touches[0]:e;Yt.ghost.style.left=Yt.origLeft+t.clientX-Yt.startX+"px",Yt.ghost.style.top=Yt.origTop+t.clientY-Yt.startY+"px",document.querySelectorAll(".outcome-card.outcome-drag-over").forEach(function(e){e.classList.remove("outcome-drag-over")});var n=document.elementFromPoint(t.clientX,t.clientY);if(n){var o=n.closest(".outcome-card");o&&o!==Yt.srcCard&&o.dataset.outcomeId&&o.classList.add("outcome-drag-over")}}}function Ft(e){if(Yt.active){document.removeEventListener("mousemove",Nt),document.removeEventListener("mouseup",Ft),document.removeEventListener("touchmove",Nt),document.removeEventListener("touchend",Ft),Yt.ghost&&Yt.ghost.parentNode&&Yt.ghost.parentNode.removeChild(Yt.ghost),Yt.srcCard&&Yt.srcCard.classList.remove("outcome-dragging");var t=e.changedTouches?e.changedTouches[0]:e,n=document.elementFromPoint(t.clientX,t.clientY);if(n){var o=n.closest(".outcome-card");if(o&&o!==Yt.srcCard&&o.dataset.outcomeId){var a=de.outcomes.findIndex(function(e){return e.id===Yt.srcId}),i=de.outcomes.findIndex(function(e){return e.id===o.dataset.outcomeId});if(a>=0&&i>=0){var r=de.outcomes.splice(a,1)[0];de.outcomes.splice(i,0,r),Ee()}}}document.querySelectorAll(".outcome-card.outcome-drag-over").forEach(function(e){e.classList.remove("outcome-drag-over")}),Yt.active=!1,Yt.srcCard=null,Yt.srcId=null,Yt.ghost=null,Ve()}}function zt(e){return p.slice().sort(function(){return.5-Math.random()}).slice(0,e)}function Wt(){var e=600,t=document.getElementById("extendedBreakTime"),n=document.getElementById("btnStartExtendedBreak");n.textContent="Timer Running...",n.disabled=!0,he=setInterval(function(){e--;var o=Math.floor(e/60),a=e%60;t.textContent=(o<10?"0":"")+o+":"+(a<10?"0":"")+a,e<=0&&(clearInterval(he),he=null,t.textContent="Time's up!",n.textContent="Done! Back to Action",n.disabled=!1,n.onclick=function(){document.getElementById("extendedBreakOverlay").classList.add("hidden")})},1e3)}function Gt(){var e=y[Math.floor(Math.random()*y.length)],t=document.getElementById("praiseBanner");document.getElementById("praiseText").textContent=e,t.classList.remove("hidden"),t.classList.add("praise-animate"),setTimeout(function(){t.classList.add("praise-fade-out"),setTimeout(function(){t.classList.add("hidden"),t.classList.remove("praise-animate","praise-fade-out")},800)},5e3)}function Ut(e,t){var n=de.outcomes.find(function(t){return t.id===e});if(n){var o=n.actions.find(function(e){return e.id===t});if(o&&!o.done){if(o.done=!0,o.completedDate=(new Date).toDateString(),ve.outcomeId===e&&ve.actionId===t){var a=function(){if(fe>0)return Math.ceil(fe/60);return null}();a&&(o.actualMinutes=a),Qt()}else o.accumulatedSeconds&&o.accumulatedSeconds>0&&(o.actualMinutes=Math.ceil(o.accumulatedSeconds/60));delete o.accumulatedSeconds;var i=10+5*(o.categories&&o.categories.length>0?o.categories.length:1);de.totalMomentum+=i;var r={text:o.text,outcome:n.result,category:n.category,time:(new Date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),date:(new Date).toDateString(),points:i};if(o.actualMinutes&&(r.actualMinutes=o.actualMinutes),de.log.push(r),n.actions.every(function(e){return e.done})&&n.actions.length>0&&(n.completed=!0,de.totalMomentum+=100),Te(),Ee(),Ve(),Math.random()<.2){var s=_[Math.floor(Math.random()*_.length)],c=document.getElementById("praiseBanner");document.getElementById("praiseText").textContent=s,c.classList.remove("hidden"),c.classList.add("praise-animate"),setTimeout(function(){c.classList.add("praise-fade-out"),setTimeout(function(){c.classList.add("hidden"),c.classList.remove("praise-animate","praise-fade-out")},800)},5e3)}else Gt();!function(){var e=document.getElementById("nextActionCard");if(e){for(var t=["‚ú®","üåü","üí´","‚≠ê","üéâ","üéä","üöÄ","üíõ","üåà","ü§©"],n=0;n<6;n++){var o=document.createElement("div");o.className="joy-burst-particle",o.textContent=t[Math.floor(Math.random()*t.length)],o.style.left=20+60*Math.random()+"%",o.style.animationDelay=.3*Math.random()+"s",o.style.fontSize=1+1.2*Math.random()+"rem",e.appendChild(o)}setTimeout(function(){for(var t=e.querySelectorAll(".joy-burst-particle"),n=0;n<t.length;n++)t[n].remove()},1200)}}(),F();var l=o.deadline&&new Date(o.deadline)<new Date;try{z(l)}catch(e){console.error("gamification error:",e)}if(U&&!K&&"pro"!==V&&de.log){var d=de.log.length,u=null;25===d?u="25 actions crushed! üí™ Ready to go Pro?":50===d?u="50 actions! üî• Unlock unlimited power with Pro":100===d&&(u="Century Club! üíØ You've earned Pro status"),u&&setTimeout(function(){!function(e){var t=document.getElementById("praiseBanner"),n=document.getElementById("praiseText");t&&n&&(n.innerHTML="<span style=\"cursor:pointer\" onclick=\"document.getElementById('upgradeOverlay').classList.remove('hidden')\">"+e+' &mdash; <strong style="text-decoration:underline">Upgrade ‚Üí</strong></span>',t.classList.remove("hidden"),t.classList.add("praise-animate"),t.style.pointerEvents="auto",setTimeout(function(){t.classList.add("praise-fade-out"),setTimeout(function(){t.classList.add("hidden"),t.classList.remove("praise-animate","praise-fade-out"),t.style.pointerEvents=""},800)},7e3))}(u)},6500)}try{!function(){if(!de||!U||K)return;var e=de.log.length,t=localStorage.getItem("lwp_review_asked_"+e);if(t)return;var n=!1,o="";-1!==vn.indexOf(e)&&(n=!0,o="You've crushed "+e+" actions! üéâ Your feedback helps other ADHD brains find us.");de.streak!==bn||localStorage.getItem("lwp_review_streak7")||(n=!0,o="7 days strong! üî• Your review helps others with ADHD discover us.",localStorage.setItem("lwp_review_streak7","1"));n&&(localStorage.setItem("lwp_review_asked_"+e,"1"),setTimeout(function(){!function(e){var t="https://myhabitmagic.com?ref="+yn(),n=document.createElement("div");n.className="modal-overlay review-modal-overlay",n.innerHTML='<div class="modal review-modal"><button class="modal-close review-close">&times;</button><div class="review-icon">&#11088;</div><h2>You\'re Crushing It!</h2><p class="review-message">'+e+'</p><div class="review-actions"><button class="btn-primary review-btn" id="btnShareReview">&#11088; Share Feedback</button><button class="btn-secondary review-btn" id="btnShareReferral">&#128279; Share With a Friend</button></div><div class="referral-link-box"><p class="referral-label">Your referral link (refer 3 friends = free month):</p><input type="text" class="input-field referral-input" value="'+t+'" readonly id="referralLinkInput"><button class="btn-secondary btn-copy-link" id="btnCopyReferral">Copy Link</button></div><button class="btn-secondary review-skip">Maybe later</button></div>',document.body.appendChild(n),n.querySelector(".review-close").onclick=function(){n.remove()},n.querySelector(".review-skip").onclick=function(){n.remove()},n.querySelector("#btnShareReview").onclick=function(){window.open("mailto:hello@myhabitmagic.com?subject=Habit Magic Feedback&body=What worked:%0A%0AWhat didn't:%0A%0ASuggestions:%0A","_blank")},n.querySelector("#btnShareReferral").onclick=function(){navigator.share?navigator.share({title:"Habit Magic",text:"This productivity app actually works with my ADHD brain. Try it free!",url:t}):(document.getElementById("referralLinkInput").select(),document.execCommand("copy"),alert("Link copied!"))},n.querySelector("#btnCopyReferral").onclick=function(){document.getElementById("referralLinkInput").select(),document.execCommand("copy"),this.textContent="Copied!",setTimeout(function(){document.querySelector(".btn-copy-link").textContent="Copy Link"},2e3)}}(o)},2e3))}()}catch(e){}try{ze()}catch(e){}de.sessionTaskCount++,de.sessionTaskCount>=de.extendedBreakThreshold?(de.sessionTaskCount=0,de.extendedBreakThreshold=Math.floor(2*Math.random())+4,Ee(),setTimeout(function(){var e;e=zt(3),document.getElementById("breakSuggestions").innerHTML='<h3 style="margin-bottom:12px;color:#f39c12">Suggested stretches:</h3>'+e.map(function(e){return'<div class="break-suggestion-item"><span>'+e.emoji+"</span> <strong>"+rn(e.name)+"</strong> ‚Äî "+rn(e.duration)+"</div>"}).join(""),document.getElementById("extendedBreakTime").textContent="10:00",document.getElementById("extendedBreakOverlay").classList.remove("hidden")},1500)):(Ee(),setTimeout(function(){var e,t;e=Math.floor(4*Math.random())+1,t=zt(e),document.getElementById("movementExercises").innerHTML=t.map(function(e,t){var n=e.focus.map(function(e){var t="butt"===e?"#e84393":"arms"===e?"#3498db":"core"===e?"#f39c12":"spine"===e?"#00d2a0":"#6c5ce7";return'<span class="exercise-focus-tag" style="background:'+t+"22;color:"+t+";border:1px solid "+t+'44">'+("arms"===e?"Upper Arms":"butt"===e?"Glutes":"core"===e?"Core":"spine"===e?"Spine/Twist":e)+"</span>"}).join(""),o=e.howTo.split("\n").map(function(e){return'<div class="exercise-step">'+rn(e)+"</div>"}).join("");return'<div class="exercise-card"><div class="exercise-header"><div class="exercise-emoji">'+e.emoji+'</div><div class="exercise-info"><div class="exercise-name">'+rn(e.name)+'</div><div class="exercise-meta"><span class="exercise-equipment">'+rn(e.equipment)+'</span><span class="exercise-duration">'+rn(e.duration)+'</span></div></div></div><div class="exercise-focus-tags">'+n+'</div><div class="exercise-how-to"><div class="exercise-how-title">How to do it:</div>'+o+'</div><label class="exercise-add-checkbox"><input type="checkbox" class="exercise-checkbox" data-exercise-name="'+rn(e.name)+'" data-exercise-duration="'+rn(e.duration)+'"><span>Add to my Health actions</span></label></div>'}).join(""),document.getElementById("movementTitle").innerHTML="&#128170; Movement Break! ("+e+" exercise"+(e>1?"s":"")+")",document.getElementById("movementOverlay").classList.remove("hidden")},1500))}}}function Kt(){me&&(clearInterval(me),me=null);var e=document.getElementById("pomodoroDisplay");e&&e.classList.add("hidden");var t=document.getElementById("btnStartPomodoro");t&&(t.style.display="")}var Jt=null;function Vt(){var e=dt();if(e){ve={outcomeId:e.outcomeId,actionId:e.actionId};var t=de.outcomes.find(function(t){return t.id===e.outcomeId}),n=t?t.actions.find(function(t){return t.id===e.actionId}):null;fe=n&&n.accumulatedSeconds?n.accumulatedSeconds:0,pe=!0,ye=Date.now(),Xt(),document.getElementById("taskTimerDisplay").classList.remove("hidden");var o=document.getElementById("btnStartTaskTimer");o&&(o.style.display="none");var a=document.getElementById("btnStopTaskTimer");a&&(a.style.display=""),ge=setInterval(function(){fe++,Xt();var e=Date.now();e-ye>=6e5&&(en(),ye=e)},1e3)}}function Xt(){var e=Math.floor(fe/3600),t=Math.floor(fe%3600/60),n=fe%60,o="";o=e>0?e+":"+(t<10?"0":"")+t+":"+(n<10?"0":"")+n:(t<10?"0":"")+t+":"+(n<10?"0":"")+n,document.getElementById("taskTimerTime").textContent=o}function Qt(){if(ge&&(clearInterval(ge),ge=null),ve.outcomeId&&ve.actionId&&fe>0){var e=de.outcomes.find(function(e){return e.id===ve.outcomeId});if(e){var t=e.actions.find(function(e){return e.id===ve.actionId});t&&(t.accumulatedSeconds=fe,Ee())}}pe=!1,document.getElementById("taskTimerDisplay").classList.add("hidden");var n=document.getElementById("btnStartTaskTimer");n&&(n.style.display="");var o=document.getElementById("btnStopTaskTimer");o&&(o.style.display="none"),ve={outcomeId:null,actionId:null}}function Zt(){ge&&(clearInterval(ge),ge=null),pe=!1,document.getElementById("btnPauseTaskTimer").style.display="none",document.getElementById("btnResumeTaskTimer").style.display=""}function $t(){pe=!0,ye=Date.now(),document.getElementById("btnPauseTaskTimer").style.display="",document.getElementById("btnResumeTaskTimer").style.display="none",ge=setInterval(function(){fe++,Xt();var e=Date.now();e-ye>=6e5&&(en(),ye=e)},1e3)}function en(){ge&&(clearInterval(ge),ge=null);var e=dt(),t=e?e.text:"current task";document.getElementById("checkInTaskName").textContent=t;var n=Math.floor(fe/60);document.getElementById("checkInElapsedTime").textContent=n+" minute"+(1!==n?"s":""),document.getElementById("taskCheckInOverlay").classList.remove("hidden")}function tn(){document.getElementById("taskCheckInOverlay").classList.add("hidden"),ye=Date.now(),ge=setInterval(function(){fe++,Xt();var e=Date.now();e-ye>=6e5&&(en(),ye=e)},1e3)}function nn(){document.getElementById("taskCheckInOverlay").classList.add("hidden"),Qt()}var on="week";function an(a){on=a;var i,r=new Date;i="week"===a?new Date(r.getTime()-6048e5):"month"===a?new Date(r.getTime()-2592e6):"year"===a?new Date(r.getTime()-31536e6):new Date(0);var s=de.archived.filter(function(e){return!!et(e)&&new Date(e.archivedDate||e.createdDate||0)>=i});s.sort(function(e,t){return new Date(t.archivedDate||0)-new Date(e.archivedDate||0)});var c=s.length,l=0,d=0;s.forEach(function(e){e.actions.forEach(function(e){if(e.done){l++;var t=e.categories&&e.categories.length>0?e.categories.length:1;d+=10+5*t}}),d+=100}),document.getElementById("archiveStats").innerHTML='<div class="archive-stat"><div class="archive-stat-value">'+c+'</div><div class="archive-stat-label">Outcomes</div></div><div class="archive-stat"><div class="archive-stat-value">'+l+'</div><div class="archive-stat-label">Actions Done</div></div><div class="archive-stat"><div class="archive-stat-value">'+d+'</div><div class="archive-stat-label">Points Earned</div></div>';var u=document.getElementById("archiveList");0!==s.length?u.innerHTML=s.map(function(a){var i=a.archivedDate?new Date(a.archivedDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",r=a.actions.map(function(e){return"<li>"+rn(e.text)+"</li>"}).join(""),s="#f39c12",c=e.concat(t).concat(n).concat(o).find(function(e){return e.id===a.category});return c&&(s=c.color),'<div class="archive-outcome" style="border-left-color:'+s+'"><div class="archive-outcome-header"><div class="archive-outcome-result">'+rn(a.result)+'</div><div class="archive-outcome-date">'+i+'</div></div><div class="archive-outcome-purpose">'+rn(a.purpose)+'</div><span class="archive-outcome-category" style="background:'+s+"22;color:"+s+'">'+a.category+'</span><ul class="archive-actions-list">'+r+'</ul><button class="archive-unarchive-btn" data-outcome-id="'+a.id+'">Unarchive</button></div>'}).join(""):u.innerHTML='<p class="empty-state">No archived outcomes in this time period.</p>'}function rn(e){if(!e)return"";var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML}function sn(){var a,i=g(),r=function(){var a=g(),i=e.concat(t).concat(n).concat(o);return a.map(function(e){var t=i.find(function(t){return t.id===e});return t?m(t.name):e}).join(", ")}(),s=((a=new Date).setDate(a.getDate()+1),a.toLocaleDateString("en-US",{weekday:"long"})),c=e.concat(t).concat(n).concat(o);document.getElementById("seedTomorrowTitle").innerHTML="&#127775; Tomorrow's Focus: "+r+" ("+s+")",document.getElementById("seedTomorrowHint").textContent="Here's what's lined up for "+r+" tomorrow:";var l=document.getElementById("seedTomorrowPreview"),d="",u=!1;de&&de.outcomes&&de.outcomes.forEach(function(e){if(!e.completed&&et(e)){var t=-1!==i.indexOf(e.category),n=!1;if(e.actions.forEach(function(e){e.categories&&e.categories.length>0&&e.categories.forEach(function(e){-1!==i.indexOf(e)&&(n=!0)})}),t||n){var o=e.actions.filter(function(e){return!e.done});if(0!==o.length){u=!0;var a=c.find(function(t){return t.id===e.category}),r=a?a.color:"#6c5ce7";d+='<div class="seed-outcome">',d+='<div class="seed-outcome-title" style="border-left: 3px solid '+r+'">'+rn(e.result)+"</div>",d+='<ul class="seed-action-list">',o.forEach(function(e){var t=e.estMinutes?' <span class="seed-est">'+e.estMinutes+" min</span>":"";d+="<li>"+rn(e.text)+t+"</li>"}),d+="</ul></div>"}}}}),u||(d='<div class="seed-empty">No pending actions for '+r+" yet. Create an outcome in that category to plant your seed!</div>"),l.innerHTML=d}function cn(){var e="lwp_evening_seed_"+(new Date).toDateString();localStorage.getItem(e)||(sn(),document.getElementById("eveningSeedOverlay").classList.remove("hidden"))}function ln(){var e="lwp_wind_down_"+(new Date).toDateString();localStorage.getItem(e)||document.getElementById("windDownOverlay").classList.remove("hidden")}var dn=null;function un(){de||function(){var e=localStorage.getItem(le);if(e||localStorage.getItem("lwp_migration_done")||(e=localStorage.getItem("life_with_purpose_data")||localStorage.getItem(se))&&U&&(localStorage.removeItem("life_with_purpose_data"),localStorage.setItem("lwp_migration_done","1")),e){try{de=JSON.parse(e)}catch(e){return de=be(),de}return ke()}de=be()}();var i,r=localStorage.getItem("lwp_current_mode");r&&r!==Ze&&at(r);try{if(de&&de.outcomes&&0===de.outcomes.length&&(!de.log||0===de.log.length)){var s=(new Date).toDateString();de.outcomes.push({id:De(),result:"Clean Room - Clean Mind",purpose:"A clean space helps me focus, reduces stress, and sets the tone for a productive day",actions:[{id:De(),text:"Clean Desk",done:!1,timeEstimate:15,leverage:80,categories:["fun_environment"]},{id:De(),text:"Dust Desk & Computer",done:!1,timeEstimate:10,leverage:60,categories:["fun_environment"]},{id:De(),text:"Watch How To Use My Habit Magic",done:!1,timeEstimate:10,leverage:90,categories:["personal_growth"]}],category:"fun_environment",deadline:null,commitment:8,completed:!1,createdDate:s}),de.outcomes.push({id:De(),result:"Launch My First Business Task",purpose:"Taking the first step builds momentum and proves to myself I can make progress every day",actions:[{id:De(),text:"Write down my top 3 business priorities",done:!1,timeEstimate:10,leverage:90,categories:["leadership_vision"]},{id:De(),text:"Organize my workspace for focus",done:!1,timeEstimate:15,leverage:70,categories:["operations_systems"]},{id:De(),text:"Set one measurable goal for this week",done:!1,timeEstimate:10,leverage:85,categories:["leadership_vision"]}],category:"leadership_vision",deadline:null,commitment:8,completed:!1,createdDate:s}),de.outcomes.push({id:De(),result:"Start My Health Journey Today",purpose:"My body is the foundation of everything ‚Äî when I feel good physically, everything else improves",actions:[{id:De(),text:"Drink a full glass of water right now",done:!1,timeEstimate:5,leverage:80,categories:["nutrition_fuel"]},{id:De(),text:"Take a 10-minute walk outside",done:!1,timeEstimate:10,leverage:85,categories:["exercise_movement"]},{id:De(),text:"Write down what I ate today",done:!1,timeEstimate:5,leverage:70,categories:["nutrition_fuel"]}],category:"nutrition_fuel",deadline:null,commitment:8,completed:!1,createdDate:s}),de.outcomes.push({id:De(),result:"Take Control of My Finances",purpose:"Financial clarity removes anxiety and empowers me to build the life I want",actions:[{id:De(),text:"List all monthly subscriptions",done:!1,timeEstimate:15,leverage:85,categories:["budget"]},{id:De(),text:"Check my bank balance right now",done:!1,timeEstimate:5,leverage:80,categories:["budget"]},{id:De(),text:"Set one savings goal for this month",done:!1,timeEstimate:10,leverage:90,categories:["investments"]}],category:"budget",deadline:null,commitment:8,completed:!1,createdDate:s}),Ee()}}catch(e){console.error("default outcome error:",e)}try{lt()}catch(e){console.error("category filter error:",e)}try{!function(){try{var e="lwp_combo_"+(new Date).toDateString(),t=JSON.parse(localStorage.getItem(e)||"{}");t.count&&t.lastTime&&Date.now()-t.lastTime<=x&&(w=t.count,k=t.lastTime)}catch(e){}}()}catch(e){console.error("combo restore error:",e)}try{Ve()}catch(e){console.error("render error:",e)}try{Je()}catch(e){console.error("quote error:",e)}try{(i=document.getElementById("outcomesGrid")).addEventListener("mousedown",function(e){var t=e.target.closest(".outcome-drag-handle");t&&Rt(e,t)}),i.addEventListener("touchstart",function(e){var t=e.target.closest(".outcome-drag-handle");t&&Rt(e,t)},{passive:!1})}catch(e){console.error("outcome dnd error:",e)}try{!function(){if(de&&de.lastActiveDate){var e=(new Date).toDateString();if(de.lastActiveDate!==e){var t=Le(de.lastActiveDate,e);if(!(t<2)){var n="lwp_reentry_shown_"+e;if(!localStorage.getItem(n)){localStorage.setItem(n,"1");var o=document.getElementById("welcomeBackOverlay"),a=document.getElementById("welcomeBackTitle"),i=document.getElementById("welcomeBackMsg"),r=document.getElementById("welcomeBackStreakInfo");if(o&&a&&i){t<=3?(a.textContent="Welcome Back! üå±",i.textContent="You were away for "+t+" days. No judgment ‚Äî you're here now, and that's what matters."):t<=7?(a.textContent="Hey, You're Back! üåª",i.textContent="It's been "+t+" days. Life happens. The fact that you opened this app shows real strength."):t<=30?(a.textContent="Look Who's Here! üåü",i.textContent=t+" days away? That takes courage to come back. Most people don't. You just did."):(a.textContent="Welcome Home! üè†",i.textContent="It's been a while, but fresh starts are powerful. Every expert was once a beginner again."),Be();var s="";de.streak>0&&de.streakFreezes>0&&t<=2?(s='<div style="font-size:1.2rem;font-weight:600">üßä Your streak was saved by a Streak Freeze!</div>',s+='<div style="margin-top:4px">Current streak: <strong>'+de.streak+" days</strong> üî•</div>",s+='<div style="font-size:0.85rem;margin-top:4px">Freezes remaining: '+de.streakFreezes+"</div>"):de.streak>0?(s='<div style="font-size:0.9rem">Your previous streak: <strong>'+de.streak+" days</strong></div>",s+='<div style="margin-top:4px;font-weight:600;color:var(--accent-green)">Let\'s start a new one today! üí™</div>'):s='<div style="font-weight:600;color:var(--accent-green)">Today is Day 1. Let\'s go! üöÄ</div>',de.streakFreezes>0&&(s+='<div style="font-size:0.8rem;margin-top:8px;opacity:0.7">üßä You have '+de.streakFreezes+" Streak Freeze(s) to protect future streaks</div>"),r&&(r.innerHTML=s),o.classList.remove("hidden")}}}}}}()}catch(e){console.error("reentry check error:",e)}try{Ue()}catch(e){console.error("streak freeze render error:",e)}try{Ge()}catch(e){console.error("big task nudge init error:",e)}if(wn("btnCollapseOutcomes","click",function(){var e=document.getElementById("outcomesSection");if(e){var t=e.classList.toggle("collapsed");this.textContent=t?"‚ñ∂":"‚ñº",this.title=t?"Show outcomes":"Hide outcomes",localStorage.setItem("lwp_outcomes_collapsed",t?"1":"0")}}),"1"===localStorage.getItem("lwp_outcomes_collapsed")){var c=document.getElementById("outcomesSection"),l=document.getElementById("btnCollapseOutcomes");c&&c.classList.add("collapsed"),l&&(l.textContent="‚ñ∂",l.title="Show outcomes")}document.querySelectorAll(".btn-collapse-section[data-collapse]").forEach(function(e){var t=e.dataset.collapse;if(e.addEventListener("click",function(e){e.stopPropagation();var n=document.getElementById(t);if(n){var o=n.classList.toggle("collapsed");this.textContent=o?"‚ñ∂":"‚ñº",this.title=o?"Show":"Hide",localStorage.setItem("lwp_"+t+"_collapsed",o?"1":"0")}}),"1"===localStorage.getItem("lwp_"+t+"_collapsed")){var n=document.getElementById(t);n&&n.classList.add("collapsed"),e.textContent="‚ñ∂",e.title="Show"}}),wn("btnFocusMode","click",function(){var e=document.body.classList.toggle("focus-mode");this.textContent=e?"‚úñ":"‚õ∂",this.title=e?"Exit Focus Mode":"Focus Mode ‚Äî hide everything else"}),wn("btnNewOutcome","click",function(){var e=document.getElementById("outcomesSection");if(e&&e.classList.contains("collapsed")){e.classList.remove("collapsed");var t=document.getElementById("btnCollapseOutcomes");t&&(t.textContent="‚ñº",t.title="Hide outcomes"),localStorage.setItem("lwp_outcomes_collapsed","0")}}),wn("btnExportLog","click",function(){try{!function(){if(de&&de.log&&0!==de.log.length){var e=new Date;e.setDate(e.getDate()-30);var t=de.log.filter(function(t){return new Date(t.date)>=e});0===t.length&&(t=de.log);var n="Date,Time,Action,Outcome,Category,Points,Minutes\n";t.forEach(function(e){var t=['"'+(e.date||"")+'"','"'+(e.time||"")+'"','"'+(e.text||"").replace(/"/g,'""')+'"','"'+(e.outcome||"").replace(/"/g,'""')+'"','"'+(e.category||"")+'"',e.points||0,e.actualMinutes||""];n+=t.join(",")+"\n"});var o=new Blob([n],{type:"text/csv"}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download="habit-magic-log-"+(new Date).toISOString().split("T")[0]+".csv",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}else alert("No actions to export yet!")}()}catch(e){console.error("export error:",e)}});var d=document.getElementById("feedbackRating"),u=document.getElementById("feedbackRatingValue");d&&u&&d.addEventListener("input",function(){u.textContent=this.value;var e=document.getElementById("feedbackTestimonialSection");e&&(parseInt(this.value)>=8?e.classList.remove("hidden"):e.classList.add("hidden"))}),wn("btnSubmitFeedback","click",function(){try{!function(){var e=(document.getElementById("feedbackWorked")||{}).value||"",t=(document.getElementById("feedbackBroken")||{}).value||"",n=(document.getElementById("feedbackWish")||{}).value||"",o=parseInt((document.getElementById("feedbackRating")||{}).value)||7,a=(document.getElementById("feedbackTestimonial")||{}).value||"",i=(document.getElementById("feedbackDisplayName")||{}).value||"";if(e||t||n){var r={uid:U?U.uid:"anonymous",email:U?U.email:"",date:(new Date).toISOString(),worked:e,broken:t,wish:n,rating:o,streak:de.streak||0,totalActions:de.log?de.log.length:0,mode:Ze};if(a&&o>=8&&(r.testimonial=a,r.displayName=i||"Anonymous"),firebaseReady)try{db.collection("feedback").add(r).then(function(){console.log("Feedback saved to Firestore")}).catch(function(e){console.error("Feedback save error:",e)}),r.testimonial&&db.collection("testimonials").add({text:r.testimonial,displayName:r.displayName,rating:o,date:(new Date).toISOString(),uid:U.uid}).catch(function(e){console.error("Testimonial save error:",e)})}catch(e){console.error("Feedback Firestore error:",e)}de.feedbackHistory||(de.feedbackHistory=[]),de.feedbackHistory.push(r),Ee(),localStorage.setItem("lwp_feedback_"+(new Date).toDateString(),"submitted"),document.getElementById("feedbackOverlay").classList.add("hidden");var s=document.getElementById("challengeToast"),c=document.getElementById("challengeToastText");s&&c&&(c.textContent="‚ù§Ô∏è Thank you for your feedback! You're helping shape Habit Magic.",s.classList.remove("hidden"),setTimeout(function(){s.classList.add("hidden")},5e3))}else alert("Please fill in at least one feedback field!")}()}catch(e){console.error("feedback submit error:",e)}});try{var m=Date.now(),h=(new Date).getHours();if(h>=5&&h<18){var g="lwp_priming_times_"+(new Date).toDateString(),f=JSON.parse(localStorage.getItem(g)||"[]"),p=(m-(f.length>0?f[f.length-1]:0))/36e5;f.length<3&&p>=3&&document.getElementById("statePrimingOverlay").classList.remove("hidden")}}catch(e){console.error("priming auto-show error:",e)}document.querySelectorAll(".focus-cat-btn").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".focus-cat-btn").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),Qe=this.dataset.focusCat,kt()})}),wn("btnRefreshQuote","click",function(){try{Je()}catch(e){console.error("quote refresh error:",e)}}),document.addEventListener("click",function(i){if(i.target&&("btnCatGuide"===i.target.id||i.target.closest("#btnCatGuide")))try{!function(){var i="business"===Ze?t:"health"===Ze?n:"finances"===Ze?o:e,r="business"===Ze?"&#128188; Business Category Guide":"health"===Ze?"&#127973; Health Category Guide":"finances"===Ze?"&#128176; Finances Category Guide":"&#127793; Life Category Guide",s="business"===Ze?"Each category covers these areas of your business:":"health"===Ze?"Each category covers these areas of your health:":"finances"===Ze?"Each category covers these areas of your finances:":"Each category covers these areas of your life:",c=document.getElementById("catGuideTitle");c&&(c.innerHTML=r);var l=document.getElementById("catGuideSubtitle");l&&(l.textContent=s);var d=document.getElementById("catGuideContent");if(d){var u="";i.forEach(function(e){var t=a[e.id]||"",n=e.name.replace("\n"," & ");u+='<div class="cat-guide-item" style="border-left: 4px solid '+e.color+'">',u+='<div class="cat-guide-name" style="color: '+e.color+'">'+n+"</div>",u+='<div class="cat-guide-desc">'+t+"</div>",u+="</div>"}),u+='<div class="cat-guide-free-day">',u+='<div class="cat-guide-name" style="color: var(--accent-yellow)">&#127775; Saturday &mdash; Weakest Area</div>',u+='<div class="cat-guide-desc">Every Saturday, the app automatically focuses on your <strong>weakest wheel area</strong> &mdash; the category with the lowest score over the past 7 days. This ensures nothing falls behind!</div>',u+="</div>",d.innerHTML=u,document.getElementById("catGuideOverlay").classList.remove("hidden")}}()}catch(e){console.error("cat guide error:",e)}}),wn("btnNewOutcome","click",function(){rt(),ct(),document.getElementById("newOutcomeOverlay").classList.remove("hidden")}),wn("btnNewOutcome2","click",function(){rt(),ct(),document.getElementById("newOutcomeOverlay").classList.remove("hidden")});var y=document.getElementById("btnCreateOutcomeNext");y&&y.addEventListener("click",function(){rt(),ct(),document.getElementById("newOutcomeOverlay").classList.remove("hidden")}),wn("closeNewOutcome","click",function(){document.getElementById("newOutcomeOverlay").classList.add("hidden")}),wn("addMoreActions","click",function(){var e=document.createElement("div");e.className="action-input-row",e.innerHTML='<input type="text" class="input-field" placeholder="Action step..."><select class="est-select est-input" title="Estimated minutes"><option value="5">5m</option><option value="10">10m</option><option value="15" selected>15m</option><option value="20">20m</option></select><input type="date" class="action-deadline-input" title="Deadline"><select class="est-select action-extra-cat" title="Extra category">'+st()+"</select>",document.getElementById("actionsList").appendChild(e)}),document.querySelectorAll(".category-pills:not(.edit-category-pills) .pill").forEach(function(e){e.addEventListener("click",function(){this.parentElement.querySelectorAll(".pill").forEach(function(e){e.classList.remove("active")}),this.classList.add("active")})}),document.querySelectorAll(".edit-category-pills .pill").forEach(function(e){e.addEventListener("click",function(){this.parentElement.querySelectorAll(".pill").forEach(function(e){e.classList.remove("active")}),this.classList.add("active")})}),wn("saveOutcome","click",function(){var e=document.getElementById("outcomeResult").value.trim(),t=document.getElementById("outcomePurpose").value.trim();if(e&&t){de&&de.outcomes&&de.outcomes.length,0;var n=[],o=!1;if(document.querySelectorAll("#actionsList .action-input-row").forEach(function(e){var t=e.querySelector('input[type="text"]').value.trim();if(t){var a=parseInt(e.querySelector(".est-input").value);!a||a<1?(o=!0,e.querySelector(".est-input").classList.add("input-error")):e.querySelector(".est-input").classList.remove("input-error");var i=e.querySelector(".action-extra-cat"),r=i?i.value:"",s=e.querySelector(".action-deadline-input"),c=s&&s.value?s.value:null;if(!c){var l=new Date;l.setDate(l.getDate()+7),c=l.toISOString().split("T")[0]}n.push({id:De(),text:t,categories:[],extraCategory:r,estMinutes:a||15,deadline:c,done:!1,completedDate:null})}}),0!==n.length&&!o){var a=document.querySelector(".category-pills:not(.edit-category-pills) .pill.active"),i=a?a.dataset.category:"health_energy";if(de.outcomes.filter(function(e){return e.category===i&&!e.completed}).length>=3){var r=i.replace(/_/g," ");if(!confirm("You already have 3 active outcomes in "+r+". Focus beats volume ‚Äî want to finish one first?\n\nPress OK to add anyway, or Cancel to go back."))return}n.forEach(function(e){var t=[i];e.extraCategory&&e.extraCategory!==i&&t.push(e.extraCategory),e.categories=t,delete e.extraCategory}),de.outcomes.push({id:De(),result:e,purpose:t,actions:n,category:i,deadline:document.getElementById("outcomeDeadline").value||null,commitment:parseInt(document.getElementById("commitmentSlider").value),completed:!1,createdDate:(new Date).toDateString()}),Ee(),Ve(),document.getElementById("newOutcomeOverlay").classList.add("hidden"),document.getElementById("outcomeResult").value="",document.getElementById("outcomePurpose").value="",document.getElementById("outcomeDeadline").value="",document.getElementById("commitmentSlider").value="7",document.getElementById("commitmentValue").textContent="7",document.getElementById("commitmentBoost").value="";var s='<select class="est-select est-input" title="Estimated minutes"><option value="5">5m</option><option value="10">10m</option><option value="15" selected>15m</option><option value="20">20m</option></select>',c='<select class="est-select action-extra-cat" title="Extra category">'+st()+"</select>";document.getElementById("actionsList").innerHTML='<div class="action-input-row"><input type="text" class="input-field" placeholder="Action step 1...">'+s+'<input type="date" class="action-deadline-input" title="Deadline">'+c+'</div><div class="action-input-row"><input type="text" class="input-field" placeholder="Action step 2...">'+s+'<input type="date" class="action-deadline-input" title="Deadline">'+c+'</div><div class="action-input-row"><input type="text" class="input-field" placeholder="Action step 3...">'+s+'<input type="date" class="action-deadline-input" title="Deadline">'+c+"</div>"}}}),wn("commitmentSlider","input",function(){document.getElementById("commitmentValue").textContent=this.value}),wn("editCommitmentSlider","input",function(){document.getElementById("editCommitmentValue").textContent=this.value}),wn("btnCompleteNext","click",function(){var e=this.dataset.outcomeId,t=this.dataset.actionId;e&&t&&Ut(e,t)}),wn("outcomesGrid","change",function(e){if(e.target.classList.contains("action-checkbox")){var t=e.target.dataset.outcomeId,n=e.target.dataset.actionId;e.target.checked?Ut(t,n):function(e,t){var n=de.outcomes.find(function(t){return t.id===e});if(n){var o=n.actions.find(function(e){return e.id===t});if(o&&o.done){o.done=!1,o.completedDate=null;var a=10+5*(o.categories&&o.categories.length>0?o.categories.length:1);de.totalMomentum=Math.max(0,de.totalMomentum-a);for(var i=de.log.length-1;i>=0;i--)if(de.log[i].text===o.text&&de.log[i].outcome===n.result){de.log.splice(i,1);break}n.completed&&(n.completed=!1,de.totalMomentum=Math.max(0,de.totalMomentum-100)),Ee(),Ve()}}}(t,n)}}),wn("outcomesGrid","click",function(e){var t=e.target.closest(".completed-actions-toggle");if(t){var n=t.nextElementSibling;if(n&&n.classList.contains("completed-actions-group")){n.classList.toggle("hidden");var o=t.querySelector(".toggle-arrow");o&&(o.textContent=n.classList.contains("hidden")?"‚ñ∂":"‚ñº")}}else{var a=e.target.closest(".action-text");a&&function(e,t){try{var n=de.outcomes.find(function(t){return t.id===e});if(!n)return;var o=n.actions.find(function(e){return e.id===t});if(!o)return;v={outcomeId:e,actionId:t},document.getElementById("editActionText").value=o.text,pt("editActionCategories",o.categories||[]),document.getElementById("editActionEst").value=o.estMinutes||15,document.getElementById("editActionDeadline").value=o.deadline||"";for(var a=document.getElementById("editActionOutcome"),i="",r=0;r<de.outcomes.length;r++){var s=de.outcomes[r],c=s.id===e?" selected":"",l=s.result||"Outcome "+(r+1);i+='<option value="'+s.id+'"'+c+">"+rn(l)+"</option>"}a.innerHTML=i,document.getElementById("editActionOverlay").classList.remove("hidden")}catch(e){console.error("openEditAction error:",e)}}(a.dataset.outcomeId,a.dataset.actionId);var i=e.target.closest(".btn-delete-outcome");i&&confirm("Delete this outcome and all its actions?")&&(de.outcomes=de.outcomes.filter(function(e){return e.id!==i.dataset.outcomeId}),Ee(),Ve());var r=e.target.closest(".btn-edit-outcome");r&&function(e){var t=de.outcomes.find(function(t){return t.id===e});if(!t)return;b=e,document.getElementById("editOutcomeResult").value=t.result,document.getElementById("editOutcomePurpose").value=t.purpose,document.getElementById("editOutcomeDeadline").value=t.deadline||"",document.getElementById("editCommitmentSlider").value=t.commitment||7,document.getElementById("editCommitmentValue").textContent=t.commitment||7,function(e){var t=$e(),n=document.querySelector(".edit-category-pills");if(!n)return;n.innerHTML=t.map(function(t){return'<button class="pill'+(t.id===e?" active":"")+'" data-category="'+t.id+'" style="--pill-color:'+t.color+'">'+it(t.name)+"</button>"}).join(""),n.querySelectorAll(".pill").forEach(function(e){e.addEventListener("click",function(){n.querySelectorAll(".pill").forEach(function(e){e.classList.remove("active")}),this.classList.add("active")})})}(t.category),document.getElementById("editOutcomeOverlay").classList.remove("hidden")}(r.dataset.outcomeId);var s=e.target.closest(".btn-add-action-to");s&&function(e){var t=de.outcomes.find(function(t){return t.id===e});if(!t)return;E=e,document.getElementById("addActionOutcomeName").textContent="Adding to: "+t.result,document.getElementById("addActionText").value="",pt("addActionCategories",[]),document.getElementById("addActionEst").value="",document.getElementById("addActionOverlay").classList.remove("hidden")}(s.dataset.outcomeId);var c=e.target.closest(".btn-focus-action");if(c)!function(e,t){var n=de.outcomes.find(function(t){return t.id===e});if(n){var o=n.actions.find(function(e){return e.id===t});if(o&&!o.done){Qe=n.category;var a=document.getElementById("focusCategoryFilter");a&&a.querySelectorAll(".focus-cat-btn").forEach(function(e){e.classList.toggle("active",e.dataset.focusCat===n.category)});var i=wt(o,n);Jt={text:o.text,outcome:n.result,outcomeId:n.id,actionId:o.id,estMinutes:o.estMinutes,category:n.category,leverageScore:i},kt(),ve={outcomeId:e,actionId:t},fe=o.accumulatedSeconds?o.accumulatedSeconds:0,pe=!0,ye=Date.now(),Xt(),document.getElementById("taskTimerDisplay").classList.remove("hidden");var r=document.getElementById("btnStartTaskTimer");r&&(r.style.display="none");var s=document.getElementById("btnStopTaskTimer");s&&(s.style.display=""),ge=setInterval(function(){fe++,Xt();var e=Date.now();e-ye>=6e5&&(en(),ye=e)},1e3),document.getElementById("nextActionCard").scrollIntoView({behavior:"smooth",block:"center"}),Jt=null}}}(c.dataset.outcomeId,c.dataset.actionId);else{var l,d,u=e.target.closest(".btn-back-burner");u&&(l=u.dataset.outcomeId,(d=de.outcomes.find(function(e){return e.id===l}))&&(d.backBurner=!d.backBurner,Ee(),Ve()))}}});var v={outcomeId:null,actionId:null};wn("closeEditAction","click",function(){document.getElementById("editActionOverlay").classList.add("hidden")}),wn("btnSaveEditAction","click",function(){var e=de.outcomes.find(function(e){return e.id===v.outcomeId});if(e){var t=e.actions.find(function(e){return e.id===v.actionId});if(t){t.text=document.getElementById("editActionText").value.trim(),t.categories=yt("editActionCategories"),t.estMinutes=parseInt(document.getElementById("editActionEst").value)||15,t.deadline=document.getElementById("editActionDeadline").value||null;var n=document.getElementById("editActionOutcome").value;if(n&&n!==v.outcomeId){var o=de.outcomes.find(function(e){return e.id===n});o&&(e.actions=e.actions.filter(function(e){return e.id!==v.actionId}),o.actions.push(t),o.completed&&(o.completed=!1))}Ee(),Ve(),document.getElementById("editActionOverlay").classList.add("hidden")}}}),wn("btnDeleteAction","click",function(){if(confirm("Delete this action?")){var e=de.outcomes.find(function(e){return e.id===v.outcomeId});e&&(e.actions=e.actions.filter(function(e){return e.id!==v.actionId}),Ee(),Ve(),document.getElementById("editActionOverlay").classList.add("hidden"))}});var b=null;wn("closeEditOutcome","click",function(){document.getElementById("editOutcomeOverlay").classList.add("hidden")}),wn("btnSaveEditOutcome","click",function(){var e=de.outcomes.find(function(e){return e.id===b});if(e){e.result=document.getElementById("editOutcomeResult").value.trim(),e.purpose=document.getElementById("editOutcomePurpose").value.trim(),e.deadline=document.getElementById("editOutcomeDeadline").value||null,e.commitment=parseInt(document.getElementById("editCommitmentSlider").value);var t=document.querySelector(".edit-category-pills .pill.active");t&&(e.category=t.dataset.category),Ee(),Ve(),document.getElementById("editOutcomeOverlay").classList.add("hidden")}});var E=null;wn("closeAddAction","click",function(){document.getElementById("addActionOverlay").classList.add("hidden")}),wn("btnSaveAddAction","click",function(){var e=document.getElementById("addActionText").value.trim();if(e){var t=parseInt(document.getElementById("addActionEst").value);if(!t||t<1)document.getElementById("addActionEst").classList.add("input-error");else{document.getElementById("addActionEst").classList.remove("input-error");var n=de.outcomes.find(function(e){return e.id===E});if(n){var o=document.getElementById("addActionDeadline").value||null;if(!o){var a=new Date;a.setDate(a.getDate()+7),o=a.toISOString().split("T")[0]}n.actions.push({id:De(),text:e,categories:yt("addActionCategories"),estMinutes:t||15,deadline:o,done:!1,completedDate:null}),n.completed&&(n.completed=!1),Ee(),Ve(),document.getElementById("addActionOverlay").classList.add("hidden")}}}}),wn("btnStartPomodoro","click",function(){(function(){var e=900,t=document.getElementById("pomodoroTime"),n=document.getElementById("pomodoroDisplay");n&&n.classList.remove("hidden");var o=document.getElementById("btnStartPomodoro");o&&(o.style.display="none"),me=setInterval(function(){e--;var o=Math.floor(e/60),a=e%60;if(t.textContent=(o<10?"0":"")+o+":"+(a<10?"0":"")+a,e<=0){clearInterval(me),me=null,t.textContent="Time's up!",n&&n.classList.add("hidden");var i=document.getElementById("btnStartPomodoro");i&&(i.style.display="")}},1e3)})()}),wn("btnStopPomodoro","click",Kt),wn("btnStartTaskTimer","click",function(){Vt()}),wn("btnStopTaskTimer","click",Qt),wn("btnPauseTaskTimer","click",Zt),wn("btnResumeTaskTimer","click",$t),wn("btnCheckInYes","click",tn),wn("btnCheckInNo","click",nn),wn("btnPickForMe","click",function(){document.getElementById("pickResult").classList.add("hidden"),document.getElementById("pickForMeOverlay").classList.remove("hidden")}),wn("closePickForMe","click",function(){document.getElementById("pickForMeOverlay").classList.add("hidden")}),document.querySelectorAll(".time-option-btn").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".time-option-btn").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),document.getElementById("btnStartPickedTask").style.display="",mt(parseInt(this.dataset.minutes))})}),wn("btnStartPickedTask","click",ht),wn("btnMovementDone","click",function(){!function(){var e=document.querySelectorAll(".exercise-checkbox:checked");if(0!==e.length){var t=de.outcomes.find(function(e){return"health_energy"===e.category&&!e.completed});t||(t={id:De(),result:"Stay Active & Healthy",purpose:"Maintain my physical health through regular movement and exercise",actions:[],category:"health_energy",deadline:null,commitment:8,completed:!1,createdDate:(new Date).toDateString()},de.outcomes.push(t)),e.forEach(function(e){var n=e.dataset.exerciseName,o=e.dataset.exerciseDuration,a=De(),i=new Date;t.actions.push({id:a,text:n+" ("+o+")",categories:["health_energy"],estMinutes:5,done:!0,completedDate:i.toDateString()}),de.totalMomentum+=15,de.log.push({text:n+" ("+o+")",outcome:t.result,category:"health_energy",time:i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),date:i.toDateString(),points:15})}),t.actions.length>0&&t.actions.every(function(e){return e.done})&&(t.completed=!0,de.totalMomentum+=100),Ee(),Ve(),F()}}(),document.getElementById("movementOverlay").classList.add("hidden")}),wn("btnMovementSkip","click",function(){document.getElementById("movementOverlay").classList.add("hidden")});var I=null,S=[],D=[],B=[{id:"breathe478",icon:"ü´Å",label:"Breathe 4-7-8",desc:"Calming breath pattern (1 min)",run:function(e){e.innerHTML='<h3>4-7-8 Breathing</h3><p style="color:var(--text-secondary);margin-bottom:12px">Follow the circle. In through nose, hold, out through mouth.</p><div class="stuck-breathe-circle" id="breatheCircle">Breathe In</div><p id="breatheCount" style="color:var(--text-muted);font-size:0.85rem;margin-top:8px">Round 1 of 3</p>';var t=document.getElementById("breatheCircle"),n=document.getElementById("breatheCount"),o=0;!function e(){if(o>=3)return t.textContent="‚ú® Done!",t.className="stuck-breathe-circle",void(n.textContent="Great job! Feel that calm?");o++,n.textContent="Round "+o+" of 3",t.textContent="Breathe In",t.className="stuck-breathe-circle inhale",I=setTimeout(function(){t.textContent="Hold...",t.className="stuck-breathe-circle"},4e3),S.push(setTimeout(function(){t.textContent="Breathe Out",t.className="stuck-breathe-circle exhale"},11e3)),S.push(setTimeout(function(){e()},19e3))}()}},{id:"dance",icon:"‚ú®",label:"Joy Break",desc:"Dance, move, feel alive ‚Äî Brain Like A Pinball!",run:function(e){e.innerHTML='<h3 class="joy-title-pulse">‚ú® DANCE ‚ú®</h3><div class="stuck-dance-area" id="danceEmoji">üíÉ</div><div id="dancePrompt" class="dance-prompt dance-prompt-flash">DANCE!</div><p id="danceTimer" style="font-size:1.5rem;font-weight:700;color:var(--accent-primary)">2:53</p><audio id="danceAudio"><source src="audio/brain-like-a-pinball.mp3" type="audio/mpeg"></audio>';var t=document.getElementById("danceAudio");if(t)try{t.play()}catch(e){}var n=["üíÉ","üï∫","ü§∏","üéâ","üåü","ü§©","üöÄ","üåà"],o=[{text:"DANCE!",color:"#ff6b6b"},{text:"MOVE!",color:"#ffd93d"},{text:"JUMP!",color:"#6bcb77"},{text:"SMILE!",color:"#4d96ff"},{text:"ENJOY!",color:"#e84393"}],a=document.getElementById("danceEmoji"),i=document.getElementById("dancePrompt"),r=document.getElementById("danceTimer"),s=173,c=0,l=0;i.style.color=o[0].color;var d=setInterval(function(){l=(l+1)%o.length,i.textContent=o[l].text,i.style.color=o[l].color,i.classList.remove("dance-prompt-flash"),i.offsetWidth,i.classList.add("dance-prompt-flash")},3e3);S.push(d);var u=setInterval(function(){s--;var e=Math.floor(s/60),t=s%60;if(r.textContent=e+":"+(t<10?"0"+t:t),c=(c+1)%n.length,a.textContent=n[c],s<=0){clearInterval(u),clearInterval(d),a.textContent="üéâ",a.style.animation="none",i.textContent="AMAZING!",i.style.color="#ffd93d",i.classList.remove("dance-prompt-flash"),r.textContent="Pure joy! You felt that!";var o=document.getElementById("danceAudio");o&&(o.pause(),o.currentTime=0)}},1e3);S.push(u)}},{id:"laugh",icon:"ü§£",label:"Laugh It Out",desc:"Contagious kids laughing",run:function(e){e.innerHTML='<h3>Laugh It Out! ü§£</h3><p style="color:var(--text-secondary);margin-bottom:8px">Kids laughing is scientifically contagious. Try not to smile!</p><div class="stuck-laugh-area"><div style="font-size:3rem;margin-bottom:12px">üòÇ</div><audio id="laughAudio" controls loop><source src="audio/kids-laughing.mp3" type="audio/mpeg">Your browser does not support audio.</audio></div>';var t=document.getElementById("laughAudio");if(t)try{t.play()}catch(e){}}},{id:"boxBreathing",icon:"‚¨ú",label:"Box Breathing",desc:"4-4-4-4 calm your nervous system",run:function(e){e.innerHTML='<h3>Box Breathing ‚¨ú</h3><p style="color:var(--text-secondary);margin-bottom:12px">Equal breaths. In 4, hold 4, out 4, hold 4.</p><div class="stuck-breathe-circle" id="boxCircle">Breathe In</div><p id="boxCount" style="color:var(--text-muted);font-size:0.85rem;margin-top:8px">Round 1 of 4</p>';var t=document.getElementById("boxCircle"),n=document.getElementById("boxCount"),o=0;!function e(){if(o>=4)return t.textContent="‚ú® Done!",t.className="stuck-breathe-circle",void(n.textContent="Nervous system reset complete!");o++,n.textContent="Round "+o+" of 4",t.textContent="Breathe In",t.className="stuck-breathe-circle inhale",S.push(setTimeout(function(){t.textContent="Hold...",t.className="stuck-breathe-circle"},4e3)),S.push(setTimeout(function(){t.textContent="Breathe Out",t.className="stuck-breathe-circle exhale"},8e3)),S.push(setTimeout(function(){t.textContent="Hold...",t.className="stuck-breathe-circle"},12e3)),S.push(setTimeout(function(){e()},16e3))}()}},{id:"physiologicalSigh",icon:"üí®",label:"Physiological Sigh",desc:"Fastest stress reset ‚Äî 1 breath (Stanford)",run:function(e){e.innerHTML='<h3>Physiological Sigh üí®</h3><p style="color:var(--text-secondary);margin-bottom:12px">Dr. Huberman\'s fastest calm-down: double inhale + long exhale.</p><div class="stuck-breathe-circle" id="sighCircle" style="background:linear-gradient(135deg,#00b8d4,#0097a7)">Ready?</div><p id="sighStep" style="font-size:1rem;font-weight:600;color:var(--accent-primary);margin-top:12px">Tap to start</p>';var t=document.getElementById("sighCircle"),n=document.getElementById("sighStep"),o=0;!function e(){if(o>=5)return t.textContent="‚ú® Done!",t.className="stuck-breathe-circle",void(n.textContent="Cortisol cleared. You're reset!");o++,n.textContent="Sigh "+o+" of 5",t.textContent="Inhale‚Ä¶",t.className="stuck-breathe-circle inhale",S.push(setTimeout(function(){t.textContent="+ Sip!"},2e3)),S.push(setTimeout(function(){t.textContent="Exhale‚Ä¶‚Ä¶",t.className="stuck-breathe-circle exhale"},3500)),S.push(setTimeout(function(){e()},8e3))}()}},{id:"grounding54321",icon:"üñêÔ∏è",label:"5-4-3-2-1 Grounding",desc:"Engage all 5 senses to reset",run:function(e){var t=[{num:5,sense:"SEE",prompt:"Look around. Name 5 things you can see right now.",emoji:"üëÅÔ∏è"},{num:4,sense:"HEAR",prompt:"Pause and listen. Name 4 things you can hear.",emoji:"üëÇ"},{num:3,sense:"TOUCH",prompt:"Name 3 things you can physically feel right now.",emoji:"‚úã"},{num:2,sense:"SMELL",prompt:"Name 2 things you can smell (or go smell something).",emoji:"üëÉ"},{num:1,sense:"TASTE",prompt:"Name 1 thing you can taste (or take a sip of water).",emoji:"üëÖ"}],n=0;!function o(){var a=t[n];e.innerHTML='<h3>5-4-3-2-1 Grounding üñêÔ∏è</h3><div style="font-size:3rem;margin:16px 0">'+a.emoji+'</div><p style="font-size:1.3rem;font-weight:700;color:var(--accent-primary)">'+a.num+" things you can "+a.sense+'</p><p style="color:var(--text-secondary);margin:8px 0 20px">'+a.prompt+'</p><p style="color:var(--text-muted);font-size:0.85rem">Step '+(n+1)+" of 5</p>"+(n<4?'<button class="btn-primary" id="groundingNext" style="margin-top:12px">Next ‚Üí</button>':"<p style=\"font-size:1.2rem;font-weight:700;color:var(--accent-green);margin-top:12px\">‚ú® You're grounded. You're here. You're okay.</p>");var i=document.getElementById("groundingNext");i&&i.addEventListener("click",function(){n++,o()})}()}},{id:"coldSplash",icon:"üßä",label:"Cold Reset",desc:"Splash cold water ‚Äî vagus nerve hack",run:function(e){e.innerHTML='<h3>Cold Reset üßä</h3><p style="color:var(--text-secondary);margin-bottom:16px">This activates the mammalian diving reflex ‚Äî instant calm.</p><div style="font-size:4rem;margin:16px 0">üßä</div><div style="background:rgba(0,184,212,0.1);border-radius:12px;padding:16px;text-align:left;margin-bottom:12px"><p style="font-weight:700;margin-bottom:8px">Do one of these NOW:</p><p>üíß Splash cold water on your face (best)</p><p>üßä Hold an ice cube in your hands for 30 sec</p><p>üö∞ Run cold water on your wrists for 20 sec</p><p>üßª Press a cold wet towel on your neck</p></div><p id="coldTimer" style="font-size:1.5rem;font-weight:700;color:var(--accent-primary)">30</p><p style="color:var(--text-muted);font-size:0.85rem">Timer counting down‚Ä¶</p>';var t=document.getElementById("coldTimer"),n=30,o=setInterval(function(){n--,t.textContent=n,n<=0&&(clearInterval(o),t.textContent="‚ú® Feel that reset?")},1e3);S.push(o)}},{id:"bodyShake",icon:"ü™ª",label:"Shake It Off",desc:"Full song body shake ‚Äî Brain Like A Pinball!",run:function(e){e.innerHTML='<h3>üéµ Shake It Off! ü™ª</h3><p style="color:var(--text-secondary);margin-bottom:12px">Shake your whole body for the entire song! Release that stress!</p><div class="stuck-dance-area" id="shakeEmoji" style="animation:danceWiggle 0.15s infinite alternate">ü™ª</div><p id="shakeTimer" style="font-size:1.5rem;font-weight:700;color:var(--accent-primary)">2:53</p><div style="background:rgba(108,92,231,0.08);border-radius:12px;padding:12px;margin-top:12px;text-align:left;font-size:0.9rem"><p>üëã Shake your hands vigorously</p><p>ü¶∂ Bounce on your feet</p><p>üí™ Shake your arms and shoulders</p><p>üéµ Let your whole body wiggle!</p></div><audio id="danceAudio"><source src="audio/brain-like-a-pinball.mp3" type="audio/mpeg"></audio>';var t=document.getElementById("danceAudio");if(t)try{t.play()}catch(e){}var n=document.getElementById("shakeTimer"),o=["ü™ª","üí™","ü§∏","üéµ","üëã","ü™ª"],a=document.getElementById("shakeEmoji"),i=173,r=0,s=setInterval(function(){i--;var e=Math.floor(i/60),t=i%60;if(n.textContent=e+":"+(t<10?"0"+t:t),r=(r+1)%o.length,a.textContent=o[r],i<=0){clearInterval(s),a.textContent="üéâ",a.style.animation="none",n.textContent="Stress discharged! You rocked it!";var c=document.getElementById("danceAudio");c&&(c.pause(),c.currentTime=0)}},1e3);S.push(s)}},{id:"butterflyHug",icon:"ü¶ã",label:"Butterfly Hug",desc:"Bilateral tapping for instant calm",run:function(e){e.innerHTML='<h3>Butterfly Hug ü¶ã</h3><p style="color:var(--text-secondary);margin-bottom:12px">Cross your arms, hands on shoulders. Alternate tapping left-right.</p><div id="butterflyEmoji" style="font-size:4rem;margin:16px 0;transition:transform 0.3s">ü¶ã</div><p id="butterflyGuide" style="font-size:1.1rem;font-weight:600;color:var(--accent-primary)">Tap LEFT</p><p id="butterflyTimer" style="color:var(--text-muted);font-size:0.85rem;margin-top:8px">60 seconds</p>';var t=document.getElementById("butterflyEmoji"),n=document.getElementById("butterflyGuide"),o=document.getElementById("butterflyTimer"),a=60,i=!0,r=setInterval(function(){a--,i=!i,t.style.transform=i?"rotate(-15deg)":"rotate(15deg)",n.textContent=i?"Tap LEFT":"Tap RIGHT",o.textContent=a+" seconds",a<=0&&(clearInterval(r),t.style.transform="none",n.textContent="‚ú® Both hemispheres balanced!",o.textContent="You did great!")},1e3);S.push(r)}},{id:"brainDump",icon:"üß†",label:"Brain Dump",desc:"Empty your head onto paper (2 min)",run:function(e){e.innerHTML='<h3>Brain Dump üß†</h3><p style="color:var(--text-secondary);margin-bottom:12px">Write EVERYTHING in your head. Don\'t filter. Just dump it out.</p><textarea id="brainDumpArea" class="input-field textarea" style="width:100%;min-height:120px;font-size:1rem;margin-bottom:12px" placeholder="Type everything here‚Ä¶ every worry, thought, task, idea. Don\'t stop writing for 2 minutes."></textarea><p id="dumpTimer" style="font-size:1.3rem;font-weight:700;color:var(--accent-primary)">2:00</p><p style="color:var(--text-muted);font-size:0.85rem">Keep writing until the timer ends!</p>';var t=document.getElementById("dumpTimer"),n=document.getElementById("brainDumpArea");n&&n.focus();var o=120,a=setInterval(function(){o--;var e=Math.floor(o/60),n=o%60;t.textContent=e+":"+(n<10?"0":"")+n,o<=0&&(clearInterval(a),t.textContent="‚ú® Feel lighter?")},1e3);S.push(a)}},{id:"selfCompassion",icon:"üíö",label:"Self-Compassion",desc:"Break the shame spiral (Dr. Neff)",run:function(e){var t=[{title:"Step 1: Acknowledge",emoji:"ü§≤",text:'Say to yourself: "This is a moment of struggle. This is hard right now."',sub:"Don't minimize it. Don't dramatize it. Just notice."},{title:"Step 2: You're Not Alone",emoji:"ü§ù",text:'Say: "Other people with ADHD feel this exact same way. This is part of the human experience."',sub:"You are not broken. Your brain just works differently."},{title:"Step 3: Be Kind",emoji:"üíö",text:'Say: "May I be kind to myself right now. I\'m doing my best with the brain I have."',sub:"Place your hand on your heart. Mean it."}],n=0;!function o(){var a=t[n];e.innerHTML='<h3>Self-Compassion Pause üíö</h3><div style="font-size:3rem;margin:12px 0">'+a.emoji+'</div><p style="font-size:1.1rem;font-weight:700;color:var(--accent-primary);margin-bottom:8px">'+a.title+'</p><p style="font-size:1rem;margin-bottom:8px;color:var(--text-primary)">'+a.text+'</p><p style="color:var(--text-muted);font-size:0.85rem;font-style:italic;margin-bottom:16px">'+a.sub+"</p>"+(n<2?'<button class="btn-primary" id="compassionNext">Next ‚Üí</button>':'<p style="font-size:1.1rem;font-weight:700;color:var(--accent-green);margin-top:12px">‚ú® You are enough. You always have been.</p>');var i=document.getElementById("compassionNext");i&&i.addEventListener("click",function(){n++,o()})}()}},{id:"microChunk",icon:"üß©",label:"Micro-Chunk It",desc:"Break your task into tiny bites",run:function(e){e.innerHTML='<h3>Micro-Chunk It üß©</h3><p style="color:var(--text-secondary);margin-bottom:12px">Your task feels huge? Let\'s make it absurdly tiny. What are you trying to do?</p><input type="text" id="chunkTask" class="input-field" style="width:100%;margin-bottom:12px" placeholder="e.g., Write my essay"><div id="chunkSteps" style="text-align:left;margin-top:8px"></div><button class="btn-primary" id="chunkGenerate" style="margin-top:12px">üß† Break It Down</button>',document.getElementById("chunkGenerate").addEventListener("click",function(){var e=['‚úÖ Step 1: Open the app/file/document for "'+(document.getElementById("chunkTask").value||"your task")+'"',"‚úÖ Step 2: Read/look at it for just 30 seconds","‚úÖ Step 3: Do the SMALLEST first action (one line, one word, one click)","‚úÖ Step 4: Do one more tiny thing","‚úÖ Step 5: You're already in flow!"];document.getElementById("chunkSteps").innerHTML=e.map(function(e){return'<p style="padding:6px 0;border-bottom:1px solid var(--border)">'+e+"</p>"}).join(""),document.getElementById("chunkGenerate").textContent="üéâ Now do Step 1!"})}},{id:"gratitude",icon:"üôè",label:"Gratitude Boost",desc:"Shift your brain chemistry in 60 sec",run:function(e){e.innerHTML='<h3>Gratitude Boost üôè</h3><p style="color:var(--text-secondary);margin-bottom:12px">Gratitude activates your reward pathways. Write 3 things ‚Äî big or small.</p><div style="text-align:left"><div style="display:flex;align-items:center;gap:8px;margin-bottom:10px"><span style="font-size:1.3rem">‚ú®</span><input type="text" class="input-field" style="flex:1" id="grat1" placeholder="I\'m grateful for‚Ä¶"></div><div style="display:flex;align-items:center;gap:8px;margin-bottom:10px"><span style="font-size:1.3rem">üíõ</span><input type="text" class="input-field" style="flex:1" id="grat2" placeholder="I appreciate‚Ä¶"></div><div style="display:flex;align-items:center;gap:8px;margin-bottom:10px"><span style="font-size:1.3rem">üåü</span><input type="text" class="input-field" style="flex:1" id="grat3" placeholder="Something good today‚Ä¶"></div></div><p id="gratResult" style="color:var(--accent-green);font-weight:700;margin-top:12px;display:none">‚ú® Dopamine + serotonin activated! Your brain thanks you.</p>';var t=[document.getElementById("grat1"),document.getElementById("grat2"),document.getElementById("grat3")];t.forEach(function(e){e&&e.addEventListener("input",function(){t.filter(function(e){return e&&e.value.trim()}).length>=3&&(document.getElementById("gratResult").style.display="")})}),t[0]&&t[0].focus()}},{id:"positiveTalk",icon:"üí¨",label:"Reframe It",desc:"Replace negative self-talk (CBT)",run:function(e){var t=[{neg:'"I\'m so lazy"',pos:'"My brain needs more dopamine to start. That\'s neuroscience, not laziness."'},{neg:'"I always fail"',pos:'"I struggle with follow-through, AND I keep trying. That takes courage."'},{neg:'"Everyone else can do this easily"',pos:'"I\'m comparing my behind-the-scenes to their highlight reel."'},{neg:'"What\'s wrong with me?"',pos:'"My brain is wired differently. Different ‚â† defective."'},{neg:'"I\'ll never get this done"',pos:'"I can do the next small piece. That\'s all I need to focus on."'},{neg:'"I should be further along"',pos:"\"I'm exactly where I am, and I'm still moving forward.\""}],n=t[Math.floor(Math.random()*t.length)];e.innerHTML='<h3>Reframe It üí¨</h3><p style="color:var(--text-secondary);margin-bottom:16px">Your thoughts aren\'t facts. Let\'s rewrite that script.</p><div style="background:rgba(231,76,60,0.08);border-radius:12px;padding:16px;margin-bottom:12px"><p style="color:#e74c3c;font-size:0.8rem;font-weight:700;margin-bottom:4px">THE OLD STORY</p><p style="font-size:1.1rem;font-style:italic">'+n.neg+'</p></div><div style="font-size:1.5rem;margin:8px 0">‚¨áÔ∏è</div><div style="background:rgba(0,210,160,0.08);border-radius:12px;padding:16px"><p style="color:var(--accent-green);font-size:0.8rem;font-weight:700;margin-bottom:4px">THE TRUTH</p><p style="font-size:1.1rem;font-weight:600">'+n.pos+'</p></div><p style="color:var(--text-muted);font-size:0.85rem;margin-top:16px;font-style:italic">Say the new version out loud 3 times. Your brain needs to hear it.</p>'}},{id:"nameItTameIt",icon:"üè∑Ô∏è",label:"Name It to Tame It",desc:"Label your emotion to calm it down",run:function(e){var t=[{emoji:"üò§",name:"Frustrated",tip:"Frustration means you care. Take one step back from the problem."},{emoji:"üò∞",name:"Anxious",tip:"Anxiety lives in the future. Come back to right now with a deep breath."},{emoji:"üò©",name:"Overwhelmed",tip:"Too many things at once. Pick ONE. The rest can wait."},{emoji:"üòî",name:"Ashamed",tip:'Shame says "I am bad." Truth: you have a brain difference, not a character flaw.'},{emoji:"üò¥",name:"Drained",tip:"Your battery is low. Rest IS productive. Even 5 minutes helps."},{emoji:"üòê",name:"Numb / Blank",tip:"Your brain shut down to protect you. Be gentle. Start with something sensory."},{emoji:"üò†",name:"Angry",tip:"Anger is a signal something matters to you. What boundary was crossed?"},{emoji:"üòû",name:"Disappointed",tip:"You had expectations. It's okay to grieve them. Then adjust and keep going."}],n=t.map(function(e,t){return'<button class="stuck-option" data-emo="'+t+'" style="padding:10px 14px"><span style="font-size:1.5rem">'+e.emoji+'</span><span><span class="stuck-label" style="font-size:0.9rem">'+e.name+"</span></span></button>"}).join("");e.innerHTML='<h3>Name It to Tame It üè∑Ô∏è</h3><p style="color:var(--text-secondary);margin-bottom:12px">Naming your emotion activates your prefrontal cortex and calms the amygdala.</p><p style="font-weight:600;margin-bottom:8px">What are you feeling right now?</p><div class="stuck-options" style="gap:8px">'+n+"</div>",e.querySelectorAll("[data-emo]").forEach(function(n){n.addEventListener("click",function(){var n=t[parseInt(this.getAttribute("data-emo"))];e.innerHTML='<div style="font-size:3rem;margin:12px 0">'+n.emoji+"</div><h3>\"I'm feeling "+n.name+'"</h3><div style="background:rgba(0,210,160,0.08);border-radius:12px;padding:16px;margin:16px 0"><p style="font-size:1rem">'+n.tip+'</p></div><p style="color:var(--text-muted);font-size:0.85rem;font-style:italic">‚ú® You named it. Your prefrontal cortex just came back online.</p>'})})}},{id:"sensoryReset",icon:"üåø",label:"Sensory Reset",desc:"Change your environment in 30 seconds",run:function(e){var t=["ü™ü Open a window ‚Äî fresh air changes everything","üí° Change your lighting ‚Äî brighter or dimmer","üéµ Put on a completely different kind of music","üßä Run cold water on your wrists for 15 seconds","üçã Smell something strong ‚Äî peppermint, coffee, citrus","üßπ Clear 3 things off your desk right now","üëü Take off your shoes and feel the floor","üíß Drink a full glass of cold water"].sort(function(){return.5-Math.random()}).slice(0,4);e.innerHTML='<h3>Sensory Reset üåø</h3><p style="color:var(--text-secondary);margin-bottom:12px">Your ADHD brain craves novelty. Change your senses to change your state.</p><div style="text-align:left;margin-bottom:16px">'+t.map(function(e){return'<p style="padding:8px 0;border-bottom:1px solid var(--border);font-size:0.95rem">'+e+"</p>"}).join("")+'</div><p style="font-weight:700;color:var(--accent-primary)">Do at least ONE right now ‚Äî then come back!</p>'}}];function T(){var e=document.getElementById("stuckOptionsContainer");if(e){var t=function(){var e=B.filter(function(e){return-1===D.indexOf(e.id)});e.length<3&&(D=D.slice(-3),e=B.filter(function(e){return-1===D.indexOf(e.id)}));var t=e.sort(function(){return.5-Math.random()}).slice(0,3);return t.forEach(function(e){D.push(e.id)}),t}();e.innerHTML=t.map(function(e){return'<button class="stuck-option" data-stuck-id="'+e.id+'"><span class="stuck-icon">'+e.icon+'</span><span><span class="stuck-label">'+e.label+'</span><span class="stuck-desc">'+e.desc+"</span></span></button>"}).join(""),e.querySelectorAll(".stuck-option").forEach(function(t){t.addEventListener("click",function(){var t=this.getAttribute("data-stuck-id"),n=B.filter(function(e){return e.id===t})[0];if(n){e.style.display="none",document.getElementById("stuckActivity").classList.remove("hidden");var o=document.getElementById("stuckActivityContent");n.run(o)}})})}}function L(){document.getElementById("stuckOverlay").classList.add("hidden"),I&&(clearTimeout(I),I=null),S.forEach(function(e){clearTimeout(e),clearInterval(e)}),S=[],["laughAudio","danceAudio"].forEach(function(e){var t=document.getElementById(e);t&&(t.pause(),t.currentTime=0,t.src="",t.removeAttribute("src"),t.load(),t.parentNode&&t.parentNode.removeChild(t))});var e=document.getElementById("stuckActivityContent");e&&(e.innerHTML="")}wn("btnStuck","click",function(){document.getElementById("stuckOverlay").classList.remove("hidden");var e=document.getElementById("stuckOptionsContainer");e&&(e.style.display="");var t=document.getElementById("stuckActivity");t&&t.classList.add("hidden"),T()}),wn("btnDanceBreak","click",function(){document.getElementById("stuckOverlay").classList.remove("hidden");var e=document.getElementById("stuckOptionsContainer");e&&(e.style.display="none");var t=document.getElementById("stuckActivity");t&&t.classList.remove("hidden");var n=document.getElementById("stuckActivityContent"),o=B.filter(function(e){return"dance"===e.id})[0];o&&n&&o.run(n)}),wn("btnThankYourself","click",function(){var e=document.getElementById("thankYourselfOverlay");if(e){e.classList.remove("hidden");var t=document.getElementById("thankInput1"),n=document.getElementById("thankInput2"),o=document.getElementById("thankInput3");t&&(t.value=""),n&&(n.value=""),o&&(o.value="");var a=document.getElementById("thankYourselfResult");a&&(a.classList.add("hidden"),a.innerHTML="");var i=document.getElementById("btnSubmitThanks");i&&(i.style.display=""),setTimeout(function(){t&&t.focus()},200)}}),wn("closeThankYourself","click",function(){var e=document.getElementById("thankYourselfOverlay");e&&e.classList.add("hidden")}),wn("btnSubmitThanks","click",function(){var e=document.getElementById("thankInput1"),t=document.getElementById("thankInput2"),n=document.getElementById("thankInput3"),o=e?e.value.trim():"",a=t?t.value.trim():"",i=n?n.value.trim():"";if(o||a||i){var r=[];o&&r.push(o),a&&r.push(a),i&&r.push(i);var s=["You showed up. That matters more than you think.","Your future self is already grateful.","You did that. Nobody can take it away.","Small steps still move you forward.","You deserve to hear this: well done.","The fact that you're here means you care. That's huge."],c=s[Math.floor(Math.random()*s.length)],l=document.getElementById("thankYourselfResult");if(l){var d="<h3>üíõ Thank You, You!</h3>";r.forEach(function(e){d+='<div class="thank-item">‚Äú'+e+"‚Äù</div>"}),d+='<p style="margin-top:12px;font-style:italic;color:var(--accent-primary)">'+c+"</p>",l.innerHTML=d,l.classList.remove("hidden")}var u=document.getElementById("btnSubmitThanks");u&&(u.style.display="none"),"function"==typeof addXP&&addXP(15,"Self-gratitude"),void 0!==de&&de.actionLog&&(de.actionLog.push({action:"Thanked myself: "+r.join(", "),outcome:"Self-Care",category:"personal_growth",date:(new Date).toISOString(),xp:15}),Ee())}else e&&(e.style.borderColor="#f44336",setTimeout(function(){e.style.borderColor=""},2e3))}),wn("stuckDone","click",L),wn("closeStuck","click",L),wn("btnStartExtendedBreak","click",Wt),wn("btnSkipExtendedBreak","click",function(){he&&clearInterval(he),he=null,document.getElementById("extendedBreakOverlay").classList.add("hidden")}),wn("btnSettings","click",function(){document.getElementById("statePrimingOverlay").classList.remove("hidden")}),wn("btnStartDay","click",function(){try{var e="lwp_priming_times_"+(new Date).toDateString(),t=JSON.parse(localStorage.getItem(e)||"[]");t.push(Date.now()),localStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("priming save error:",e)}document.getElementById("statePrimingOverlay").classList.add("hidden")}),wn("closePriming","click",function(){try{var e="lwp_priming_times_"+(new Date).toDateString(),t=JSON.parse(localStorage.getItem(e)||"[]");t.push(Date.now()),localStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("priming save error:",e)}document.getElementById("statePrimingOverlay").classList.add("hidden")}),document.querySelectorAll(".btn-timer").forEach(function(e){e.addEventListener("click",function(){!function(e){var t=parseInt(e.dataset.seconds),n=e.nextElementSibling;n.classList.remove("hidden"),e.style.display="none";var o=t,a=setInterval(function(){o--,n.textContent="00:"+(o<10?"0":"")+o,o<=0&&(clearInterval(a),n.textContent="Done!",n.style.color="#00d2a0")},1e3)}(this)})}),wn("energySlider","input",function(){document.getElementById("energyValue").textContent=this.value}),wn("btnWeeklyReview","click",function(){(function(){var e=new Date,t=new Date(e.getTime()-6048e5),n=$e().map(function(e){return e.id}),o=[],a=[];de.outcomes.forEach(function(e){et(e)&&e.actions.forEach(function(e){if(e.done&&e.completedDate){var n=new Date(e.completedDate);!isNaN(n.getTime())&&n>=t&&o.push(e.text)}e.done||a.push(e.text)})}),de.log.forEach(function(e){if(e.date&&e.category&&-1!==n.indexOf(e.category)){var a=new Date(e.date);!isNaN(a.getTime())&&a>=t&&-1===o.indexOf(e.text)&&o.push(e.text)}});var i=o.length+a.length,r=i>0?Math.round(o.length/i*100):0,s=326.73,c=s-r/100*s;document.getElementById("weeklyProgressRing").style.strokeDashoffset=c,document.getElementById("weeklyProgressText").textContent=r+"%",document.getElementById("weeklyWins").innerHTML=o.length>0?o.slice(0,10).map(function(e){return"<li>"+rn(e)+"</li>"}).join(""):"<li>No completed actions this week yet</li>",document.getElementById("weeklyCarryOver").innerHTML=a.length>0?a.slice(0,10).map(function(e){return"<li>"+rn(e)+"</li>"}).join(""):"<li>All caught up!</li>";var l=0;de.log.forEach(function(e){e.date&&e.category&&-1!==n.indexOf(e.category)&&new Date(e.date)>=t&&(l+=e.points)}),document.getElementById("momentumScore").textContent=l,document.getElementById("weeklyReviewOverlay").classList.remove("hidden")})()}),wn("closeWeeklyReview","click",function(){document.getElementById("weeklyReviewOverlay").classList.add("hidden")}),wn("saveReflection","click",function(){var e=document.getElementById("weeklyReflection").value.trim();e&&(de.reflections.push({date:(new Date).toDateString(),text:e}),Ee(),alert("Reflection saved!"))}),wn("outcomesGrid","click",function(e){var t=e.target.closest(".btn-archive-outcome");if(t){var n=t.dataset.outcomeId;n&&confirm("Archive this completed outcome?")&&function(e){var t=de.outcomes.findIndex(function(t){return t.id===e});if(-1!==t){var n=de.outcomes[t];n.archivedDate=(new Date).toISOString(),de.archived.push(n),de.outcomes.splice(t,1),Ee(),Ve()}}(n)}}),wn("btnValues","click",function(){document.querySelectorAll(".value-input").forEach(function(e,t){e.value=de.values&&de.values[t]?de.values[t]:""}),document.getElementById("valuesOverlay").classList.remove("hidden")}),wn("closeValues","click",function(){document.getElementById("valuesOverlay").classList.add("hidden")}),wn("btnSaveValues","click",gt);var C=document.getElementById("btnBusinessPack");C&&C.addEventListener("click",Et),wn("closeBusinessPack","click",function(){document.getElementById("businessPackOverlay").classList.add("hidden")}),wn("btnNewBusinessOutcome","click",Bt);var M=document.getElementById("btnHelp");M&&M.addEventListener("click",function(){document.getElementById("helpOverlay").classList.remove("hidden")}),wn("closeHelp","click",function(){document.getElementById("helpOverlay").classList.add("hidden")}),wn("btnSaveSeed","click",function(){localStorage.setItem("lwp_evening_seed_"+(new Date).toDateString(),"done"),document.getElementById("eveningSeedOverlay").classList.add("hidden")}),wn("closeEveningSeed","click",function(){localStorage.setItem("lwp_evening_seed_"+(new Date).toDateString(),"done"),document.getElementById("eveningSeedOverlay").classList.add("hidden")}),wn("btnWindDownDone","click",function(){localStorage.setItem("lwp_wind_down_"+(new Date).toDateString(),"done"),document.getElementById("windDownOverlay").classList.add("hidden")}),wn("closeWindDown","click",function(){localStorage.setItem("lwp_wind_down_"+(new Date).toDateString(),"done"),document.getElementById("windDownOverlay").classList.add("hidden")}),document.querySelectorAll(".btn-wind-timer").forEach(function(e){e.addEventListener("click",function(){!function(e){var t=parseInt(e.dataset.seconds),n=e.nextElementSibling;e.style.display="none",n.classList.remove("hidden");var o=t;!function e(){var t=Math.floor(o/60),a=o%60;if(n.textContent=(t<10?"0":"")+t+":"+(a<10?"0":"")+a,o<=0)return n.textContent="Done!",void(n.style.color="var(--accent-green)");o--,setTimeout(e,1e3)}()}(this)})}),function(){if(!dn){dn=setInterval(function(){var e=new Date,t=e.getHours(),n=e.getMinutes();20===t&&n>=0&&n<5&&cn(),20===t&&n>=30&&n<35&&ln()},6e4);var e=new Date,t=e.getHours(),n=e.getMinutes();20===t&&n>=0&&n<30&&cn(),(20===t&&n>=30||21===t&&n<5)&&ln(),t>=20&&cn(),(t>=20&&n>=30||t>=21)&&ln()}}(),wn("btnTomorrow","click",function(){try{sn(),document.getElementById("eveningSeedOverlay").classList.remove("hidden")}catch(e){console.error("tomorrow plan error:",e)}}),wn("btnArchive","click",function(){an(on),document.getElementById("archiveOverlay").classList.remove("hidden")}),wn("closeArchive","click",function(){document.getElementById("archiveOverlay").classList.add("hidden")}),document.querySelectorAll(".archive-tab").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".archive-tab").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),an(this.dataset.period)})}),wn("archiveList","click",function(e){var t=e.target.closest(".archive-unarchive-btn");if(t){var n=t.dataset.outcomeId;n&&confirm("Restore this outcome to your active list?")&&function(e){var t=de.archived.findIndex(function(t){return t.id===e});if(-1!==t){var n=de.archived[t];delete n.archivedDate,de.outcomes.push(n),de.archived.splice(t,1),Ee(),Ve(),an(on)}}(n)}}),document.querySelectorAll(".filter-tabs .tab").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".filter-tabs .tab").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),Xe=this.dataset.filter,Ve()})})}function mn(e){var t;U=e,K=!1,le=function(e){return e?"life_with_purpose_data_"+e:ce}(e.uid),function(e){var t=document.getElementById("userMenu"),n=document.getElementById("btnLogout");if(e){t.style.display="flex";var o=document.getElementById("userAvatar");o.src=e.photoURL||"",o.alt=e.displayName||"User",n&&(n.style.display="")}else t.style.display="none",n&&(n.style.display="none")}(e),ee(),function(e){if(firebaseReady&&e)try{var t={email:e.email||"",displayName:e.displayName||"",photoURL:e.photoURL||"",lastLogin:(new Date).toISOString()};db.collection("users").doc(e.uid).get().then(function(n){n.exists&&n.data().createdAt||(t.createdAt=(new Date).toISOString()),db.collection("users").doc(e.uid).set(t,{merge:!0})}).catch(function(n){db.collection("users").doc(e.uid).set(t,{merge:!0})})}catch(e){console.error("Save user profile error:",e)}}(e),function(e){if(!firebaseReady)return;try{db.collection("users").doc(e).get().then(function(t){t.exists&&t.data().tier?V=t.data().tier:U&&"irishka.lebedeva@gmail.com"===U.email?(V="pro",db.collection("users").doc(e).set({tier:"pro"},{merge:!0})):V="free",Q()}).catch(function(){V="free",Q()})}catch(e){V="free"}}(e.uid),function(e){if(!firebaseReady||hn>=fn)return;db.collection("users").doc(e).get().then(function(t){if(t.exists&&t.data().foundingMember)return gn=!0,void pn();db.collection("users").doc(e).set({foundingMember:!0,foundingMemberDate:(new Date).toISOString()},{merge:!0}),db.collection("meta").doc("founding_members").set({count:firebase.firestore.FieldValue.increment(1)},{merge:!0}),gn=!0,hn++,pn()}).catch(function(e){console.error("Founding member error:",e)})}(e.uid),function(e){if(!firebaseReady)return;var t=e.substring(0,8);db.collection("users").doc(e).set({referralCode:t},{merge:!0})}(e.uid),function(){var e=new URLSearchParams(window.location.search).get("ref");if(e&&U){if(e===yn())return;db.collection("users").doc(U.uid).get().then(function(t){t.exists&&t.data().referredBy||(db.collection("users").doc(U.uid).set({referredBy:e,referredDate:(new Date).toISOString()},{merge:!0}),db.collection("users").where("referralCode","==",e).get().then(function(e){if(!e.empty){var t=e.docs[0];db.collection("users").doc(t.id).set({referralCount:firebase.firestore.FieldValue.increment(1)},{merge:!0})}}))}),window.history.replaceState({},"",window.location.pathname)}}(),t=async function(t){if(await we(),t){var n=de&&de.log?de.log.length:0,o=t.log?t.log.length:0,a=de&&de.outcomes?de.outcomes.length:0,i=t.outcomes?t.outcomes.length:0;o>n||i>a?(de=t,Se(),ke(),await xe()):(n>o||a>i)&&Ie()}else de&&de.outcomes&&de.outcomes.length>0&&Ie();try{!function(e){var t=localStorage.getItem(ce);if(t){var n;try{n=JSON.parse(t)}catch(e){return}if(n&&n.outcomes&&0!==n.outcomes.length){var o="lwp_offline_migrated_"+e;if(!localStorage.getItem(o)){var a=n.outcomes.length;n.outcomes.forEach(function(e){e.actions&&e.actions.length});var i=n.log?n.log.length:0;if(confirm("üì¶ Found "+a+" outcome(s) and "+i+" log entries from offline/demo mode. Merge into your account?")){var r={};if(de.outcomes.forEach(function(e){r[e.result.toLowerCase()]=!0}),n.outcomes.forEach(function(e){r[e.result.toLowerCase()]||de.outcomes.push(e)}),n.log&&n.log.forEach(function(e){de.log.push(e)}),de.totalMomentum=(de.totalMomentum||0)+(n.totalMomentum||0),(n.bestStreak||0)>(de.bestStreak||0)&&(de.bestStreak=n.bestStreak),n.badges&&n.badges.length>0){var s={};(de.badges||[]).forEach(function(e){s[e.id||e]=!0}),n.badges.forEach(function(e){s[e.id||e]||de.badges.push(e)})}Ee(),localStorage.setItem(o,"1");var c=document.getElementById("challengeToast"),l=document.getElementById("challengeToastText");c&&l&&(l.textContent="‚úÖ Offline data merged! "+a+" outcomes imported.",c.classList.remove("hidden"),setTimeout(function(){c.classList.add("hidden")},5e3)),Ve()}else localStorage.setItem(o,"declined")}}}}(e.uid)}catch(e){console.error("offline migration error:",e)}un(),firebaseReady&&U&&!K&&(J&&J(),J=db.collection("users").doc(U.uid).onSnapshot(function(e){if(e.exists&&!1===e.metadata.hasPendingWrites){var t=e.data().tier;if(t&&t!==V){V=t,Q();try{Ve()}catch(e){}}if(e.data().data){var n=e.data().data;if(JSON.stringify(de)!==JSON.stringify(n)){de=n,Se(),ke(),xe();try{Ve()}catch(e){console.error("render error on sync:",e)}}}}})),Q()},firebaseReady&&U?db.collection("users").doc(U.uid).get().then(function(e){e.exists&&e.data().data?t(e.data().data):t(null)}).catch(function(e){console.error("Firestore load error:",e),t(null)}):t(null)}var hn=0,gn=!1,fn=100;function pn(){if(gn){var e=document.getElementById("betaBadge");e&&(e.innerHTML="&#127775; Founding Member",e.classList.add("founding-member-badge"))}}function yn(){return U?U.uid.substring(0,8):""}var vn=[10,25,50,100],bn=7;function wn(e,t,n){var o=document.getElementById(e);o?o.addEventListener(t,n):console.warn("safeBind: #"+e+" not found")}document.addEventListener("DOMContentLoaded",function(){Y.forEach(function(e){var t=new Audio;t.preload="auto",t.src=e.file,t.volume=.6,R.push(t)}),wn("btnGoogleLogin","click",te);var e=document.getElementById("btnGoogleLoginNav");e&&e.addEventListener("click",te);var t=document.getElementById("btnGoogleLoginBottom");t&&t.addEventListener("click",te),wn("btnOfflineMode","click",function(e){e.preventDefault(),ie()});var n=document.getElementById("btnLogout");n&&n.addEventListener("click",ne);var o=document.getElementById("btnMenuToggle"),a=document.getElementById("topActionsDropdown"),i=document.getElementById("userAvatar");if(o&&a){o.addEventListener("click",function(e){e.stopPropagation(),a.classList.toggle("hidden")});var r=document.getElementById("avatarDropdown");if(i&&r){i.addEventListener("click",function(e){e.stopPropagation(),a.classList.add("hidden"),r.classList.toggle("hidden")});var s=document.getElementById("btnAvatarLogout");s&&s.addEventListener("click",function(){r.classList.add("hidden"),ne()})}a.querySelectorAll(".dropdown-item").forEach(function(e){e.addEventListener("click",function(){a.classList.add("hidden")})}),document.addEventListener("click",function(e){o.contains(e.target)||a.contains(e.target)||a.classList.add("hidden");var t=document.getElementById("avatarDropdown");t&&i&&!i.contains(e.target)&&!t.contains(e.target)&&t.classList.add("hidden")})}var c=document.getElementById("btnDemoSignIn");c&&c.addEventListener("click",function(){te()});var l=document.getElementById("btnDemoDownload");l&&l.addEventListener("click",function(){!function(){if(de){var e={appName:"Habit Magic",exportDate:(new Date).toISOString(),mode:Ze,outcomes:(de.outcomes||[]).map(function(e){return{result:e.result,purpose:e.purpose,category:e.category,deadline:e.deadline||"",actions:(e.actions||[]).map(function(e){return{text:e.text,done:e.done,deadline:e.deadline||""}})}}),completedActions:(de.log||[]).map(function(e){return{action:e.text||e.action,outcome:e.outcome,date:e.date,category:e.category||""}}),stats:{streak:de.streak||0,bestStreak:de.bestStreak||0,totalMomentum:de.totalMomentum||0,totalCompleted:(de.log||[]).length}},t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(n),a=document.createElement("a");a.href=o;var i=(new Date).toISOString().slice(0,10);a.download="habit-magic-backup-"+i+".json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}}()});var d=document.getElementById("btnUpgrade");d&&d.addEventListener("click",function(){X()}),document.querySelectorAll(".mode-toggle-btn").forEach(function(e){e.addEventListener("click",function(){var e=this.getAttribute("data-mode");e&&Ze!==e&&at(e)})});var u=document.getElementById("btnHelpTopbar");u&&u.addEventListener("click",function(){document.getElementById("helpOverlay").classList.remove("hidden")}),wn("btnBadDayMode","click",function(){document.getElementById("welcomeBackOverlay").classList.add("hidden"),Me(),document.getElementById("badDayOverlay").classList.remove("hidden")}),wn("btnBodyDoubleStart","click",function(){document.getElementById("bodyDoubleOverlay").classList.remove("hidden")}),wn("btnStartBodyDouble","click",function(){Ye()}),wn("btnRepeatBodyDouble","click",function(){var e=document.getElementById("btnRepeatBodyDouble");e&&e.classList.add("hidden"),Ye()}),document.querySelectorAll(".bd-sound-btn").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".bd-sound-btn").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),Ae&&Ne(this.dataset.sound)})}),"light"===localStorage.getItem("lwp_theme")?document.body.classList.add("light-mode"):document.body.classList.remove("light-mode"),nt(),wn("btnTheme","click",tt),firebaseReady?(firebaseReady&&auth.getRedirectResult().catch(function(e){e.code&&"auth/popup-closed-by-user"!==e.code&&(console.error("Redirect login error:",e),alert("Login failed: "+e.message))}),auth.onAuthStateChanged(function(e){e?mn(e):$()})):ie()})}();